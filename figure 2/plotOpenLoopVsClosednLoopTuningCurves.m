%% plotOpenLoopVsClosednLoopTuningCurves
%  1) Plot traces for OL and CL from each neuron in the data set and
%  calculates the correlation coef. between these tuning curves
% 
%  2) Compares the mean correlation with shuffled correlation coef.
%
%  3) Creates plots of tuning curves and corr coef for Figure 2
%
% Yvette Fisher 11/16/18
%% 
clear all
close all

TOTAL_DEGREES_IN_PATTERN = 360;
DEGREE_PER_LED_SLOT = 360 / 96;  % 
MIDLINE_POSITION = 34;
EDGE_OF_SCREEN_POSITION = 72; % last LED slot in postion units
EDGE_OF_SCREEN_DEG = (EDGE_OF_SCREEN_POSITION -  MIDLINE_POSITION ) * DEGREE_PER_LED_SLOT;
POSSIBLE_BAR_LOCATIONS = 2:2:71;

barPositionDegreesFromMidline = ( POSSIBLE_BAR_LOCATIONS - MIDLINE_POSITION ) * DEGREE_PER_LED_SLOT;

%Load tuning curve data into variables: 
OL_tuningCurves = [-0.988988684000000,-0.971690374000000,-2.87741846800000,-2.53588034900000,-3.87366807100000,-3.75811938000000,-4.02691836800000,-3.86097779500000,-3.65826092600000,-3.40503463600000,-2.80807742600000,-2.53171549100000,-2.13850629300000,-1.02682157200000,-1.85938459500000,-1.73611169200000,-1.94822985800000,-1.14199481600000,-1.46912521300000,-2.47999410100000,-2.04172634500000,-2.13880165700000,-2.90839052300000,-3.04638831700000,-3.20103595800000,-2.57446443800000,-2.48152496200000,-3.04399350000000,-2.71656516100000,-1.14660324100000,-1.03585273600000,-0.0227014550000000,-0.322986028000000,-0.115043289000000,0.221114993000000;-1.57292816700000,-0.542816552000000,-1.31390042200000,-1.25152369900000,-1.49647787500000,-1.95517449200000,-0.121867680000000,-0.301004543000000,0.319571189000000,0.586247565000000,-0.637088027000000,0.409853279000000,0.00905061700000000,0.444681299000000,-0.314119174000000,-0.162671884000000,-0.678111339000000,-0.172750339000000,-1.05889768800000,-0.249012269000000,0.205279334000000,-0.852088814000000,-0.521509324000000,-0.208081300000000,-1.18901319800000,-2.35439753100000,-2.32403777800000,-2.93884441300000,-2.74606112500000,-4.37601541800000,-3.11686214700000,-3.22382856700000,-1.99876262200000,-1.63624478000000,-0.693344860000000;-3.00725265200000,-3.15660224300000,-3.89477211500000,-3.57622055000000,-4.90180660200000,-4.08749182300000,-3.54598575200000,-2.49013581500000,-3.43515722900000,-3.10479776000000,-2.69480364400000,-2.63923042700000,-2.47720747000000,-1.14485097500000,-3.02740677600000,-1.69859821100000,-2.61964952000000,-1.18647706000000,-1.61912594100000,-1.62568771400000,-3.23593591800000,-2.28592995100000,-2.46261072100000,-1.16170087300000,-2.17253043900000,-1.38885183700000,-2.32592025500000,-2.56548367700000,-2.87417810700000,-2.44826291000000,-3.44566784900000,-2.32000527100000,-2.84068569100000,-2.64164567400000,-2.88171533200000;-0.100035670000000,-1.55492172100000,-1.13735571200000,-0.138596777000000,-1.28066593900000,-0.980449823000000,-0.185569161000000,-1.79663615800000,0.715290512000000,0.183348992000000,-0.0470184110000000,0.0906237190000000,-0.503897899000000,-0.917039434000000,-1.33566905900000,-1.11810884700000,-0.793956963000000,-1.69036929300000,-2.18928891700000,-2.47833320200000,-2.21615035700000,-1.91290713300000,-2.06267425800000,-2.26392229100000,-3.37114062800000,-3.89461310800000,-2.95519515300000,-3.47940880800000,-3.23250622400000,-2.41924212300000,-1.31819627100000,-1.55363760900000,-0.922003377000000,-0.832147546000000,0.206407479000000;-2.67730324900000,-2.26321198600000,-4.19545741600000,-4.82090191600000,-4.64421568500000,-4.21277224200000,-3.60416903400000,-3.05096199000000,-3.61545548800000,-2.91573140500000,-4.40956447500000,-4.59536392600000,-3.66596057500000,-1.76768763200000,-0.172912466000000,-1.71478934700000,-2.47906137700000,0.397644168000000,0.671504199000000,2.26425443900000,1.15906374200000,2.35714597500000,0.543872484000000,0.574566409000000,1.21770652200000,0.111790856000000,0.787858347000000,-0.124986525000000,0.819751325000000,-0.569442342000000,1.76171040900000,1.71558940000000,-0.948208647000000,-1.43893349800000,-1.16245587200000;-1.16764555400000,-2.84136608400000,-2.57060459800000,-2.71489039100000,-2.56565193800000,-1.81965645900000,-1.70842038200000,-2.06230721200000,-1.85454753900000,-1.91384448200000,-2.32836365000000,-2.04999344400000,-2.59738852100000,-3.30132801500000,-3.28534042000000,-2.78381281600000,-3.16395550100000,-2.65657774500000,-1.90083484000000,-1.41756050200000,-2.33782069500000,-1.76070080500000,-1.57004738200000,-1.40041249500000,-1.52134711500000,-0.540612713000000,-1.28822275000000,-2.08659042000000,-2.10983011100000,-1.80467238500000,-1.57697578400000,-1.51577628800000,-1.57212643000000,-2.07889609900000,-1.60892084000000;-0.932254346000000,-1.08646055900000,-1.14933905400000,-1.55988564300000,-1.37570665800000,-1.43875827900000,-1.33508797700000,-1.29506039800000,-1.73375298900000,-1.26871279600000,-1.14571456600000,-0.741310077000000,-0.761602514000000,-0.0697159100000000,0.206432046000000,-0.0924865620000000,-0.0704389350000000,0.115411165000000,0.520604327000000,0.476288135000000,0.444687253000000,0.441968394000000,0.316815462000000,0.394903946000000,0.578179778000000,0.186159323000000,0.170058731000000,0.0547309790000000,0.282953215000000,0.258709303000000,0.424056510000000,-0.0364071500000000,-0.394073560000000,-0.693081427000000,-0.857669826000000;-0.0144623810000000,0.481359068000000,-0.355629614000000,1.25204459100000,0.994433288000000,2.83326213600000,2.85937263400000,2.39794429500000,2.58044341400000,2.51288775500000,2.84729798900000,2.73584631000000,2.05194535300000,1.47671963800000,0.301398429000000,1.74341249700000,2.02636216700000,1.71024893200000,1.46739416800000,0.261692395000000,-0.360441026000000,-0.938429611000000,-1.32558645500000,-1.56568774600000,-1.84585378500000,-1.13733809500000,-2.72906921300000,-1.18947866900000,-3.64267668000000,-2.41645668800000,-3.52825312400000,-3.69835156600000,-2.32389523600000,-2.59595468200000,-2.73833759400000;-3.13130103400000,-2.18510153600000,-2.85741548700000,-3.60889617000000,-3.61223012100000,-3.48800030300000,-3.12685008800000,-2.47680353000000,-2.45710787800000,-2.64699181200000,-1.56381556800000,-1.76633702800000,-0.130599611000000,-0.162136629000000,0.511325134000000,1.34709851600000,1.23750909200000,0.854277000000000,0.491444084000000,-0.102506335000000,-0.402884227000000,-0.107224221000000,0.141709023000000,0.141826413000000,-0.558330104000000,0.138939323000000,-0.499164406000000,-1.44707236000000,-0.751224960000000,-1.71726704500000,-0.355359457000000,-0.288298723000000,-0.846303778000000,-1.21116564300000,-0.972772859000000;0.353301331000000,0.372423582000000,0.750237761000000,0.375307414000000,0.206442915000000,0.294009313000000,0.305908600000000,0.626303738000000,1.11894564500000,2.04885169900000,1.55134175900000,1.58807544500000,2.36651018000000,1.74695755400000,1.63394888600000,2.05347362500000,1.21451113400000,1.48449208100000,0.598548296000000,1.14786367900000,1.04763161000000,0.741625352000000,0.330943862000000,-0.0421416290000000,-0.209369901000000,-0.563194328000000,-0.0433542490000000,0.385666790000000,-0.147999420000000,0.287552640000000,-0.338052132000000,-0.523103602000000,0.309187379000000,0.0238292010000000,0.146745278000000;0.626404132000000,-0.0705138140000000,-1.15684519800000,0.250383823000000,-1.02626554300000,0.851326784000000,1.01339056500000,1.36150600200000,1.77735820900000,1.52004526400000,0.300733744000000,0.981699315000000,-1.46476551800000,-0.523092365000000,-0.790013838000000,-1.43247572000000,-0.184499785000000,-0.858152506000000,-1.29677256300000,-2.21017433500000,-1.53571504000000,-1.45368703700000,-3.19143909500000,-3.87883550300000,-1.83702749000000,-3.11942807600000,-3.89865262200000,-2.54385376100000,-4.07594874100000,-1.98032919700000,-3.03441416400000,-1.87997664000000,-3.00650106800000,-1.44162927000000,-1.54435452900000;-1.98073294400000,-2.70584195300000,-2.80326268100000,-2.56139742100000,-2.01188160500000,-2.41250340400000,-1.99371758600000,-2.19360831900000,-1.88753660100000,-1.59547754100000,-1.38990798300000,-1.74302759600000,-0.952492396000000,-1.30111286000000,-1.02908966800000,-0.872764710000000,-1.21731469700000,-0.460326259000000,0.0339315380000000,0.0304058910000000,-0.931247114000000,-1.01099124600000,-0.768654744000000,-0.525629025000000,-1.52099756600000,-0.679230673000000,-0.168597934000000,-0.637457225000000,-0.0656118490000000,-0.607688469000000,0.0214190420000000,0.0510006750000000,0.271502756000000,-1.00146730100000,0.0683936720000000;-2.31715423800000,-2.81385833300000,-2.97992202000000,-3.02658693900000,-3.36099012700000,-2.35980119600000,-2.80838706800000,-2.37325483800000,-2.88134749900000,-2.96866455000000,-2.71137004100000,-2.09168690000000,-2.30531878300000,-1.84410231100000,-1.37882943000000,-1.10083554200000,-0.986112196000000,-0.601205262000000,-0.157805322000000,-0.127356594000000,-0.904493672000000,-0.422123906000000,0.691011144000000,1.23081085600000,0.739640296000000,1.58073802300000,2.41051828900000,1.07345241300000,1.14697299400000,1.47616456800000,1.62455549600000,1.38146984800000,0.666975586000000,0.161404658000000,1.02599724100000;-6.41411593200000,-7.42129967800000,-7.28818372900000,-9.23522412500000,-8.12406450600000,-8.35940632100000,-6.91962601200000,-6.89938380300000,-7.07233800300000,-5.67334432100000,-5.74204437900000,-6.02316367000000,-4.15106647400000,-4.17254242400000,-3.23725598200000,-3.98819669000000,-5.20671636400000,-2.78957368300000,-0.689165970000000,-2.99146187200000,-0.257508444000000,0.289592083000000,1.61214692700000,1.56574408000000,1.03452919800000,1.13409707500000,3.18075747300000,1.00853410500000,0.649327769000000,0.576993097000000,2.59762819200000,2.05341672400000,0.338404479000000,0.170466927000000,0.537578643000000;-1.76730245700000,-2.74728426400000,-3.52180630700000,-3.73779152100000,-2.80082500300000,-3.66918197700000,-4.01776626100000,-3.78690786700000,-3.59776116800000,-3.46320226200000,-2.97560253300000,-3.20172156600000,-2.66298616300000,-2.78969179900000,-1.79483671300000,-2.63121686800000,-2.86461473800000,-1.29411177000000,-1.29332034900000,-1.49509523800000,-0.850752838000000,-1.20328344200000,-0.632331862000000,-0.610976537000000,-1.31793871200000,-0.750580381000000,-0.330387795000000,-1.19791060500000,-0.254835714000000,-1.13952521500000,-0.00646197900000000,0.0586278310000000,0.147617363000000,-0.0930655450000000,0.229790077000000;0.637673035000000,-1.35559181100000,-0.294955106000000,-1.05018405700000,-1.52251881800000,-1.77699679200000,-0.188218726000000,-0.136340889000000,0.468188096000000,0.224591539000000,0.924852184000000,2.12778293200000,1.38189839600000,1.20735516200000,0.296732831000000,1.20118311200000,0.860281075000000,-0.108378619000000,-0.118696939000000,-0.255804860000000,-0.111560010000000,0.462837495000000,-0.0556693950000000,0.484069658000000,-1.18400316100000,-0.956435900000000,-0.980081498000000,-0.0445349080000000,-0.914494831000000,-1.10440939400000,-1.46123033600000,-1.10537843000000,-1.75788089000000,-0.978022042000000,-0.468037532000000;-1.11087367900000,-1.43143593200000,-0.508663739000000,-1.38124142500000,-0.942559535000000,-1.76338106300000,-1.29063272800000,-1.05333484800000,-0.387900221000000,-0.582198007000000,-0.295951708000000,-1.01472507700000,-1.07573659600000,-0.480434460000000,-0.750810963000000,-0.527555274000000,-0.229137285000000,-1.39803329200000,-0.489536000000000,-1.14884887300000,-0.434839028000000,-0.409600237000000,-0.521554242000000,-0.509567970000000,-0.752030227000000,-0.00363812200000000,-0.405036650000000,-0.312966627000000,-1.12776671500000,-1.43880501600000,-0.765569693000000,-0.975137183000000,-0.420250267000000,-1.24573696700000,0.0259237310000000;-0.885319458000000,-0.932547757000000,-0.819920951000000,0.0352844400000000,0.869902110000000,-0.876836903000000,-0.519414515000000,-0.614788019000000,0.714673302000000,-0.307807810000000,-0.949316787000000,-0.281551375000000,0.166789273000000,-0.635590804000000,-1.55142257500000,-0.715810331000000,-1.23693486400000,-2.91092975400000,-3.04323720600000,-2.04344802600000,-2.84653045500000,-2.50764460800000,-1.26678235700000,-1.89496415400000,-1.67339161500000,-2.15671770500000,-2.72542781200000,-0.995838983000000,-0.776198275000000,-1.56387586000000,-1.35990555400000,-1.07570415700000,-1.13592838400000,-0.739496482000000,-0.218163378000000;5.43243888200000,3.32548026100000,4.87910607600000,6.71454111200000,6.35108395400000,5.44814675400000,7.92558007400000,4.51672721200000,8.81783037100000,4.84966530300000,3.91121206300000,8.06304481500000,4.30937517700000,0.619481872000000,-0.951403249000000,1.03024363600000,-0.697667608000000,-4.53285352900000,-4.54678348100000,-2.91436725300000,-2.75518069400000,-3.55096081800000,-4.88869612400000,-4.72146528100000,-4.29702866000000,-3.56379866500000,-6.07682166200000,-3.94714154900000,-3.21770261500000,-2.90796683900000,-6.84782799300000,-6.35448180400000,-3.46105472300000,-2.45274661200000,-2.85438773600000;-1.45793018300000,-2.71122576000000,-1.33785343000000,-2.95470949500000,-3.22596431000000,-2.56046213300000,-1.90289125900000,-2.60124508800000,-3.02464098000000,-2.04140992900000,-2.03401083000000,-2.45642726300000,-0.859274303000000,-0.577754946000000,1.07482195100000,0.975578812000000,0.656803860000000,1.61194187200000,2.12415349900000,1.93040404900000,2.19724015300000,1.50248638000000,1.62695017600000,1.69928554200000,1.47519254000000,1.40309196100000,2.79806773600000,0.491703326000000,1.17786326400000,-0.0506446170000000,1.80613732300000,1.05426957800000,1.40131798300000,0.565307903000000,-0.353703445000000;-2.74414838500000,-1.58337965800000,-2.27689345500000,-3.20341955500000,-1.06375267800000,-2.26967941100000,-3.39654430400000,-1.44336804800000,-1.81680246800000,-1.69015974100000,-0.124029592000000,-1.48677699700000,0.134373231000000,1.67246609500000,2.89650254200000,1.18685391700000,0.741823793000000,1.86944296800000,2.49496686200000,0.0874167890000000,0.602654940000000,-0.199135645000000,1.38255205500000,0.294997362000000,-0.541518057000000,0.522446509000000,1.72743486000000,-1.04709156800000,1.33833448800000,0.129609077000000,1.20449836300000,0.0524744540000000,0.314796107000000,-0.397638696000000,0.291339892000000;-3.44322907800000,-3.78219761000000,-3.79420285100000,-5.64828201000000,-4.80541243500000,-5.34935852000000,-5.61187988500000,-3.70385317900000,-6.25890520000000,-3.49060282600000,-3.35201955300000,-4.51992257400000,-3.31724460200000,-1.12846191400000,1.14976481400000,0.801891123000000,-0.477267653000000,0.917074839000000,1.15753912700000,0.745194115000000,0.662425624000000,-0.0598103580000000,1.01898213200000,0.0360566640000000,-0.104554346000000,0.526111560000000,1.32480135200000,0.993033263000000,1.84299952200000,1.41110477200000,2.03706038600000,1.49629372300000,1.12169951100000,0.0567658260000000,-0.188147999000000;-0.497964101000000,-0.775292070000000,-1.06003481400000,-1.72287179900000,-1.63373843400000,-1.91583552700000,-1.04604836400000,-1.92326797200000,-1.04371275900000,-1.44360418100000,-1.52028382000000,-0.238693323000000,-0.441864752000000,-0.141059232000000,-0.247707652000000,-0.232761028000000,0.0985135490000000,-0.00907439300000000,-0.0921401540000000,-0.0757843570000000,0.305549576000000,0.344548776000000,-0.807336603000000,-0.152502057000000,-0.302194270000000,-0.125287892000000,-0.521563725000000,-0.308574273000000,-0.770311412000000,-0.570832794000000,-0.483709083000000,-0.324514885000000,-0.00666277400000000,0.00332782800000000,0.0272217780000000;-0.147955541000000,-0.274991146000000,-0.00962092400000000,0.180828766000000,-0.0670407730000000,-0.102746533000000,-0.0595974220000000,-0.0737400980000000,0.665337785000000,0.148975916000000,0.296594915000000,0.787899851000000,0.212752225000000,0.0444638020000000,-0.245135231000000,0.0724864110000000,0.0139424450000000,-0.248977099000000,-0.394162636000000,-0.364518326000000,-0.401300445000000,-0.322385689000000,-0.637654554000000,-0.831746444000000,-0.911273066000000,-1.09161954000000,-1.11810474700000,-1.12546537800000,-1.25454493500000,-0.893773151000000,-0.478129884000000,-0.781242056000000,-0.808439561000000,-0.579968686000000,-0.620180361000000;-0.461219867000000,-1.82661714300000,-2.25631149800000,-2.45776786300000,-0.881015534000000,-1.69966889800000,-1.64692610400000,-1.95422504400000,-1.97603047100000,-2.13104283300000,-2.42105643700000,-0.705763281000000,-2.09734561400000,-1.98698939700000,-1.04842299400000,-1.43859497300000,-1.34194335000000,-1.18356801800000,-0.902272079000000,-1.11708910100000,-1.74215473900000,-1.33200008000000,-0.869118680000000,-0.812201554000000,-1.97806757000000,-3.06971852500000,-2.64674400600000,-1.97716337500000,-2.42127171900000,-1.94787775500000,-1.24565788500000,-0.754284044000000,-0.993735922000000,-1.05695490500000,-0.801378540000000;-0.0341968380000000,-1.02893580100000,-0.374655134000000,-0.143376031000000,-0.920094732000000,-0.138650654000000,-0.0178084900000000,-0.189936357000000,-0.596651131000000,-0.924003064000000,-0.640166306000000,-0.460294979000000,-0.128754132000000,-0.288464160000000,-0.773184835000000,-0.913443841000000,-0.332250370000000,-0.885294391000000,-1.50946112800000,-0.727442344000000,-1.27921574300000,-0.925563306000000,-1.92096678400000,-1.54893596700000,-1.51589195600000,-1.50846432100000,-1.81916722300000,-1.08965200700000,-1.37387084300000,-2.40967720100000,-1.79578742300000,-2.05496618900000,-1.56203573600000,-1.64074792200000,-1.47352965900000;-3.05993171000000,-3.21522479700000,-4.27678804100000,-4.37955649500000,-4.03879873900000,-4.73334166700000,-3.79660469100000,-4.04430382400000,-4.02802859100000,-5.17933885600000,-4.51161169500000,-4.74895741000000,-4.37029571500000,-4.34576792000000,-3.19707996400000,-3.59837025700000,-2.93300579800000,-0.687275430000000,0.260863118000000,0.0113063670000000,0.160615987000000,-0.141677857000000,0.286088690000000,-0.0317347350000000,-0.0282913540000000,0.316383584000000,1.24568629100000,0.638873103000000,0.193706499000000,0.404132866000000,0.838479004000000,0.812464718000000,0.805463356000000,0.525012626000000,0.654320936000000;-1.82211407800000,-1.76358816200000,-2.53995735600000,-3.38324606500000,-2.81486059700000,-2.51417732900000,-1.88397420700000,-1.91608766300000,-2.08509153700000,-1.94581468300000,-1.81366536700000,-2.55426951200000,-1.64557569700000,-1.74058072900000,-1.89195818600000,-1.10264204800000,-2.07225967000000,-1.36672613000000,-1.36527528600000,-1.26942385900000,-1.12319646800000,-1.67026946200000,-2.00901872000000,-0.785520360000000,-1.54488714600000,-1.65570604100000,-1.26667894200000,-1.07057457500000,-1.31952183100000,-1.21178338400000,-1.15731717600000,-1.54999633800000,-2.04754227100000,-1.90788328200000,-1.85941974500000;-1.20204360700000,-3.79904954400000,-2.59890271600000,-1.88225657700000,-2.80395082900000,-3.87146394400000,-2.74020406100000,-1.72239366800000,-0.871093176000000,-0.229723420000000,-0.151112931000000,0.782139947000000,-0.185189139000000,0.630384830000000,-0.0559721300000000,0.957425777000000,-0.205851560000000,0.0639991190000000,-1.39885401800000,-0.602670778000000,-1.61319018900000,-2.12557648500000,-1.63127760000000,-1.87430691500000,-2.21995763600000,-1.51011942600000,-1.58696624300000,-1.16189832300000,-1.06278837000000,-1.01507943600000,-1.14952999500000,-1.67104830900000,-2.13319818500000,-1.80819295900000,-2.46321560700000;-0.378653812000000,0.200624471000000,0.0465116490000000,0.408107765000000,0.528102177000000,1.34687978100000,1.85608230200000,1.98870656700000,1.80658228200000,1.50893950100000,0.833259665000000,1.91238501700000,0.857444954000000,0.405398470000000,-0.0493000510000000,-0.244346193000000,0.637701995000000,0.144396310000000,-0.631759735000000,-0.702861801000000,-0.475390768000000,-1.77290082300000,-1.22758686800000,-2.10786224400000,-1.00126054500000,-0.593471794000000,-1.71830317500000,-1.40030640400000,-1.22751012500000,-0.970854980000000,-1.44902347900000,-1.69153612900000,-1.60434872800000,-2.10259823000000,0.0114627040000000;-0.958959866000000,-0.224346670000000,-0.493613130000000,0.148588800000000,-0.0755329560000000,0.442116047000000,0.174673812000000,0.258040413000000,0.994289680000000,1.83638625900000,1.35579072700000,1.60131230200000,1.00533465000000,0.989612582000000,0.438545199000000,0.808051260000000,0.914181216000000,-0.224738734000000,-0.228437964000000,-0.0998611750000000,-1.36314142200000,-1.34447840600000,-2.02048390500000,-1.15715217000000,-2.04203262200000,-3.42902724300000,-3.96837130200000,-3.54857925900000,-4.10272585800000,-2.58489546700000,-4.50913602700000,-3.26985305800000,-2.65638051500000,-1.67316137900000,-2.44293732200000;-0.163840030000000,0.0196313010000000,-0.395005783000000,0.376541529000000,0.422974559000000,0.983138766000000,0.882825013000000,-0.143338949000000,0.399363475000000,-0.266695099000000,-0.476072944000000,-0.646487104000000,-0.311818264000000,0.0170384570000000,-2.90750216200000,-2.01359707600000,-2.44334574900000,-2.96432499400000,-3.60993616400000,-2.44613492000000,-2.18657139200000,-2.58021640400000,-2.30783058200000,-2.06629205200000,-1.53214410300000,-1.24926634700000,-2.03474504200000,-2.60519526900000,-2.07321120400000,-2.09302170200000,-1.42692718300000,-2.09554995900000,-0.487566669000000,-0.815534008000000,-0.301761493000000;-1.28195772600000,-0.412717694000000,-1.29350696600000,-0.722531118000000,-1.48503119200000,-2.26051912100000,-2.47516185700000,-2.52266137100000,-1.43580941900000,-1.62828910900000,-3.08106975900000,-2.58727487300000,-1.93803346200000,-2.31134273900000,-1.98371286300000,-2.42780478600000,-3.40916513400000,-1.91023026300000,-2.78594770000000,-3.06754422600000,-1.73703572000000,-1.60529738800000,-0.930530138000000,-1.23906004500000,-0.900580911000000,-1.04493701400000,-0.0387489060000000,-1.36538298100000,-0.268614271000000,-1.02162218600000,-0.340529491000000,-0.0659800310000000,-0.272384057000000,-0.816083854000000,-0.705675491000000;-1.31588883500000,-2.34250946800000,-2.00001629200000,-2.80685693700000,-2.70461972700000,-2.79608697500000,-2.99715062800000,-3.33918650300000,-2.34654012200000,-2.84864250200000,-2.38640566500000,-2.98933290600000,-2.53532668300000,-3.82356609600000,-2.58430298000000,-1.90976421400000,-0.881113390000000,-2.32627258600000,-1.77160920700000,-1.81477333200000,-2.31137617100000,-2.15777455100000,-1.86862751300000,-2.35657021900000,-2.13525453500000,-1.49012638600000,-2.04972576000000,-2.93977580600000,-1.73056489800000,-1.21350534300000,-0.519574438000000,-0.473285478000000,-1.37993205500000,-0.164250441000000,-0.480622982000000;-1.10218677700000,-1.20357294000000,-1.02526056500000,-1.43557260500000,-1.04285668700000,-0.180808566000000,-0.0102932090000000,-0.437258309000000,0.710337094000000,-0.182872197000000,0.238579616000000,0.656919889000000,2.62837615900000,1.54395851300000,1.05495720200000,1.47720711300000,0.885076972000000,2.17177519600000,1.23751539300000,0.111021565000000,1.01216177900000,0.458112954000000,0.257614284000000,1.62502488700000,-0.301846954000000,1.62042807100000,-0.932525427000000,-0.0835083520000000,-0.664087766000000,-0.404883456000000,0.523168129000000,0.323125842000000,0.511484236000000,0.795770200000000,-0.0945815260000000;1.22867079700000,-0.351084534000000,-0.459876144000000,-0.428535267000000,-0.435998987000000,0.417929829000000,1.00981093400000,0.520072275000000,1.44562073100000,1.02469824300000,1.46154905800000,0.560384449000000,-0.345756369000000,-1.28076908400000,-1.82996440400000,-1.60202191900000,-0.989782812000000,-1.09495234100000,-1.22426801700000,-1.54387316200000,-1.38385103700000,-0.870112947000000,-1.45329433400000,-1.77438084900000,-1.86532435800000,-2.08714872800000,-2.13168794300000,-2.62655637200000,-2.40012795600000,-1.59605222200000,-1.75243867300000,-1.53645868800000,-1.41360290000000,-1.90627926300000,-1.62980323500000;-0.925739257000000,-1.01812811800000,-0.984157540000000,-0.721827409000000,-1.05365257000000,-1.53158440300000,-0.704703672000000,-0.756926836000000,-0.420514960000000,-1.01397399500000,-0.976975325000000,-0.632251797000000,-0.887235734000000,-1.42927562100000,-0.995348584000000,-1.41417255800000,-1.70005624900000,-1.21566466100000,-1.36567361700000,-1.18815399300000,-1.36588884700000,-1.37025637300000,-1.28247532900000,-1.38251839600000,-1.53268304300000,-1.27125342000000,-1.63332485000000,-0.986862768000000,-1.17707914000000,-1.16894995200000,-0.704069515000000,-0.221571028000000,-0.0454965760000000,-0.260403857000000,-0.236101608000000;-3.32269307800000,-4.42979918500000,-3.33367176200000,-4.79246519300000,-4.86461438000000,-3.89822273500000,-4.20784791300000,-4.26854391400000,-1.85160033300000,-4.11991862200000,-3.59441216600000,-2.17252725800000,-3.96881311600000,-3.91286898700000,-3.04204846600000,-1.90747052600000,-1.70202839400000,0.285794757000000,0.572176333000000,-1.43682817500000,-1.60068176900000,-2.44971734700000,-2.22542636600000,-0.951973971000000,-1.35660104300000,0.523048098000000,-0.245626742000000,-1.35119597900000,-1.03820367800000,-0.898659414000000,1.64256572900000,1.70784827800000,1.17315350500000,-0.353414824000000,-1.65204901300000;-1.18157597100000,-2.26300872800000,-2.33722496500000,-1.89591075700000,-1.72530017000000,-2.37768990500000,-2.33923097000000,-2.61559419800000,-1.94119487900000,-1.39673523900000,-1.81246489500000,-1.66911756800000,-1.63367051200000,-1.24507621600000,-0.847480629000000,-1.40106011600000,-0.632949986000000,-0.940910400000000,-1.38012944700000,-1.22942712700000,-2.22027937900000,-1.07131123100000,-1.73139874600000,-1.95749183700000,-1.94828220000000,-1.59908608700000,-2.25744858200000,-2.03515693300000,-1.65214245800000,-1.67004632900000,-0.418232911000000,0.212391681000000,0.269687525000000,0.280161096000000,0.719318345000000;4.35573523400000,4.01249336800000,4.36795013100000,6.48944234800000,6.06788785600000,6.02710355900000,6.32711009400000,5.72775759700000,5.09062249600000,3.28743765100000,2.52620537600000,3.36868453500000,0.0175328960000000,-2.98008200800000,-3.41765083700000,-5.70779301900000,-1.44225959500000,-5.42783841100000,-6.11482068100000,-6.38976320100000,-5.38767655300000,-5.58932887000000,-7.27905349900000,-6.94399871000000,-6.48421441700000,-7.05321496300000,-6.59638551800000,-7.72586242600000,-7.48603024900000,-5.37199617000000,-8.11047183600000,-5.65200236400000,-4.25296335500000,-5.27113155700000,-2.46385596900000];
CL_tuningCurves = [-40.6111524400000,-40.5755236100000,-42.6281824200000,-40.3195920600000,-41.7952913800000,-43.5330693600000,-43.9105109000000,-42.1431698600000,-38.7906145700000,-43.3372905100000,-43.0224398600000,-42.3795213200000,-40.4841677400000,-42.0097929300000,-41.6052088700000,-41.8702101700000,-41.2600912800000,-41.8432719100000,-41.9828001800000,-41.6231281900000,-42.0100346600000,-41.7255266100000,-42.1771284000000,-42.3454140300000,-42.4612450600000,-40.1340990900000,-42.1446600400000,-41.6085249300000,-41.1792591200000,-41.2588679100000,-40.9466916100000,-40.1151192200000,-39.7511390600000,-37.7830594500000,-37.8039294000000;-44.0060364700000,-38.3251377300000,-39.9457795000000,-44.2681938500000,-44.2387024000000,-42.4542178200000,-41.4923625300000,-45.5702989800000,-41.2131754900000,-41.2149037200000,-40.9980324500000,-41.1766093500000,-41.0824105800000,-44.0553786300000,-43.6523196000000,-42.5742260600000,-43.4258139000000,-44.3006158300000,-44.0776285900000,-41.4564021700000,-41.9143473000000,-44.2985521700000,-43.6175840800000,-43.9548662400000,-42.2753316900000,-42.7970451000000,-43.7806703100000,-43.3163198500000,-43.3144908700000,-45.2510533200000,-44.6746792000000,-43.8249989500000,-45.2057990300000,-42.0155381500000,-43.1631470900000;-41.0290946400000,-38.6568427600000,-39.0649474800000,-40.1152436400000,-39.6767221400000,-41.8225537200000,-42.0931348000000,-41.3794662800000,-41.5169318200000,-39.1427076700000,-42.4730187300000,-41.3942616500000,-37.4453393800000,-37.5128670100000,-40.5177887600000,-41.0294893200000,-36.8003005100000,-36.8639983000000,-35.4857469300000,-35.5594431200000,-36.7534033800000,-41.5143480500000,-40.3669643200000,-40.9897779700000,-41.1731554200000,-41.8923626300000,-38.8642925800000,-41.8957538600000,-39.0047570200000,-41.7998013300000,-41.7891989100000,-38.1856251100000,-42.0396587800000,-42.3375503500000,-42.0916787600000;-37.9911691300000,-37.0096668400000,-36.0397942700000,-36.8714082700000,-37.1053571800000,-38.5444323800000,-38.2583836800000,-37.6811178600000,-38.2289495700000,-37.5140705200000,-39.5486624600000,-40.2534992000000,-39.7080056700000,-38.6615895100000,-39.3456348900000,-39.1488748800000,-38.8455331600000,-38.8462933200000,-38.9431190300000,-38.7410479400000,-38.5020360500000,-40.5232535100000,-41.0537839600000,-42.5433757700000,-41.2187256300000,-41.6981866000000,-41.1804836100000,-39.0274578700000,-40.5147099300000,-40.7334692200000,-41.0847394700000,-39.6444222900000,-39.3781339200000,-39.3395802900000,-39.5312949200000;-38.9306309400000,-39.3767542100000,-39.6254515900000,-38.9908542900000,-39.5314768700000,-40.5341884100000,-38.7342945400000,-40.2330325700000,-41.5957900300000,-40.7863415500000,-40.1068652900000,-41.2753468500000,-37.6835268100000,-41.4415124300000,-43.1491003600000,-40.9793110200000,-38.6703961200000,-36.4231037900000,-37.9088318600000,-35.3841085600000,-36.4501144200000,-35.3343279100000,-33.0657130200000,-31.5442798400000,-32.0558247000000,-34.2989975100000,-33.5034935400000,-33.9970749100000,-34.5155900200000,-33.2381451500000,-33.8305259600000,-33.3614946500000,-36.2614411000000,-34.8828911900000,-39.1311149800000;-40.1739823900000,-40.1538175900000,-38.5169697600000,-39.5073899900000,-39.0507190400000,-40.6363722600000,-38.0296642900000,-41.0170120100000,-39.5416751400000,-38.9989766500000,-38.1492312000000,-38.3836612400000,-41.0030336900000,-39.7231867300000,-39.2190615100000,-38.3264669900000,-38.4910120500000,-37.9605795300000,-38.0935142000000,-40.5722563600000,-39.6410338600000,-39.5534003700000,-37.5534180900000,-37.1188217800000,-40.6081890100000,-40.0600664500000,-37.8668671000000,-40.4644065800000,-38.5991890800000,-37.9766184000000,-36.9639350000000,-37.7929107600000,-41.2841157600000,-40.7780942400000,-39.9372207100000;-36.2212741200000,-36.5034827500000,-36.8972969800000,-37.8219598400000,-35.4782663500000,-37.3779343300000,-35.7200366000000,-37.5988263200000,-37.1132610600000,-38.4863995700000,-36.9812280300000,-37.5192247200000,-35.1608818300000,-35.0578691400000,-34.9590884500000,-34.4793199500000,-34.1630112100000,-34.1927811900000,-33.8954192800000,-34.1328818000000,-33.6392309700000,-35.2384807200000,-35.1760301900000,-34.7872089800000,-34.5050297000000,-34.8714668300000,-34.9950981600000,-34.3064860100000,-33.7457744800000,-34.7905465700000,-34.4957618400000,-34.2960518100000,-34.2810394100000,-36.1864430400000,-34.8919673700000;-36.6455856300000,-36.2175731700000,-37.2718105900000,-35.6212950100000,-34.3818908900000,-33.4685394500000,-35.1824242300000,-34.7676921800000,-32.7984378000000,-33.8689547700000,-31.3742375300000,-35.5274951500000,-34.5228945400000,-33.9839869900000,-32.9939404700000,-33.3261447100000,-31.8798012200000,-31.8986696400000,-34.8314615600000,-36.7667281600000,-36.0736907400000,-37.1997759100000,-37.2682007500000,-37.9418880900000,-37.4860205300000,-38.7534401600000,-39.7238703400000,-38.9631289800000,-36.1746224800000,-37.5636967900000,-38.6266871500000,-36.7135806400000,-37.2532358200000,-38.5743493000000,-37.2581535500000;-40.3168203000000,-42.5291440800000,-43.2545635700000,-42.9449983200000,-41.8519406900000,-41.4991537400000,-42.3284089500000,-41.3666988700000,-43.2513297500000,-42.4396494700000,-43.2305560100000,-39.9301540500000,-39.4067403000000,-37.5443261600000,-37.2226656100000,-39.7849844400000,-37.5692981600000,-36.4904081100000,-37.8566903900000,-37.5306372800000,-36.3542932700000,-39.3046177900000,-39.8818779600000,-40.5670812800000,-40.3570372800000,-38.3622182500000,-39.9190327100000,-38.2302183400000,-39.4836460600000,-41.0615025800000,-39.8166876200000,-37.3902744500000,-38.1553249600000,-39.9838378000000,-40.2442384000000;-31.3640454100000,-31.6257038800000,-30.0778236400000,-30.6544362800000,-29.7980875900000,-28.9389134700000,-29.1449797800000,-30.6155188400000,-29.4328432400000,-30.0868605000000,-28.6475493100000,-30.0969218600000,-29.4333486300000,-30.5197482700000,-27.5488025300000,-29.9096755300000,-30.8139869500000,-30.4425234900000,-31.5445136600000,-30.2855118200000,-30.7472494500000,-29.0462448300000,-29.9300960600000,-30.3620003400000,-31.9300575100000,-30.3104390700000,-30.1701670100000,-30.2056777500000,-29.9449356900000,-31.1483660200000,-31.2405150500000,-30.2112985400000,-31.2018045900000,-31.5252657500000,-31.2817520300000;-42.5489560000000,-44.8004745200000,-43.3619341300000,-44.1744864200000,-41.0449272700000,-43.5166340900000,-40.8618771700000,-41.0252735400000,-41.4449769300000,-41.2730943700000,-40.2774388500000,-41.6313244400000,-41.8139304600000,-42.4950748500000,-42.1194532100000,-41.9686228300000,-42.0659565600000,-43.5777016700000,-42.4242485600000,-43.4505177800000,-43.9800366700000,-44.1285225500000,-44.5805374600000,-48.7770511000000,-49.4153098300000,-46.5422218500000,-44.9986760600000,-44.1993024800000,-43.8915561800000,-45.2510625100000,-45.0426402900000,-45.9803735800000,-43.8121713600000,-44.0843720500000,-41.6440775800000;-42.2768533900000,-42.8468551200000,-42.3918265700000,-42.4317879200000,-45.1746577000000,-42.7624704000000,-41.3618401800000,-41.6351695700000,-42.0239266100000,-40.4351627000000,-42.3456535000000,-42.1571532800000,-43.7272842000000,-41.9573949500000,-39.5589068500000,-40.2913736900000,-40.2070575300000,-40.5220791300000,-40.7928191800000,-39.8393307200000,-41.2693433600000,-41.3919138000000,-42.8133620600000,-41.6712992900000,-43.3424866900000,-42.1815262200000,-41.9214087800000,-43.2969398200000,-42.5086146100000,-41.9649125500000,-42.1171874900000,-42.1989130500000,-42.4447268200000,-42.7022658300000,-42.6306170700000;-39.2219155700000,-40.2679592000000,-40.8930834200000,-40.5993384400000,-41.6379297700000,-42.2597519800000,-40.9471799700000,-40.5958425700000,-40.5440071400000,-40.8706150600000,-40.8959718900000,-40.1063387000000,-40.8296402300000,-39.9231428800000,-40.6629644800000,-39.2641867600000,-39.5564121700000,-38.8804258900000,-39.6784591200000,-37.9127629700000,-37.9600181200000,-38.0561970300000,-37.7446032000000,-39.8233622800000,-38.6780833400000,-36.9828940100000,-37.5289151000000,-36.0217109500000,-36.9787005700000,-37.2028481700000,-36.5322038100000,-36.9890940200000,-38.3308894200000,-36.6607211200000,-37.4945442000000;-37.3655782500000,-40.2362415400000,-41.0785179300000,-41.5824216600000,-42.0358867500000,-40.2607239200000,-41.5581457100000,-41.2459953000000,-40.9980984000000,-39.5677600600000,-40.5828965200000,-40.0235632100000,-37.4057189400000,-37.9243403400000,-37.5721469600000,-36.6126395500000,-37.3945155100000,-35.8996173300000,-37.5288696900000,-34.4131184100000,-35.4841043500000,-34.7739105500000,-31.9654443200000,-32.8297739800000,-32.3405878000000,-34.0197686700000,-34.1552895300000,-32.7168699900000,-32.2637442800000,-33.7910570200000,-37.1222603300000,-34.8160848200000,-33.4543130400000,-34.8161282700000,-33.8851044500000;-38.6660705900000,-40.2291831600000,-40.8540423300000,-42.9801521300000,-42.8250336800000,-42.5029542500000,-40.8805610100000,-41.7756000100000,-41.5343112800000,-42.5706283200000,-42.5010139100000,-41.9623248300000,-42.9188529800000,-43.0368784600000,-42.3246390700000,-41.4606309900000,-42.0288907500000,-40.8743761200000,-40.1487289500000,-40.4218623200000,-39.7795738800000,-38.3233226500000,-39.9595702400000,-41.1984787100000,-39.6565230900000,-40.9234033300000,-40.6805204300000,-40.2644322300000,-40.4211577200000,-41.0620589200000,-40.5434755000000,-40.6022806000000,-39.0363938200000,-38.6548906700000,-38.6342094300000;-38.2861149900000,-40.8455711600000,-39.6284269400000,-38.4103783200000,-38.3777239700000,-38.5037368300000,-39.4146803900000,-40.0728833500000,-39.8191608500000,-38.6662311600000,-39.2733020100000,-39.7151336900000,-38.2722446400000,-38.7067525300000,-40.2678397000000,-39.9527938800000,-39.7800832300000,-39.8680478800000,-40.3018461000000,-40.5523072400000,-40.0735282400000,-39.1665354300000,-39.5131438800000,-39.7337999600000,-40.0396839000000,-39.4388010900000,-39.9786257700000,-39.6503526000000,-39.5318416300000,-40.4146625900000,-39.8866951800000,-39.8576756400000,-40.3773198900000,-39.6547404000000,-39.4572487800000;-38.4577350700000,-38.8550554400000,-38.7980524200000,-39.5221413800000,-41.2229316400000,-41.2072460100000,-39.2271702700000,-38.4856302200000,-37.9931302200000,-38.6885781300000,-38.6710539000000,-37.8620786400000,-36.8216905800000,-39.6464097500000,-38.5736141900000,-37.9313601900000,-38.9967985000000,-36.9767663700000,-35.7689340800000,-39.8216617200000,-38.2186561200000,-37.7290394100000,-38.5945255000000,-40.5324893300000,-37.6172091100000,-41.4730386300000,-40.9805772400000,-40.9075951400000,-38.7203473200000,-39.1939506900000,-38.7515112800000,-39.6089876500000,-37.7304251700000,-37.9136305900000,-35.8562181300000;-39.2102143100000,-40.5114129700000,-38.9629208500000,-42.4429924400000,-43.6715078600000,-44.0801882100000,-43.0085972900000,-43.8274118700000,-42.9446098000000,-41.8261121800000,-41.2800641500000,-41.5842121900000,-41.7756704000000,-43.0908804700000,-42.2294080400000,-41.6256187300000,-42.6543334600000,-44.5654390600000,-44.4219962900000,-41.9117800200000,-45.6721823500000,-44.8505728900000,-45.2647894300000,-45.3475849500000,-44.1350436900000,-46.1150698800000,-45.1553317300000,-45.3205423600000,-44.8600727100000,-44.2601662800000,-42.8655346400000,-42.3492708100000,-42.9481400800000,-42.4126591300000,-42.4562513100000;-38.6792752700000,-38.1089500600000,-35.9864386800000,-35.0524241200000,-36.2233105100000,-35.8178798800000,-36.2027179500000,-36.1291038700000,-37.0165532500000,-39.0173592600000,-37.9380955800000,-37.4523476300000,-38.3058044400000,-39.9945226200000,-42.9657861500000,-42.7455739600000,-43.3845927800000,-43.3444334900000,-45.5746286500000,-47.0816331200000,-46.3198969500000,-46.0406494400000,-46.3192176800000,-47.9626697700000,-47.3225554900000,-46.1335905600000,-45.3589531200000,-45.2256091700000,-45.3372005100000,-47.1468241600000,-46.5920794400000,-44.8461450200000,-44.9813441400000,-42.5192817900000,-46.9014794600000;-41.0820894700000,-43.6727706800000,-43.5917432900000,-41.9999969200000,-42.1477019800000,-42.5837741800000,-41.6543074200000,-40.8220441800000,-42.6209321300000,-43.1449169300000,-42.0280540400000,-41.9840044700000,-41.1773916400000,-40.7538468600000,-41.0063994200000,-37.8509191200000,-38.3763550000000,-39.2257658100000,-39.2812879500000,-35.8579613900000,-38.8714588800000,-41.3665867300000,-40.3894479700000,-38.9679563000000,-42.4917859700000,-41.4174624700000,-39.3490548800000,-42.6772372700000,-40.2588927400000,-38.0949053900000,-39.4135943800000,-39.6859034200000,-37.3369987700000,-39.7314957900000,-38.8269381500000;-39.3809719000000,-40.5337583600000,-39.8183285800000,-40.9302642400000,-40.4229565000000,-41.7751374900000,-41.4199441500000,-36.5204763100000,-35.5272719900000,-35.5603733600000,-36.8344276700000,-37.8298954700000,-40.0887048300000,-38.3780568400000,-38.4504622900000,-37.0656526000000,-36.6810516400000,-37.2432295200000,-36.2346765000000,-35.6800678700000,-35.2404143900000,-36.2309718400000,-36.0313328800000,-35.5790670800000,-34.3525661700000,-34.7741201000000,-35.2468146500000,-33.8377894000000,-34.0555284800000,-34.3494643700000,-34.3838947800000,-33.2594214700000,-34.3147974800000,-34.7876504400000,-37.1169089500000;-45.3266106500000,-47.6134671500000,-47.2396482800000,-45.6076215500000,-47.5089470700000,-46.3256079100000,-46.8708594400000,-47.8203476400000,-47.2954502700000,-47.5209288800000,-46.7661850000000,-47.5936855200000,-46.7187798800000,-44.2745807900000,-45.6732894000000,-45.0816284200000,-42.1699934000000,-41.1472087200000,-42.9162463800000,-43.8611730900000,-43.8260914900000,-42.6551902400000,-42.2942544500000,-43.4080163000000,-43.8419397200000,-43.0722358800000,-43.7305992600000,-40.3242954300000,-39.8712163600000,-42.0697949400000,-44.2304764300000,-43.7258775800000,-43.3647338300000,-41.8857036400000,-40.9822167700000;-34.7373830900000,-34.2215538700000,-35.3956759900000,-35.7581557200000,-33.0504972300000,-31.4529795100000,-34.8242731300000,-35.0327091700000,-35.1657701300000,-35.2762280400000,-34.1132350400000,-34.5020162700000,-33.8028658800000,-34.4956233500000,-34.0443425100000,-34.4526184400000,-34.3171891400000,-34.0951382600000,-33.4360698400000,-33.2280326000000,-34.1244274500000,-33.2207673200000,-33.1457245500000,-33.0235293000000,-33.8539089300000,-33.0405926600000,-33.2814416500000,-33.5737161100000,-32.8536829200000,-32.8998645800000,-34.2097414100000,-34.1606820400000,-33.0592536600000,-32.1688322000000,-31.2504752400000;-32.6696810700000,-32.5157231500000,-32.4454936300000,-32.8128898400000,-31.9162827000000,-32.1545113300000,-32.6374427200000,-33.0014782300000,-32.1906084000000,-32.2812574600000,-32.0401217900000,-31.9583578800000,-31.8886293000000,-31.8810648200000,-31.9000380300000,-32.0559576600000,-32.3506876400000,-32.9309796200000,-33.1587873900000,-32.8186926800000,-33.2834428200000,-33.1065820900000,-33.5010283500000,-33.4251233100000,-33.9216947100000,-33.1675747300000,-33.8033157600000,-33.6615767500000,-33.3189886300000,-33.4710641600000,-33.5277069900000,-33.0595752400000,-33.0469477600000,-33.3712648400000,-32.9805244700000;-36.8238037000000,-36.9162564700000,-36.8524324000000,-37.4840185800000,-35.1773921200000,-36.4118798200000,-36.5279851200000,-37.2122223400000,-38.0161099400000,-37.0997871200000,-37.7534600400000,-37.8442562000000,-37.3977287900000,-36.6461483700000,-36.7640360600000,-37.8799927800000,-38.0591746500000,-37.5728308200000,-37.4591842700000,-37.9507784000000,-37.5459778100000,-36.8279542500000,-33.9722459700000,-36.1874513200000,-37.7676424900000,-36.5992396400000,-37.1830609200000,-38.4494918000000,-37.1234093400000,-37.1735780000000,-37.7782290400000,-35.0145494200000,-37.1147632000000,-35.4628142300000,-36.2092147000000;-38.2779167400000,-38.0069074000000,-37.3786999800000,-37.4954584400000,-36.8628007400000,-36.4283290500000,-37.8851125500000,-38.6932798800000,-38.0063163500000,-38.3932376600000,-38.8028040500000,-38.0162591700000,-38.7263264200000,-38.5680942000000,-38.9042175800000,-38.1848611600000,-39.1179138900000,-37.9670686700000,-39.4256530000000,-39.1338824700000,-38.2079403900000,-39.8421680900000,-39.1529968800000,-39.9448772400000,-39.1164676700000,-40.0312454800000,-38.3732964900000,-37.4864919900000,-36.8481410200000,-38.0273853400000,-37.7063532200000,-39.4714578400000,-39.4825612100000,-37.7347441500000,-36.0526563900000;-32.5382534600000,-34.0535599900000,-32.1813624700000,-35.4408640400000,-33.0252126000000,-36.1044378700000,-36.8477593100000,-35.9417911100000,-36.6925302900000,-35.7308606800000,-36.6215593600000,-36.7549430600000,-36.2939619100000,-36.7934932400000,-36.5170641600000,-37.0514609500000,-33.8738519800000,-34.3751292300000,-33.7868296200000,-32.7319741600000,-32.6813753600000,-29.2432764400000,-32.8806063500000,-32.8722682800000,-32.8889337700000,-33.3938924000000,-32.5437144300000,-32.2826907900000,-32.6849733700000,-32.5547077000000,-30.9744171600000,-32.7929562600000,-32.5752300400000,-32.6400420100000,-33.1857328900000;-37.2055255100000,-36.7659128600000,-37.5755524000000,-38.0204390600000,-38.2910987300000,-38.1006256400000,-38.4575821400000,-38.3937338600000,-37.9999084400000,-38.3818381100000,-36.6532613000000,-36.9856682800000,-35.9402832300000,-36.3853844200000,-36.8988755700000,-37.2455096300000,-36.8610933100000,-36.8551789900000,-37.0969023000000,-36.8792868600000,-37.0746911700000,-37.2274723600000,-37.3118744200000,-37.4266741500000,-36.9487867100000,-37.5016584300000,-37.4490580500000,-36.1299205600000,-36.7898886100000,-37.1923753600000,-36.8134423100000,-36.2076214300000,-36.5869574700000,-36.3129405800000,-35.8902794200000;-42.5374175400000,-42.6624952800000,-43.3753638900000,-44.6608159200000,-44.4675912000000,-45.4229619100000,-44.7307998400000,-43.3603607900000,-43.5831272800000,-43.2722155200000,-44.9283915400000,-44.6331122400000,-43.3798529300000,-42.7287310100000,-42.7777434900000,-43.4390803600000,-43.0662952700000,-43.5193839400000,-44.7406192000000,-43.6251468200000,-43.7790692700000,-44.2431652600000,-43.9536965100000,-43.4025439300000,-43.5247848200000,-43.4821224400000,-42.9635861400000,-43.8584865100000,-44.0932096300000,-44.6905052600000,-43.1450877100000,-41.7541603700000,-43.1275127100000,-41.7717632700000,-42.5554268400000;-37.6304230700000,-39.8170866900000,-35.0936893300000,-39.7108467100000,-40.3942468800000,-41.6421350900000,-42.1208017100000,-37.5264723700000,-39.5414074400000,-39.7445211300000,-42.6431110200000,-39.8097537100000,-41.9284192100000,-39.1528625900000,-42.0205475100000,-41.4564139400000,-41.2136500500000,-40.3445064400000,-38.6194605100000,-41.7659373700000,-37.5234256500000,-40.1659005500000,-37.7670104000000,-36.9819042900000,-35.9279599900000,-37.4361041500000,-37.9660985400000,-40.0605807300000,-37.4477686900000,-40.9823688100000,-42.9660270200000,-43.0996226600000,-42.1975720200000,-40.6157174400000,-42.3784040000000;-41.6855194800000,-41.2705668500000,-40.9140102800000,-41.5882159500000,-40.1003993000000,-40.6114686100000,-41.5281510300000,-41.0128692300000,-40.9626814900000,-40.4811533400000,-40.5148100300000,-42.0163997700000,-41.5826423900000,-40.5574264400000,-39.5548124100000,-40.3019321800000,-39.6543730700000,-41.1019004800000,-39.5331861100000,-41.1699442600000,-42.3840280600000,-41.6111575300000,-42.6964997300000,-42.7302572700000,-42.9396529700000,-43.5195758200000,-43.4377281200000,-44.0377675300000,-44.0030189800000,-44.3632907000000,-43.4603787600000,-43.6391942500000,-42.8374376000000,-43.2390225900000,-42.2442291500000;-36.9916803700000,-38.2303603200000,-37.4539819600000,-36.5144861800000,-37.5147850800000,-38.5709136000000,-38.7361104700000,-39.4113142700000,-38.9670189300000,-39.2982226800000,-38.6991430200000,-38.5414361700000,-37.6659227100000,-39.9260990100000,-42.2548010800000,-43.6886479800000,-42.0729036500000,-42.7807989000000,-40.8856747200000,-41.6421741600000,-40.9417372700000,-40.0298192900000,-40.3714861000000,-38.8437687100000,-42.5580629900000,-43.0549400800000,-41.3163827300000,-42.3556650700000,-42.0927862600000,-41.5158082900000,-42.6942414100000,-41.4080894300000,-41.3311803700000,-40.4513498800000,-39.4047120700000;-33.0898693100000,-33.5202545700000,-34.3645589200000,-36.8370682300000,-38.7372082700000,-37.8278748600000,-35.8906648300000,-39.0460534300000,-34.4454842200000,-35.7534496400000,-35.3496953000000,-35.1628411700000,-34.2014658400000,-33.4846638900000,-34.5133550300000,-34.3225405900000,-34.6855846000000,-34.4184927500000,-35.4839061500000,-34.7777469700000,-34.7340804700000,-34.7569983300000,-34.8862345400000,-34.4428430300000,-33.2202086700000,-33.9189110900000,-33.6511494100000,-33.8095974300000,-33.8820440700000,-33.6954162600000,-32.7370625900000,-33.2732489400000,-33.2659371200000,-33.2551607200000,-33.7414583000000;-33.1553914600000,-33.2466071400000,-32.2374890100000,-35.2723933500000,-34.9876014100000,-34.7383695000000,-33.3807006100000,-34.7975396000000,-32.6021605400000,-33.6193886100000,-35.8793134300000,-35.9293746900000,-35.7838490800000,-33.6094528600000,-33.2901830100000,-36.8156695000000,-35.0766154300000,-34.0869135700000,-34.8552444700000,-34.5940350900000,-30.5762216900000,-34.6764185000000,-35.3785301600000,-37.0071403300000,-36.4183175600000,-35.7711536800000,-35.3532826200000,-34.0164748500000,-32.4632034900000,-35.3263244400000,-34.5976207400000,-33.8860794500000,-34.2058123900000,-31.4029257200000,-30.7361686500000;-42.9403770400000,-42.6617997800000,-41.7901846000000,-40.9595958700000,-41.7430876400000,-41.9757208300000,-40.9562544900000,-39.9376093400000,-41.8245314400000,-44.0116259200000,-41.7045445900000,-40.8853026100000,-39.4408608800000,-38.4675664500000,-39.8855628600000,-40.4919305600000,-39.7597348700000,-38.8646991900000,-39.6500063900000,-39.8323310700000,-41.2583968800000,-40.9514181300000,-42.1642730500000,-43.1504230100000,-41.5626447700000,-41.0348438700000,-41.8113350600000,-42.0248358900000,-42.3117616200000,-41.7068486800000,-41.4365645000000,-42.4629839700000,-41.7386287400000,-42.7905015000000,-40.3168678400000;-40.3386901800000,-39.7797865600000,-39.1527257000000,-40.3114109300000,-40.1512275700000,-40.8333649800000,-41.6841100400000,-39.3964662300000,-42.0973187600000,-40.8348932700000,-41.7567177700000,-40.4092941600000,-39.6153472800000,-40.3329344800000,-42.3347905300000,-42.9432450200000,-43.1774058800000,-41.0919979000000,-40.3362142900000,-43.7316798400000,-42.5735876200000,-45.4817584200000,-42.4742891100000,-41.5547392500000,-44.1457377300000,-44.4780361300000,-43.1127764500000,-43.0287028900000,-43.3923221200000,-40.9149998800000,-42.8162331700000,-42.4050691200000,-41.5673761200000,-40.6398828500000,-43.1998500100000;-33.4519480200000,-33.3857755100000,-33.7980225200000,-33.7805201300000,-34.5530545700000,-34.9893907700000,-34.3815598800000,-34.7351667600000,-33.8570575400000,-33.6273566200000,-31.5027236900000,-34.3269190600000,-33.6289292700000,-33.7335707400000,-32.0745812700000,-33.0686535300000,-34.3694376200000,-34.1011607800000,-34.3208566200000,-33.9368122200000,-33.4352460600000,-34.2205737700000,-32.9783779000000,-33.8203893700000,-34.5482135600000,-33.8023857300000,-33.9683110100000,-33.4716803100000,-33.5784587700000,-33.7310349200000,-33.4662035300000,-33.3930315800000,-32.6395854300000,-32.4430998200000,-33.4678513800000;-36.7667515000000,-38.3857442600000,-39.0591968400000,-39.5138145600000,-39.9779542700000,-38.7519724700000,-39.6067378500000,-39.6480895800000,-39.7354703700000,-39.0438462700000,-39.8002162000000,-38.9265675200000,-38.2470410000000,-38.3479752100000,-38.7235051900000,-37.2879945600000,-37.3341648100000,-36.3558457500000,-36.3843358400000,-34.6800238100000,-36.3340437200000,-34.9800094600000,-35.4251097300000,-34.4689872800000,-34.8407719100000,-36.0050560700000,-35.6217142600000,-35.3888825100000,-36.0068506900000,-35.9814361000000,-35.4952098100000,-34.5809684800000,-35.9576345100000,-33.5722153700000,-34.0951809900000;-41.3648906300000,-41.3849520000000,-42.5498120800000,-43.5013266800000,-43.7939215500000,-43.7526707300000,-44.0017582100000,-43.2133518500000,-42.9148462200000,-41.2350658500000,-42.6594407700000,-42.8850303000000,-43.1785304100000,-42.7796462400000,-42.2053073300000,-42.5387143700000,-42.1250308500000,-42.2877154800000,-41.3429377300000,-41.4472937800000,-41.5294218300000,-41.5618133300000,-40.8431794400000,-42.0837765100000,-42.0327117500000,-42.0962610200000,-42.2412453100000,-42.4327927600000,-41.3499898800000,-41.8872283800000,-40.8594952900000,-40.9858426500000,-40.4699400700000,-40.4078474300000,-41.3087766700000;-33.6004804600000,-33.4772376500000,-34.0372138500000,-39.1804804400000,-35.3376735700000,-36.9114455200000,-35.3822413500000,-33.7376989700000,-32.8387642600000,-31.7480300400000,-33.8938778800000,-34.5163897200000,-40.4683054500000,-42.4590408600000,-41.6677836900000,-41.7120017300000,-44.0359031400000,-43.6721799800000,-44.9369207400000,-43.4232511300000,-45.0330970700000,-46.4868236900000,-45.0535046900000,-45.5588272000000,-45.7377782800000,-46.9677017700000,-45.5832555900000,-47.0538094000000,-47.2051348600000,-47.5162104100000,-46.9691437000000,-45.5940333300000,-46.7638730100000,-41.7371632400000,-41.5897611400000];
flyNum = [102;107;110;111;113;114;115;127;132;158;171;179;179;184;187;189;191;192;203;229;232;233;234;240;254;257;260;264;267;269;270;271;272;273;274;278;279;281;287;288];

%% Plot traces of the tuning curves on same figure
ephysSettings;

SMOOTH_DATA= true;
% order for median filter smoothing
ORDER_MEDFILTER =2;

OL_YMIN = -10;
OL_YMAX = 10;

CL_deltaYMIN= -10;
CL_deltaYMAX = 10;

% loop over all cells in data set
for i = 1:length( OL_tuningCurves(:,1) )
    
    % without smoothing
    OL_tuningCurvesSmoothed = OL_tuningCurves(i,:);
    CL_tuningCurvesSmoothed = CL_tuningCurves(i,:);
    
    if (SMOOTH_DATA)
        % smooth data
        OL_tuningCurvesSmoothed = medfilt1( OL_tuningCurves(i,:), ORDER_MEDFILTER, 'truncate'); % Median filtering of the trace
        CL_tuningCurvesSmoothed = medfilt1( CL_tuningCurves(i,:), ORDER_MEDFILTER, 'truncate'); % Median filtering of the trace
    end
    
    % save data for later:
    OL_smoothed(i, :) = OL_tuningCurvesSmoothed;
    CL_smoothed(i, :) = CL_tuningCurvesSmoothed;
    
    % find corrcoef between OL & CL
    [currCorrValue , ~] = corrcoef( OL_tuningCurvesSmoothed, CL_tuningCurvesSmoothed);
    corrValues(i) = currCorrValue(1,2); % store correlation output value
  
    figure; set(gcf, 'Color', 'w');
    
    % plot OL tuning curve
    subplot( 2, 1, 1);
    % add grey dotted line at 0
    plot( barPositionDegreesFromMidline, zeros( 1, length(barPositionDegreesFromMidline) ),'--', 'Color', [ 0.7 , 0.7, 0.7] ); hold on;
    % plot data
    plot( barPositionDegreesFromMidline, OL_tuningCurvesSmoothed, 'Color', [ 0 , 0, 0.7] ); hold on;
    
    ylim( [OL_YMIN OL_YMAX] );
    text(barPositionDegreesFromMidline(1),max( OL_tuningCurvesSmoothed ) ,['open loop' newline 'random bar position'], 'Color', [ 0 , 0, 0.7])
    
    xticks([-100 0 100])
    yticks( [OL_YMIN OL_YMAX] );
    
    ylabel('\DeltaV_m (mV)');
    title( [ ' flyNum:' num2str( flyNum(i) )  ' corrcoef:' num2str( round( corrValues(i) , 2 )) ]);
    box off; niceaxes;
    
    % plot CL tuning curve
    subplot( 2, 1, 2);
    plot( barPositionDegreesFromMidline, CL_tuningCurvesSmoothed ,'Color', [ 0.8 , 0.1, 0] );
    text(barPositionDegreesFromMidline(1),max( CL_tuningCurvesSmoothed ) ,['closed loop' newline '1 bar world'], 'Color', [ 0.8 , 0.1, 0]);
    
    ylim( [ mean( CL_tuningCurvesSmoothed ) + CL_deltaYMIN , mean( CL_tuningCurvesSmoothed ) + CL_deltaYMAX] );
  
    yticks( [ ceil( mean( CL_tuningCurvesSmoothed ) + CL_deltaYMIN) , floor( mean( CL_tuningCurvesSmoothed ) + CL_deltaYMAX ) ] );
    xticks([-100 0 100])
    
    ylabel('V_m (mV)')
    xlabel('bar position (deg)')
    box off; niceaxes;
end

%% Compare the mean OL to CL correlation with the shuffled distribution
[allPairsCorr ] = corr( OL_smoothed', CL_smoothed' );

% bootstrap comparison mean of corr for 40 random pairs to get a estimate of the disruption for those mean values
meanCorrRandomPair = [];

NUMOFPAIRS = 40;
NUMOFDIFFERENTSAMPLES = 10000000;

for i = 1: NUMOFDIFFERENTSAMPLES
    % corr analysis updated to be with replacement using randi() instead of randperm()
    randIndex =  randi( length(allPairsCorr), 1, NUMOFPAIRS );
    % pick 40 random values from allPairs:
    meanCorrRandomPair(i) = mean( allPairsCorr(randIndex)  );
end

plotPDFandCDF( meanCorrRandomPair ); hold on;

%% scatter plot of all true correlation values and shuffled correlation values
figure; set(gcf, 'Color', 'w');
bar( mean( corrValues ) ); hold on;
errorbar( 1, mean( corrValues ), std( corrValues ), std( corrValues ) ); hold on;
scatter( ones(length(corrValues),1 ) , corrValues ); hold on;

bottomInterval_2SD = -0.01747; 
topInterval_2SD = 0.18545;

bar( mean( meanCorrRandomPair ) );
scatter( ones( 2, 1) , [ bottomInterval_2SD, topInterval_2SD ], 'filled' )

ylabel( 'correlation' );
title( ['meanCorr: ' num2str( mean( corrValues )) ' shuffledMeanCorr: ' num2str( mean( meanCorrRandomPair )) ' 95% ci: ' num2str( bottomInterval_2SD ) ' to ' num2str( topInterval_2SD ) ] );

% Violin plot of the shuffled correlations
violin( meanCorrRandomPair' );
ylim([ -0.2 1]); 
box off; niceaxes;

%%
function [] = plotPDFandCDF( data )
% PLOTPDFANDCDF - plots probabily density funciton and cumlative
% distribution function for current data

% make the probability density function curve by building a histgram of the values 
figure; set(gcf, 'Color', 'w');
H = histogram( data, 100, 'Normalization','pdf'); hold on;

pdf = H.Values;

% loop over and build the cdf - cumlative distribution function
cumlativeSum = cumsum( pdf );

% normalize
cdf = cumlativeSum /  max(cumlativeSum);

binMiddles = H.BinEdges(1:end-1) + ( H.BinWidth / 2 );
plot( binMiddles, cdf ); hold on;

% 2.5% inverval cut off
bottomInterval_2SD = max( binMiddles( cdf<0.025 ));
plot([bottomInterval_2SD, bottomInterval_2SD], [0,1]);

topInterval_2SD = max( binMiddles( cdf<0.975 ));
plot([topInterval_2SD, topInterval_2SD], [0,1]);

% 16% interval cut off
bottomInterval_1SD = max( binMiddles( cdf<0.16 ));
plot([bottomInterval_1SD, bottomInterval_1SD], [0,1]);

topInterval_1SD = max( binMiddles( cdf<0.84 ));
plot([topInterval_1SD, topInterval_1SD], [0,1]);

niceaxes, box off;
xlabel('x metric');
title(['pdf & cdf  1SD: [' num2str(bottomInterval_1SD) ','  num2str(topInterval_1SD) '] 2SD: ['  num2str(bottomInterval_2SD) ','  num2str(topInterval_2SD) ']']);

end
