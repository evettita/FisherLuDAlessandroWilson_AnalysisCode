% plot1barStabilityDataSet
%
% Plot the full data set looking at stability visual receptive fields when
% the fly only experiences 1 bar.
%
% Yvette Fisher 11/20/18
clear all; close all
ephysSettings;

% 1 bar closed-loop controls (Dec 2018)
OL_early = [-1.19697039600000,-0.0839504970000000,-2.02850190200000,-2.44965699800000,-3.72862032200000,-3.75830428600000,-4.81538707100000,-3.78589146100000,-3.69536955100000,-2.63436808100000,-2.57047517100000,-2.20071861200000,-1.41571542700000,-0.528675011000000,-1.77284707800000,-2.01345698200000,-1.57216911000000,-1.89991521900000,-1.62878487700000,-2.00968309100000,-3.15066472700000,-2.27358231700000,-3.40549730900000,-3.09327285700000,-2.79374810000000,-2.77899003600000,-2.61551324300000,-3.71040999000000,-2.46281784600000,-0.897384694000000,-0.314222233000000,0.0896549300000000,-0.122638305000000,-0.205550814000000,0.330408902000000;-1.64659878700000,-1.50207641100000,-1.01812324600000,-2.05653617500000,-1.74890733000000,-2.07390713200000,0.165813792000000,-0.368580667000000,-0.478503952000000,0.750382740000000,-0.272583123000000,1.81317173100000,0.648508473000000,0.763373480000000,0.0538313430000000,0.209661912000000,-0.625084960000000,1.29625947100000,-2.53216240000000,-0.774190466000000,-0.0311691530000000,-0.967835772000000,0.317071461000000,-0.133707534000000,-1.80120641100000,-2.95872832400000,-2.98922548100000,-3.56451738500000,-1.34184399800000,-4.50385624000000,-3.44890910100000,-3.03102128600000,-1.27817524200000,-2.44290877400000,0.277854670000000;-2.24195689500000,-2.68775200000000,-2.99882782800000,-4.55719775900000,-3.19966090500000,-2.70594948600000,-3.47823002500000,-1.73284343600000,-0.925405734000000,-3.72759598200000,-1.90063810000000,-3.18620752000000,-2.59295409900000,-2.43409598200000,-2.90800619600000,-2.63724179800000,-2.12165322900000,-1.97453233700000,-2.28145601400000,-3.45030399100000,-3.49168563800000,-0.372402126000000,-2.20030216400000,1.61061698300000,-0.776710342000000,-2.23748057100000,-1.03249325800000,-3.78285176500000,-2.22940962800000,-3.07322753800000,-3.01329077100000,-1.37539230000000,-0.810239553000000,-2.05097859000000,-3.43340029000000;-0.957848680000000,-1.59812723800000,-2.84902085700000,-1.71056195400000,-2.45783388200000,-0.547508372000000,-2.97146249600000,-2.61708559700000,-1.06040970100000,-1.53947766500000,-2.53459438100000,-1.05233446100000,-2.76258730800000,-2.81146549700000,-2.63580242700000,-3.03534953800000,-3.45846393600000,-1.87790248100000,-2.75956757300000,-1.71779856800000,-2.81839516400000,-0.857251462000000,-1.67024357800000,-2.09438620700000,-2.33962860500000,-1.58111629000000,0.0327685470000000,-1.87079140600000,-2.42187839500000,-1.26475650900000,-1.46983030800000,-1.84716201200000,-1.68490173200000,-2.34263032600000,-1.56022698600000;-2.49947127300000,-1.44858955300000,-2.35029262500000,-3.75101575800000,-3.99567050500000,-4.39979716400000,-2.96350664200000,-2.85947721300000,-1.90371359200000,-3.66712487300000,-2.75698278500000,-1.33715033000000,-0.392759315000000,-0.139431324000000,0.0889353700000000,1.90983855300000,1.01057015900000,-0.284563404000000,0.612346539000000,0.307217604000000,-0.294778675000000,-1.07134265400000,0.317208709000000,0.301602599000000,-0.643899104000000,0.181412539000000,-0.696353095000000,-0.898248267000000,-1.08901412600000,-1.83382215100000,-1.05149905600000,-0.0656886210000000,-2.13558551000000,-2.18945467700000,-0.785892151000000;-3.40980988700000,-3.99606598300000,-4.78704638600000,-6.35109188900000,-5.19122230800000,-5.20923189300000,-7.46558749200000,-3.22987216800000,-5.95531228200000,-4.43790100100000,-3.32896680700000,-4.31892783100000,-2.27580528800000,-1.40152643800000,0.923676696000000,0.538922612000000,-1.01843433800000,-0.0939636740000000,0.319964978000000,0.593975586000000,-0.0872750600000000,-0.0398377550000000,1.54938699200000,-0.681316712000000,-1.79229310100000,1.60194426500000,1.93520873100000,-0.508653860000000,1.20801583200000,1.14153014100000,3.94586615500000,1.55385262200000,1.83255653200000,0.188619907000000,0.0422550390000000;-0.574203226000000,-0.970622299000000,-0.573371262000000,-0.431518866000000,-1.15650088400000,-0.983458964000000,0.668906058000000,0.748208576000000,-0.538694832000000,-0.869157561000000,-0.471010267000000,-0.0669424490000000,-0.254087416000000,0.198527146000000,0.170319442000000,-0.567691564000000,0.124061037000000,-1.59692549100000,-1.74025416000000,-0.734982365000000,-1.23366484500000,-1.33510840900000,-1.70477547300000,-2.47808878000000,-0.969580108000000,-2.18106401200000,-1.63626454900000,-1.20716795800000,-1.77795328700000,-3.36427785400000,-1.64365365600000,-1.76110990300000,-0.860036948000000,-1.81946778600000,-1.81630287200000;-0.853295681000000,-5.35998619500000,-1.12556161100000,-1.82757180500000,-3.21581378700000,-4.00536014400000,-3.17616310000000,-1.00986530200000,-0.0997782430000000,-0.472863022000000,1.26305565100000,2.35266022400000,-0.643368325000000,-0.122424727000000,0.0541765500000000,-0.152634876000000,-0.431656973000000,1.41613362200000,-2.58455383500000,-0.394725091000000,-2.24808498700000,-3.48660063500000,-2.69609416900000,-2.87424329500000,-3.97133873600000,-0.226520598000000,-1.86949422700000,-1.36914469700000,-3.66455943000000,-0.681903321000000,-0.914112616000000,-0.999801473000000,-1.94186472900000,-2.74335324300000,-2.32918034600000;-0.337731679000000,-0.948079607000000,-1.56199583400000,-0.273289716000000,-1.02722191700000,-0.803372217000000,-0.275678695000000,-0.798109494000000,0.0342544810000000,-0.650526995000000,-1.73183258000000,-1.67885693100000,0.388957384000000,2.08620193700000,-4.04432032800000,-1.73283730800000,-2.31345816500000,-2.46782396000000,-3.81836329100000,-2.77262240500000,-1.54540681100000,-1.60634224200000,-2.50798040600000,-2.93254667200000,-1.79445927200000,-0.319418199000000,-3.14666467500000,-2.06247909800000,-3.48503250000000,-1.81747525500000,-3.00842018500000,-2.41507660000000,-2.24894776600000,-1.68664734300000,-0.0906691900000000;-1.96575124800000,-1.05761904400000,-2.36127388500000,-0.134540841000000,-2.31661480300000,-2.62615235800000,-2.62604655000000,-2.44528947600000,-1.75279575700000,-2.56366451000000,-1.60792157600000,-2.15029994200000,-1.28798131600000,-2.94009832700000,-2.16145807800000,-2.48191968800000,-4.11367456900000,-2.40738881800000,-2.37116012000000,-3.45328249300000,-2.85976451800000,-2.41873405700000,-1.63899469600000,-1.59833072900000,-0.264361582000000,-1.90625884200000,-0.321913812000000,-1.02070343600000,-0.847586975000000,-1.51775185200000,-0.682053006000000,0.174567948000000,0.241730449000000,-0.853748911000000,-0.683338099000000;1.40829050200000,-0.0169311950000000,-0.651367787000000,-0.773898971000000,-0.931495081000000,0.562982077000000,-0.483790969000000,2.03921414200000,1.22335611900000,1.50078652900000,1.83149535000000,-0.0313536660000000,-0.0705166400000000,-1.55793976200000,-1.58462431100000,-1.40365182200000,-1.74116676600000,-1.53455480900000,-1.05545910100000,-1.51140712500000,-1.36960830700000,0.139041921000000,-1.09192965200000,-1.47887672000000,-2.01333239800000,-2.61747144800000,-2.07050460600000,-2.19714090400000,-1.60544638300000,-2.13558668200000,-2.71755445800000,-1.51941354700000,-1.29214558900000,-1.44248097000000,-1.22421733600000;-1.35840226100000,-1.00162853200000,-1.36423205900000,-1.61495267500000,-1.19782237800000,-1.83564805000000,-1.46190020800000,-2.21128929500000,-1.08833139100000,-1.00671633300000,-0.930263765000000,-0.460352505000000,-0.181657973000000,-0.770994944000000,-0.729843111000000,-1.01005367800000,-1.36859852400000,-0.996337253000000,-0.595573869000000,-0.804908932000000,-0.664567640000000,-0.504033431000000,-0.696788993000000,-0.679562666000000,-1.12631368500000,-0.920376640000000,-0.832633240000000,-0.782162100000000,-0.594198898000000,-1.21657577700000,-0.586711123000000,0.101421528000000,0.526537357000000,-0.283105521000000,0.0497257060000000];
OL_late = [-1.23129416400000,-1.74469831100000,-3.45349849800000,-1.84151226100000,-4.10874273600000,-4.56465460800000,-3.61937649800000,-3.63382937600000,-3.62813519600000,-3.88726856700000,-3.37428838100000,-2.88979076700000,-3.18865172700000,-2.17101597900000,-1.87024158500000,-1.68483959200000,-2.41527241300000,-0.362961083000000,-1.81101400200000,-2.40680746200000,-1.77934411700000,-1.49952149200000,-2.55117725800000,-2.08748605800000,-3.62602731100000,-2.77418289600000,-2.07592954200000,-2.77478693500000,-2.35422060500000,-0.219285490000000,-1.01500870800000,0.207222640000000,-1.28348891700000,-0.319042604000000,0.316144395000000;-1.01559467600000,0.806243205000000,-1.09375365400000,-0.380284186000000,0.174813878000000,-2.04917981100000,0.839439055000000,-0.825371194000000,1.25119473300000,0.688889798000000,-0.333110564000000,0.929992477000000,-0.0627801660000000,1.64319812700000,-2.15075068600000,-1.35994707600000,-1.37066145400000,-0.0167074670000000,-1.09737371800000,0.482089934000000,0.464466612000000,-1.27851116900000,-1.38721360000000,-1.07428899600000,0.149942030000000,-1.92182261500000,-1.65229717100000,-4.07512482900000,-3.03294983800000,-2.50307887600000,-1.54007375000000,-2.24154733000000,-3.29404259500000,-1.35939393500000,-1.02914954800000;-2.83389450900000,-4.98426756700000,-3.59643642000000,-1.20358284400000,-6.18619516500000,-4.37211739100000,-2.39539409000000,-1.47979319900000,-2.88801033500000,-2.44452450300000,-2.49839725600000,-0.176569648000000,-2.42793444600000,0.517422881000000,-3.53174839800000,0.209627909000000,-4.00523548700000,-2.33602417100000,0.245082414000000,0.796298097000000,-3.48054135900000,-1.51263783000000,-3.28762652800000,-2.02192134800000,-2.37096366000000,-1.55173741400000,-2.47660252200000,-3.88098996500000,-4.23873466000000,-3.78656624500000,-3.76258036100000,-2.33007717500000,-5.31590024900000,-2.62179309600000,-2.15444275800000;-2.47887633400000,-4.56184614600000,-3.01314045600000,-2.94037772600000,-2.60752379900000,-2.21016346900000,-0.751286203000000,-3.68138419100000,-1.03584165000000,-2.45703169600000,-1.95487312300000,-2.31069457500000,-3.79782963900000,-3.90276475200000,-2.69212734300000,-3.81527183900000,-2.78025015400000,-2.62299494100000,-2.98940232300000,-1.48694950900000,-2.82790893200000,-2.49411127100000,-2.24408275600000,-1.07933925600000,-1.55458651500000,-0.607348859000000,-0.762556755000000,-1.93815310500000,-1.76905993100000,-2.92968865300000,-0.279790769000000,-1.16296649100000,-1.46854885100000,-2.80214931500000,-1.43387460000000;-3.55413954700000,-2.98167375800000,-2.82960926000000,-4.27862990200000,-5.21401040700000,-3.07510467700000,-3.94409574100000,-2.47544476000000,-3.89693135700000,-2.61270038500000,-1.50401825800000,-2.37797444300000,-0.350920628000000,-0.670134208000000,1.73639625800000,1.13776653900000,1.76128082300000,1.36336661500000,1.87078047200000,-0.820248762000000,-0.265032330000000,-0.129279606000000,0.339445556000000,-0.361893105000000,-0.652451018000000,0.125720326000000,-0.662649259000000,-1.55939369300000,-0.222996999000000,-1.49167346400000,-0.505343108000000,-0.0620418250000000,0.672412684000000,-0.0934373100000000,0.530255035000000;-5.04329973500000,-5.98506346500000,-5.93103997200000,-8.54671503200000,-6.81652706500000,-8.47776405000000,-5.84540509200000,-4.32971753200000,-10.8005515600000,-4.10363905800000,-3.72915194400000,-6.48242333100000,-4.97223662500000,-1.70447253500000,3.82710776900000,2.87312982600000,0.860275845000000,1.25173666300000,2.29543141800000,0.912489412000000,1.83858756500000,-0.407396349000000,1.31479815400000,0.909415819000000,1.54732803100000,0.0937475090000000,2.13165625000000,0.543076340000000,3.36140303600000,2.77004818900000,1.83626788000000,3.14909662800000,0.393148914000000,-0.199461828000000,-1.51357385400000;-0.000176391000000000,-1.26751765900000,-1.35991953500000,-0.549029079000000,-1.03821768500000,-0.462738701000000,-1.17744671500000,0.232206653000000,-1.72464560600000,-1.68170276400000,-1.65495930800000,-1.10246155300000,-1.06010271600000,-1.30775804400000,-1.65543124500000,-0.763714288000000,-0.934594509000000,0.133097045000000,-0.782915715000000,-0.917798974000000,-1.13657678500000,-0.866805975000000,-1.92741426200000,-1.13349079700000,-1.88716558100000,-1.65149366100000,-1.10770606600000,-1.18771154700000,-0.412798419000000,-3.10066477900000,-1.89950391500000,-2.95946510100000,-1.36936321200000,-2.45844700700000,-1.72866710800000;-1.40466245900000,-4.14018639000000,-3.27173355300000,-2.21206893300000,-2.55727095100000,-3.69362790100000,-1.87170973900000,-0.916945773000000,-0.483478093000000,1.15592002800000,-0.460546679000000,-0.0935203550000000,0.301864859000000,2.14560160400000,0.266112917000000,1.75229804100000,-0.0937180540000000,-0.421247416000000,-2.21411133800000,-0.998335012000000,-1.52644784500000,-2.22040242300000,-2.37120129800000,-0.868328754000000,-2.05533489100000,-1.85799160300000,-1.53822010800000,-0.750438129000000,-1.00088498100000,-0.522788848000000,-0.699454555000000,-2.04189475100000,-0.939709990000000,-1.89133750300000,-1.99299460800000;0.285941454000000,0.416459627000000,0.928239168000000,0.665893482000000,1.10564735800000,0.922952595000000,1.50842721300000,-0.463901236000000,-0.108426981000000,-0.827132743000000,0.308535840000000,1.20308116000000,-1.16234358500000,-1.14653885000000,-2.23885153000000,-0.871017869000000,-1.95482865400000,-2.33930432200000,-4.52666105300000,-1.58827111200000,-1.88980684100000,-1.51601485800000,-0.727240372000000,-0.387488855000000,-0.816207231000000,-0.892447923000000,-0.613635788000000,-1.62165815400000,-0.708674835000000,-1.64776601200000,2.15908252400000,-1.37353092100000,1.15191550400000,-0.200529975000000,0.417675620000000;-1.28930654900000,-0.257451248000000,-0.676666641000000,-1.56694554600000,-1.73996276600000,-2.93669956900000,-3.09414313700000,-2.99818054600000,-2.69210982200000,-2.07474496600000,-3.46793030500000,-3.32416784200000,-2.40997026300000,-2.00641027900000,-2.82557298300000,-2.18768339700000,-3.09780904900000,-1.00430867300000,-3.40660307500000,-2.33169004500000,-0.415737611000000,-1.12330495400000,-0.575024237000000,-1.30226424200000,-1.42296039900000,-0.281159191000000,0.296068162000000,-0.479363417000000,0.210160573000000,-0.172094650000000,1.01812288300000,-0.272324070000000,-0.467923275000000,-0.908873366000000,-1.28555340300000;1.38848244400000,1.03623838400000,0.699891098000000,0.329003999000000,1.13443128200000,0.709428483000000,2.88761361800000,2.84557667800000,2.95548432500000,0.547942914000000,1.18259795000000,0.438399473000000,-0.920888795000000,-1.61181974300000,-2.56333791900000,-1.25334951300000,-0.599539416000000,-1.33814822000000,-1.64436824300000,-2.74775735800000,-1.21416734100000,-1.58152347500000,-1.38946368100000,-2.07560670900000,-0.713405915000000,-1.55639913100000,-2.00392900500000,-3.57180443400000,-2.42101405800000,-1.33671554800000,-1.39117473400000,-1.86032315300000,-1.40179105200000,-1.84824806700000,-1.17945071200000;0.359379820000000,-0.0410687740000000,-0.217336925000000,-0.515335416000000,0.149137572000000,0.0606596590000000,0.952518474000000,0.651614975000000,0.969515855000000,1.18575324600000,-0.317459328000000,-0.0435031830000000,-1.26597683000000,-2.67293455000000,-1.61968208200000,-2.44166558500000,-1.96919484600000,-1.94480737200000,-1.93868642600000,-1.38562897000000,-2.59400924200000,-2.03313131600000,-1.88690756000000,-2.57976064500000,-2.75749378200000,-1.57623029500000,-2.86299914100000,-1.82282218000000,-2.49740528000000,-1.86483649500000,-0.355465290000000,-0.117035170000000,-0.630663516000000,-0.0865974020000000,-0.614058822000000];
flyNum = [102;107;110;114;132;233;257;267;271;272;278;279];

% "Matched" controls (March 2019)
%  OL_early = [1.74617518100000,0.968040388000000,-0.0629430110000000,1.70338668100000,1.15616893700000,0.834247015000000,2.08677988200000,0.380930633000000,2.63554862300000,2.03547868400000,2.80208351800000,2.00431051900000,2.22600696700000,1.12103966400000,0.0380988810000000,-0.209248041000000,-0.873347958000000,-1.33326074500000,-2.47111096400000,-1.47324266800000,-1.77682782800000,-2.43824307500000,-1.70473660100000,-2.26756001900000,-1.62475601700000,-1.39355159700000,-2.98067509000000,-2.10102090300000,-3.34157390900000,-0.834114478000000,-3.04468711900000,-3.53378694700000,-2.98489947900000,-1.70058924400000,-1.12700711600000;-2.25088332500000,-1.82185907300000,-2.68680938600000,-3.03080874300000,-3.33244246200000,-4.05378340400000,-3.47579085600000,-3.04679745300000,-3.71356717700000,-2.85025238600000,-2.88218710800000,-3.77304512900000,-3.16221873900000,-2.15517083700000,-1.89206062700000,-0.235481413000000,0.976164433000000,1.83935698300000,2.41977979100000,0.783194275000000,1.00642441900000,1.85065530000000,1.56348729500000,1.75565892800000,1.15326340100000,1.60520316900000,2.19974442700000,1.26756046100000,2.24240056400000,1.06156842300000,2.31566842800000,1.70804390500000,0.736898378000000,-0.0955453030000000,-0.119195811000000;-2.93354341600000,-2.12809018200000,-2.51745338600000,-2.65500435400000,-2.21756248900000,-2.76273160500000,-0.992036068000000,-1.18423496600000,0.188527828000000,1.07918743400000,-1.36609147200000,-0.478014236000000,0.235253388000000,0.726548015000000,0.298707660000000,1.31103745300000,1.48747583800000,1.37299756300000,1.22301885800000,0.686347451000000,-0.467263793000000,0.659211636000000,0.891427942000000,1.04029258100000,0.532310017000000,-0.601262532000000,1.18385002600000,1.22078646000000,0.171803506000000,-0.373593028000000,1.32596245600000,0.700903115000000,0.149863397000000,0.769282423000000,1.31374531500000;-2.22120982400000,-2.00017544200000,-1.77730777800000,-1.58051858500000,-1.70363831900000,-1.05799502900000,0.0614640570000000,-1.47749826200000,-0.818591918000000,-0.858612527000000,-0.964482105000000,-0.907055050000000,-1.89830241000000,-1.95387153100000,-1.20705480000000,-0.575995673000000,-0.611998688000000,0.0705754050000000,-0.129831115000000,0.555966561000000,-1.79517963700000,-0.697561653000000,-0.417639221000000,-0.403511806000000,-1.15321328600000,-0.176197137000000,-2.89620698700000,-1.48319805100000,-1.90819827900000,-0.755414758000000,-1.17920024900000,-1.48096050500000,-0.911053859000000,-1.21802147800000,-0.0118939630000000;-1.14411201800000,-1.61332865300000,-0.817396520000000,-0.559742932000000,-1.45787020400000,-1.24278423400000,-0.0418379000000000,-0.853710733000000,0.0178298140000000,-0.445620610000000,-0.417990833000000,0.881714358000000,0.322936715000000,-0.791564092000000,-0.717172949000000,-1.16551560200000,-0.374087741000000,-0.526589761000000,-1.66969532500000,-1.70431799500000,-1.51645736000000,-1.40757606400000,-1.28759089700000,-1.23209099100000,-1.96671517500000,-1.81370361900000,-2.84654617800000,-2.36435276800000,-2.33356964300000,-1.98626764900000,-3.22085451000000,-2.48681657600000,-2.59542934400000,-2.11994300000000,-1.39508220700000];
%  OL_late = [2.30302953300000,1.27641456800000,1.81874412800000,0.226656898000000,-0.416150466000000,0.645552416000000,0.161282630000000,0.354680288000000,1.22580923100000,1.02805407000000,1.93369535000000,2.32214945500000,2.76887509700000,1.49214238800000,0.118758336000000,-0.433759645000000,-0.315602911000000,-1.21053773300000,-2.78363451400000,-1.69578035400000,-1.92701790100000,-2.49590591900000,-2.61044174000000,-2.78821436500000,-0.645603303000000,-2.15781923700000,-2.44559062500000,-2.16284632900000,-2.23110451800000,-2.08790572600000,-2.43293399100000,-2.84458130200000,-1.84720282600000,-1.39069410200000,-0.514534021000000;-3.40342154200000,-2.83001711400000,-4.02957005500000,-5.29404406700000,-4.19501139900000,-4.76152280500000,-5.39205114500000,-5.30792135700000,-5.71447661000000,-4.29055423400000,-4.69331236500000,-4.94366032900000,-3.35854622000000,-2.61839930400000,-2.07981808200000,1.01241770200000,0.170872558000000,3.21787680100000,2.51398499500000,2.12736062800000,1.88148353300000,3.22760048400000,2.58174642000000,1.44312734800000,0.817439500000000,2.80702872300000,2.66373781200000,2.50290980400000,1.70357004400000,1.05076125600000,3.75195264100000,2.60936597000000,1.99353100800000,-0.204640948000000,-0.0868428630000000;-1.90974492800000,-1.19398913700000,-1.14081155900000,-2.29133679800000,-3.18940985500000,-1.44275303900000,-2.54921899600000,-3.27924127000000,-1.45751369100000,0.0278147810000000,-0.344115604000000,-1.18574486000000,-1.73164901100000,-0.794367115000000,0.000584844000000000,-0.781392010000000,-0.595964928000000,0.784838879000000,1.76142255600000,1.63546814500000,1.11399099000000,-1.00624104200000,-0.666466123000000,-0.428722740000000,-0.337846524000000,0.809026696000000,0.187285737000000,-0.725523595000000,0.398045079000000,0.295064463000000,1.12374390100000,1.14717527300000,0.263522088000000,0.651584501000000,0.595756097000000;-1.27877831000000,-1.05712859900000,-0.758551075000000,-0.510410620000000,-0.844127824000000,0.262674954000000,-1.21945485700000,0.265585110000000,-0.458286042000000,-0.927545276000000,-0.560185571000000,-0.325249890000000,-0.744777814000000,-0.828202118000000,-0.368388128000000,-1.09022407500000,-0.497119661000000,-1.41976083500000,-0.541535724000000,-0.829857669000000,-1.52170023900000,-1.22827576400000,-1.09632901300000,-1.63061752100000,-1.55485038900000,-3.37942054700000,-2.22357685700000,-3.16663932100000,-1.88368042200000,-1.22768656800000,-1.53395476900000,-0.961673266000000,-0.807567882000000,-1.02183846100000,-1.34410120100000;-0.240112073000000,-1.83129798200000,-1.05424850700000,-1.63389901300000,-1.32900776800000,-1.22634000800000,-0.214007749000000,-1.77811880600000,-0.880287641000000,-0.371909711000000,0.175616406000000,-0.261263881000000,-0.528097921000000,-0.612395256000000,-1.25556183500000,-0.566955842000000,-0.940079041000000,-1.68083980400000,-3.31359850000000,-2.56032557800000,-1.83202016100000,-2.36412695900000,-2.17559910400000,-0.844281797000000,-2.29357038300000,-2.03721960400000,-3.53256863700000,-1.74458809100000,-2.80553019100000,-1.18675080800000,-3.60618223400000,-1.90375506700000,-1.54539706400000,-2.06731686800000,-1.62824269400000];
%  flyNum = [364;373;380;381;385];

DEGREE_PER_LED_SLOT = 360 / 96;  
POSSIBLE_BAR_LOCATIONS = 2:2:71;
MIDLINE_POSITION = 34;
barPositionDegreesFromMidline = ( POSSIBLE_BAR_LOCATIONS - MIDLINE_POSITION ) * DEGREE_PER_LED_SLOT;
%%
for i = 1: length ( OL_early(:,1) )
    % Smooth the data with median filter if user wants to:
    ORDER_MEDFILTER =2; % order for median filter smooth
    
    currOL_early = medfilt1( OL_early(i,:), ORDER_MEDFILTER, 'truncate'); % Median filtering of the trace
    currOL_later = medfilt1( OL_late(i,:), ORDER_MEDFILTER, 'truncate'); % Median filtering of the trace
     % find change for smoothed curves after - before for each tuning curve
    smoothedDifference_OL = currOL_later - currOL_early;
    
    netVisualTuningChangeByBarLoc(i) = (sum ( abs( smoothedDifference_OL ) ) ) / length( barPositionDegreesFromMidline );
    
     [R, P] = corrcoef( currOL_early,  currOL_later );
     RvalueBetweenOL(i) = R( 1, 2);
     shapeChange_OL(i) = 1 - (RvalueBetweenOL(i))^2;
    
    % Plot the tuning curves for current fly together on the same figure, with axes rescaled 
    figure('Position',[50, 50, 1000, 800]); set(gcf, 'Color', 'w');
    
    % OL early 1 bar
    subplot( 3, 1, 1)
    plot( barPositionDegreesFromMidline, currOL_early );
    maxMinusMin_OLearly = max(currOL_early) - min(currOL_early);
    title([' open loop (early), max-min:' num2str(maxMinusMin_OLearly) ' (mV)' ] );
    niceaxes; box off
    xlim([ -120 135])
    
    % OL later 1 bar
    subplot(3, 1, 2)
    plot( barPositionDegreesFromMidline, currOL_later );
    title(' open loop (late)' );
    niceaxes; box off
    xlim([ -120 135])
    
    % plot OL change  after - before plots below
    subplot(3, 1, 3)
    % add grey dotted line at 0
    plot( barPositionDegreesFromMidline, zeros( 1, length(barPositionDegreesFromMidline) ),'--', 'Color', [ 0.7 , 0.7, 0.7] ); hold on;
    plot( barPositionDegreesFromMidline, smoothedDifference_OL ,'Color', [ 0 , 0, 0] );
    text(barPositionDegreesFromMidline(1),max( smoothedDifference_OL ) ,['change:' newline ' after- before (OL)'], 'Color', [ 0 , 0, 0])
    niceaxes; box off
    xlim([ -120 135])
    
    suptitle( ['flyNum: ' num2str( flyNum(i) ) ]);
    
end

%% Plot strip chart of visual tuning changes for control and remapping data set with matched controls split out or 
figure;set(gcf, 'Color', 'w');

%load in data to variables:
% remapping data set
remapping_netVisualTuningChangeByBarLoc = [3.27106975364286,0.907522873485714,0.977828782428571,2.22963409211429,2.38227245302857,0.636935169457143,0.565764586100000,0.753627100214286,1.01802446174286,1.30700944511429,2.17460491731429,0.548823587071429,1.24069132787143,1.36125424102857,0.251763581771429,0.815338094742857,0.881040206685714,0.923097732157143,0.848173349142857,1.03838533038571,1.31495036847143,0.769875938157143];
flyNum_remap = [218;224;232;241;271;272;277;278;281;293;304;305;310;311;312;337;338;355;358;359;360;363];

% 1 bar closed loop controls (Dec 2018)
flyNum_control = [102;107;110;114;132;233;257;267;271;272;278;279];
Control_netVisualTuningChangeByBarLoc = [0.561065876500000,0.826438377871429,1.21640366720000,0.599925431085714,0.622200075114286,1.32962092650000,0.612500362585714,0.755901280685714,1.26479889330000,0.696831416671429,0.711479935057143,1.24854381161429];

% Matched 1 bar closed loop controls (March 2019)
flyNum_newControl =  [364;373;380;381;385];
newControl_netVisualTuningChangeByBarLoc = [0.507375552471429,0.919490123728571,0.832385683771429,0.662044512371429,0.442595168885714];

% plot all sloped in the data set:
scatter( ones(length(remapping_netVisualTuningChangeByBarLoc),1), remapping_netVisualTuningChangeByBarLoc  ); hold on;
dx = 0.1;
textLabels = cellstr( num2str(flyNum_remap));
text(  ones(1, length(flyNum_remap))+dx , remapping_netVisualTuningChangeByBarLoc ,     textLabels); hold on;
ylim([0 3.5]);

% add mean and 2SD lines onto plot
bar( 2, mean(Control_netVisualTuningChangeByBarLoc) ); hold on;
errorbar( 2, mean(Control_netVisualTuningChangeByBarLoc) , 2*std( Control_netVisualTuningChangeByBarLoc) ); hold on;

% plot all sloped in the data set:
scatter( 2*ones(length(Control_netVisualTuningChangeByBarLoc),1), Control_netVisualTuningChangeByBarLoc  ); hold on;
dx = 0.1;
textLabels = cellstr( num2str(flyNum_control));
text(  2*ones(1, length(flyNum_control))+dx , Control_netVisualTuningChangeByBarLoc ,     textLabels); hold on;

% add mean and 2SD lines onto plot
bar( 3, mean(newControl_netVisualTuningChangeByBarLoc) ); hold on;
errorbar( 3, mean(newControl_netVisualTuningChangeByBarLoc) , 2*std( newControl_netVisualTuningChangeByBarLoc) ); hold on;

% plot all sloped in the data set:
scatter( 3*ones(length(newControl_netVisualTuningChangeByBarLoc),1), newControl_netVisualTuningChangeByBarLoc  ); hold on;
dx = 0.1;
textLabels = cellstr( num2str(flyNum_newControl));
text(  3*ones(1, length(flyNum_newControl))+dx , newControl_netVisualTuningChangeByBarLoc ,     textLabels); hold on;

% add together both controls:
flyNumAllControls = [flyNum_control ; flyNum_newControl];
allControls_netVisualTuningChangeByBarLoc = [ Control_netVisualTuningChangeByBarLoc , newControl_netVisualTuningChangeByBarLoc];
% add mean and 2SD lines onto plot
bar( 4, mean(allControls_netVisualTuningChangeByBarLoc) ); hold on;
errorbar( 4, mean(allControls_netVisualTuningChangeByBarLoc) , 2*std( allControls_netVisualTuningChangeByBarLoc) ); hold on;

% plot all sloped in the data set:
scatter( 4*ones(length(allControls_netVisualTuningChangeByBarLoc),1), allControls_netVisualTuningChangeByBarLoc  ); hold on;
dx = 0.1;
textLabels = cellstr( num2str(flyNumAllControls));
text(  4*ones(1, length(flyNumAllControls))+ dx , allControls_netVisualTuningChangeByBarLoc ,     textLabels); hold on;

ylim([0 3.5]);
ylabel( 'absolute change (mean(abs(\Delta) (smoothed) (mV)');
niceaxes;

