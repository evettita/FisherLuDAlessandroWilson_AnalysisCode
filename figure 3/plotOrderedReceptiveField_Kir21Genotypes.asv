%% plotOrderedReceptiveField_Kir21Genotype
% Plot heat maps of the visual tunign curves of different
% flies from different genotypes.  Specifically to analyze 
% R20A02 Kir2.1 and R54E12 Kir2.1 data sets
%
% Yvette Fisher 2/2019, written during manuscript revision
%% 
clear all
DEGREE_PER_LED_SLOT = 360 / 96; 
MIDLINE_POSITION = 34;%
POSSIBLE_BAR_LOCATIONS = 2:2:70;
barPositionDegreesFromMidline = ( POSSIBLE_BAR_LOCATIONS - MIDLINE_POSITION ) * DEGREE_PER_LED_SLOT;
genotype = {'expt', 'ctr-gal4','ctr-uas'};

% Load data visual tuning curve data into variables
% data from R54E12 kir2.1 experiments
expt_rfAcrossCells =[-0.331608006000000,-0.0882362070000000,-0.274720614000000,-0.0383243600000000,0.0558898140000000,0.127221864000000,-0.125026659000000,-0.566728614000000,-0.0626674790000000,-0.170729316000000,0.216422517000000,0.112907198000000,0.0457687300000000,0.372434386000000,0.288906520000000,0.355689468000000,-0.396515498000000,0.349361753000000,0.936609185000000,0.501130640000000,0.776015779000000,0.835185262000000,0.750640968000000,0.858064678000000,1.07755595500000,0.792641880000000,0.717317598000000,-0.0783608140000000,0.0725849760000000,-0.695977929000000,0.144030136000000,0.0907848720000000,0.0395678680000000,-0.400546152000000,-0.115495649000000;-0.245916973000000,-0.334928501000000,-0.278623096000000,0.0317238400000000,0.181304645000000,0.0581116050000000,0.331789648000000,0.400568548000000,0.483486707000000,0.781382895000000,0.938496530000000,1.26430151500000,1.05018275800000,0.772886205000000,0.851046842000000,0.923219925000000,0.910644087000000,0.801516743000000,0.712377132000000,0.467698199000000,0.659867368000000,0.367858476000000,-0.242958938000000,-0.236135193000000,0.154854257000000,-0.227265852000000,-0.254552552000000,-0.124551810000000,-0.113774463000000,-0.0353923720000000,-0.0207096680000000,-0.103547964000000,-0.216898827000000,-0.173159827000000,-0.153566961000000;0.213924536000000,0.228277911000000,0.263924790000000,0.227537958000000,0.295507618000000,0.264394565000000,0.122461575000000,0.00587719600000000,0.113182133000000,0.319818591000000,0.183976131000000,0.430019872000000,0.414696882000000,0.348096134000000,0.181310046000000,0.237318131000000,0.130406273000000,0.145352772000000,0.0578729810000000,-0.203839203000000,-0.282882645000000,-0.361378295000000,-0.0105226790000000,-0.370668984000000,0.109689787000000,-0.0593690390000000,0.0921069840000000,0.0352476400000000,-0.0331164360000000,-0.0293949710000000,-0.185730096000000,0.00538706100000000,-0.132975263000000,-0.0906393860000000,0.0477157570000000;-2.16648089900000,-1.32108258500000,-2.31607537900000,-3.07577755000000,-2.99431106900000,-3.91127451700000,-3.43397771100000,-2.65006535600000,-2.56985728900000,-1.98870318900000,-3.16804808500000,-1.53135959000000,-1.75059890600000,-1.60252177900000,-1.16152155400000,-1.06915934700000,-0.818754732000000,-1.20980094300000,-1.39376318200000,-1.07021713400000,-1.82324742600000,-1.34882435700000,-1.40945224100000,-1.78278279000000,-2.48030992100000,-2.19232213800000,-1.93879627700000,-2.63370244700000,-1.55806393400000,-1.95949695800000,-1.36731637400000,-1.19169757600000,-1.47835728000000,-2.19338132600000,-1.38861420500000;-1.13088293100000,-0.775913476000000,-0.736377719000000,-0.663445780000000,-0.0998090330000000,-0.138863921000000,-0.615155622000000,-0.706790389000000,-0.465961876000000,-0.789579759000000,-0.639325788000000,-0.985013687000000,-1.19669933400000,-1.42612624500000,-1.56989275500000,-0.895017181000000,-1.38980490800000,-0.843011451000000,-1.20110476900000,-0.511863741000000,-0.370923047000000,-0.720743662000000,-0.498939324000000,-0.391674878000000,-0.0632524860000000,-0.444953302000000,-0.222371385000000,-0.250308223000000,-0.0950158720000000,-0.462451364000000,-0.241983146000000,-0.447248963000000,-0.284089807000000,-0.342821397000000,-0.574701727000000;-1.22445094800000,-1.11559458800000,-1.09102682500000,-0.725837896000000,-0.856789265000000,-0.873698576000000,0.0890094730000000,-0.350298240000000,-0.246731137000000,-0.387740970000000,-0.230361826000000,-0.389732429000000,-0.122178067000000,-0.180659587000000,-0.195971014000000,-0.397936489000000,-0.320522876000000,-0.183634076000000,0.198853163000000,-0.00449289800000000,0.514914423000000,0.695463437000000,0.454556931000000,0.438936985000000,0.552900310000000,0.334628678000000,0.401850562000000,0.0706042720000000,0.0197451730000000,-0.237881690000000,0.0472179270000000,-0.138693821000000,-0.397829703000000,-0.0921347820000000,-0.318432935000000;-0.505606015000000,-0.409837014000000,-1.30797214100000,-0.759534984000000,-0.912687963000000,-0.981353707000000,-1.05500232700000,-1.35601683300000,-1.12900032000000,-1.10940282500000,-1.36130834600000,-1.51304274500000,-1.08172159300000,-0.883115690000000,-0.305203949000000,-0.704006122000000,-0.654067538000000,-0.646885412000000,-0.727788252000000,-0.724004573000000,-0.299306417000000,-0.0728300200000000,0.232769187000000,-0.0413614000000000,0.935523365000000,0.967018125000000,0.426909200000000,0.217953713000000,0.725603845000000,0.0966370680000000,0.199380990000000,0.692441731000000,0.265720406000000,0.00421820000000000,0.433834239000000;0.187826707000000,-0.321905719000000,0.369987503000000,-0.0212788590000000,0.378024896000000,0.297870618000000,0.434789980000000,0.390398169000000,0.0742021890000000,0.343510031000000,-0.230247704000000,0.0211470980000000,0.0352206110000000,0.170925119000000,-0.0683325600000000,-0.480505956000000,-0.0178748000000000,0.333954797000000,0.351322017000000,0.172186382000000,-0.259924214000000,-0.413112741000000,-0.169339161000000,0.0230298600000000,0.155289797000000,-0.174711878000000,-0.0473463770000000,-0.0680005400000000,0.664756071000000,-0.0582104270000000,0.377211381000000,-0.225176353000000,0.0521366510000000,-0.226501093000000,-0.184200727000000;-1.44285102200000,-1.59156612700000,-1.67738491000000,-1.66375602700000,-1.88840388000000,-1.12089687200000,-1.41837905200000,-1.70561128600000,-1.53427286500000,-0.969331173000000,-0.402465645000000,-0.552756402000000,-0.511475145000000,-0.640622480000000,-0.274971278000000,-0.00285898600000000,0.135406794000000,0.597010293000000,0.425691736000000,0.395948491000000,0.193827345000000,0.285408316000000,0.271845603000000,0.328444232000000,-0.219267765000000,-0.182119144000000,-0.466122122000000,-0.370771433000000,-0.155000129000000,-0.0439903430000000,-0.374580399000000,-0.293847783000000,-0.364556873000000,-0.187722568000000,0.0555639070000000];
gal4_rfAcrossCells = [-0.211960814000000,-1.03701434100000,-1.13312990900000,-1.84971018200000,-1.67279281300000,-1.79876386900000,-2.38038046600000,-2.16565739400000,-2.40740969400000,-3.37120045400000,-3.27752155900000,-2.12900496000000,-0.624360666000000,0.381752285000000,0.136263549000000,-0.136041802000000,-0.253857308000000,-0.340235889000000,-0.0522830170000000,-0.154481031000000,-0.102056087000000,-0.708615978000000,-0.179351757000000,-0.485337519000000,-0.802802814000000,-0.710300895000000,-0.750349614000000,-1.02575362000000,-1.00846004400000,-1.84206599200000,-0.812232342000000,-0.855005236000000,-0.736729760000000,-1.07269936900000,-0.115679810000000;-0.470316220000000,-0.955185266000000,-1.04685472300000,0.265058360000000,-1.37633115600000,-1.12750466100000,-1.37972513600000,-3.13458650700000,-2.45244311100000,-2.76690524800000,-2.97697628400000,-2.88657655800000,-3.68739046200000,-2.50024066900000,-3.89772513700000,-4.01540402800000,-3.00755218100000,-3.51908413300000,-3.58818003500000,-1.70532059100000,-3.28730178500000,-3.82629691800000,-2.12846110300000,-4.29198223100000,-3.44111840100000,-3.70565997100000,-4.15087985300000,-3.42975410700000,-3.10653643800000,-3.28212491100000,-2.49791801000000,-1.51609140000000,-1.58296840000000,-1.95795085700000,-1.36827251700000;-0.415272340000000,-0.627666151000000,-0.524321901000000,-0.426871548000000,-0.632141760000000,-0.936923425000000,-0.893494237000000,-1.39893129800000,-1.19053658000000,-1.28743600000000,-0.637694621000000,-1.01411089700000,-0.809584887000000,-0.544035473000000,-0.374210294000000,-0.531721409000000,-0.679404185000000,-0.485054831000000,-0.612559408000000,-0.807546259000000,-0.923399278000000,-1.04785686600000,-1.10275731500000,-1.02024249300000,-1.61922510500000,-0.901292061000000,-0.782213410000000,-1.12177754800000,-0.670847141000000,-1.00722477900000,-0.860554805000000,-0.644397537000000,-0.856480768000000,-0.688888562000000,-0.578344178000000;-0.143189795000000,-0.563715093000000,-0.778444671000000,-1.16367916100000,-1.16071709300000,-1.22835228800000,-1.19177476700000,-0.885043832000000,-0.925928693000000,-0.817809325000000,-0.811160700000000,-0.581695634000000,-0.276127013000000,-0.742714507000000,-0.570131073000000,-0.444273470000000,-0.0429913720000000,-0.242545248000000,-0.0129165650000000,-0.456412670000000,-0.780775527000000,-0.770862323000000,-0.782112399000000,-1.03290091600000,-0.806639916000000,-0.989655841000000,-0.931810918000000,-1.03318888800000,-0.913791665000000,-0.957699398000000,-0.455922588000000,-0.557365337000000,-0.414200401000000,-0.144060588000000,-0.206694669000000;-0.264530094000000,-1.14029399200000,-1.11479830800000,-1.15714905300000,-1.00193651000000,-0.988778067000000,-1.11241521200000,-1.53265523600000,-1.40054997100000,-1.03440599800000,-1.03343189000000,-0.439909352000000,-0.485299647000000,-0.412499964000000,-0.271255995000000,-0.332396780000000,-0.251865456000000,-0.417805106000000,-0.130774028000000,-0.995557351000000,-1.16953376400000,-0.833486044000000,-0.817902203000000,-0.656017924000000,-0.888174838000000,-0.758934181000000,-0.718616392000000,-0.994632453000000,-1.24021148300000,-1.10329673000000,-0.732227460000000,-0.380263283000000,-0.450259039000000,-0.615592306000000,-0.254883004000000;-1.57286664700000,-1.95559372600000,-2.44561265900000,-0.968733662000000,-0.999011912000000,-3.13716750400000,-3.01616678000000,-3.58134787000000,-4.11148642600000,-4.11225711200000,-2.96668415000000,-3.62154748500000,-2.74995850100000,-2.68514852400000,-3.49011349500000,-3.09568036100000,-3.04945180700000,-3.32649918500000,-3.30726645700000,-2.67903417800000,-3.66102775900000,-3.19245406800000,-2.40942062000000,-2.86427260900000,-3.46223715400000,-2.79616160100000,-2.52764188600000,-1.83136402600000,-2.26900316700000,-2.15319032600000,-0.597871172000000,-0.350010556000000,0.0325879520000000,-0.924916025000000,-0.737992552000000;-0.414846725000000,-0.311354008000000,-0.285233796000000,-0.0630759050000000,-0.183916614000000,0.172049385000000,0.0876449700000000,0.301759115000000,0.0569626510000000,0.0944850100000000,-0.142469694000000,0.117298532000000,0.0893594000000000,-0.00469791700000000,-0.0932986800000000,-0.0382702840000000,-0.0402248870000000,-0.0775697250000000,-0.322381736000000,-0.222685158000000,-0.595335006000000,-0.405277735000000,-0.363747438000000,-0.205382862000000,-0.344850412000000,-0.628543654000000,-0.604177766000000,-0.426636847000000,-0.446290869000000,-0.636510938000000,-0.798329862000000,-0.126931300000000,-0.136533136000000,-0.171339232000000,-0.296172317000000;-0.224544145000000,-0.657733178000000,-0.866153328000000,-1.30159826000000,-0.717003675000000,-1.38533727800000,-1.87767459200000,-1.62396979300000,-2.31979549800000,-2.60231089200000,-1.99927906200000,-1.86552039600000,0.375268239000000,-0.000437933000000000,-0.350245964000000,0.845631070000000,0.865925622000000,1.29007471600000,1.56015701500000,2.63399112800000,1.84251590200000,2.82398881000000,2.78413716300000,2.08366938900000,1.77151824500000,1.57332298600000,0.988534092000000,1.07281727300000,1.40673972200000,0.511874573000000,1.12495132900000,-0.0580299940000000,-0.121191964000000,-1.21460112500000,-1.52974399900000;-1.85521962200000,-1.55644031700000,-1.58371946900000,-2.04749374500000,-2.53129360000000,-2.16850322600000,-3.14013560900000,-3.03283160500000,-2.27407948500000,-1.57017666000000,-0.682624490000000,-0.252574591000000,-0.152051115000000,0.431169217000000,-0.0370706050000000,0.158601269000000,-0.367983219000000,-0.120069586000000,-0.632787562000000,-0.407577557000000,-0.109724725000000,-0.357301468000000,-0.950307025000000,-0.225408509000000,-1.26411025300000,-0.867835167000000,-0.477595402000000,-1.20184735300000,-0.819265953000000,-1.07218419100000,-0.719606018000000,-1.00441257800000,-0.916148794000000,-0.846733793000000,-1.13392503800000;-1.58080298500000,-1.16120402500000,-1.79947661700000,-1.94606727500000,-1.78511941900000,-1.82673401700000,-1.70370657100000,-2.01915550100000,-1.81589083000000,-1.40879355000000,-1.45219217200000,-0.314052625000000,-0.322158486000000,-0.338403826000000,-0.656534305000000,-0.429263711000000,-0.285059990000000,-0.140765968000000,-0.666008379000000,-1.42883731200000,0.0320038880000000,0.165906011000000,0.141768929000000,0.0981915520000000,0.0309519420000000,-0.00410340400000000,-0.588613982000000,-1.11840860800000,-0.570041885000000,-1.17695593900000,-1.17360689100000,-1.31175511300000,-0.908600656000000,-0.978888518000000,-1.51545235700000;-0.608152217000000,-0.528388964000000,-0.222728691000000,-0.612129778000000,-0.667080340000000,-0.722768726000000,-0.636613581000000,-0.420356738000000,-0.354840914000000,-1.03300926600000,-0.616221163000000,-0.352454136000000,-0.239010212000000,-0.509757593000000,-0.469472561000000,-1.09295516800000,-1.07900849900000,-1.33997069100000,-1.16091092200000,-1.99449447500000,-1.41735277300000,-1.91692161500000,-2.52461046600000,-1.85430818000000,-2.55047627400000,-2.36689148500000,-1.87265185500000,-2.72080106100000,-2.01972365700000,-2.48002410400000,-2.70960474900000,-1.40475298300000,-2.72733984300000,-2.46393424000000,-1.94378523000000;1.92541125100000,1.87246256900000,2.43054018100000,3.40613436700000,1.95667628000000,2.86540627900000,3.21560573900000,2.21223397200000,3.87838434000000,1.65736548200000,1.75019232900000,2.00568315100000,1.05528773400000,0.0467105530000000,-1.58956634600000,-0.750193092000000,-0.619943727000000,-2.87071483500000,-3.93955446800000,-2.73366290900000,-3.66830004500000,-3.38290765600000,-3.33693547600000,-3.66887495600000,-4.46938307200000,-4.20542460500000,-5.86615942800000,-3.88630288600000,-4.59836789500000,-4.60584854900000,-3.69117074200000,-4.13176363900000,-3.74303167100000,-3.12274473800000,-2.65181739000000];
uas_rfAcrossCells = [-1.53284352300000,-1.84979842100000,-2.12736795400000,-1.71146278400000,-2.29899170200000,-2.54004917200000,-1.75934953900000,-1.92091867600000,-0.869352048000000,-1.42393277800000,-1.39212658200000,-0.940750242000000,-1.32000228900000,-0.692828286000000,-1.08926528500000,-0.682991659000000,-0.251278878000000,-0.590782532000000,-0.933284457000000,-1.02494124400000,-1.78137186600000,-1.39480533600000,-1.27915952800000,-1.65741658600000,-1.56784235900000,-1.24156966200000,-1.65147459900000,-2.44574912600000,-1.30352135100000,-2.15023117100000,-2.42663807200000,-2.07209948700000,-2.08706105200000,-1.82048321500000,-1.54865677600000;-0.0375306660000000,-0.689116524000000,-0.436653216000000,0.448521539000000,-1.10947121200000,-1.23813116000000,-0.00755172300000000,-0.599591437000000,0.874799018000000,-0.234195220000000,-0.0355373690000000,0.622813232000000,0.355272547000000,-0.364590624000000,-0.931042042000000,-0.238262157000000,-0.361269366000000,-1.24722613600000,-1.11984734400000,-1.76236326300000,-2.00975705400000,-2.45744382200000,-1.75742798800000,-2.61762034200000,-2.44448083400000,-2.71924457800000,-3.54594769800000,-3.31880410900000,-3.12439508900000,-3.13003267900000,-2.94375824700000,-3.16010674100000,-2.58100816800000,-2.05817856500000,-2.12359100700000;-0.334090782000000,-0.0803226860000000,-0.973608051000000,-1.32351160900000,-1.06227752200000,-2.04552058900000,-0.976871346000000,-0.739641120000000,-0.478333574000000,-0.673561824000000,-0.461759574000000,-0.353651193000000,-0.289890257000000,-0.616908056000000,-1.05090227400000,-0.783689946000000,-0.622909011000000,-0.936314971000000,-0.783268467000000,-0.206876750000000,-1.03635422100000,-1.43405697800000,-1.65348642700000,-1.34275521500000,-1.39822045400000,-1.87496183200000,-1.96320681500000,-1.87301957000000,-1.63726545400000,-2.28562807400000,-1.61276887200000,-1.36088791500000,-1.16815693700000,-1.22485299500000,-0.712800338000000;-2.37479758500000,-2.29900326900000,-1.28553922300000,-1.31798194400000,-2.36422958500000,-2.82822966600000,-3.44934515200000,-4.45329535600000,-3.92903697500000,-4.43220983500000,-2.77614880900000,-3.67781856300000,-3.08695535100000,-3.10616394700000,-3.87141926700000,-3.16804212900000,-3.31193818000000,-3.15055455900000,-2.91113276900000,-1.83241554000000,-3.36663793600000,-3.42554714800000,-3.51678358900000,-2.39471687600000,-4.09717349700000,-3.24953764200000,-2.61376905400000,-2.25494417000000,-1.75407814900000,-3.26691969800000,-1.37985585500000,-1.50647046300000,-2.90473108400000,-3.01177694000000,-2.76133544200000;0.284816041000000,-0.914722664000000,-0.983575897000000,-0.135029670000000,-1.49204243600000,-0.783879655000000,-0.830942474000000,-1.58259913500000,0.0319578390000000,-0.773273426000000,0.0152056170000000,0.0360277740000000,-0.0361872600000000,-0.128460824000000,-1.22924584300000,-0.630139541000000,-0.408652982000000,-0.851187394000000,-0.561859242000000,-1.41527975500000,-2.36599954600000,-2.31480828600000,-2.74331363000000,-3.09880517400000,-3.43000073400000,-3.11886472000000,-2.47963654700000,-4.24614206900000,-3.11762925400000,-3.50955519000000,-2.36877768500000,-1.98415828800000,-2.24289862000000,-1.68437063300000,-0.683340273000000;-1.85919805300000,-1.56266991200000,-1.19023917100000,-0.628382514000000,-1.45831455000000,-1.57637196200000,-1.82702368600000,-2.30943487800000,-2.03861585500000,-2.60746050300000,-3.10547614600000,-3.13612349900000,-3.99372841000000,-3.07051691700000,-3.69748936300000,-3.64773183600000,-3.50647443800000,-3.29120124900000,-4.14038845300000,-2.90838790600000,-3.88161651600000,-3.94390124800000,-3.17818517500000,-3.52969650500000,-2.97995541900000,-3.47367918900000,-1.86625198900000,-1.73184646400000,-1.95689357100000,-1.73179365100000,-0.895648644000000,-1.82892495800000,-2.29627203400000,-1.36369082700000,-1.21316790800000;-0.522549523000000,-1.22493176800000,-1.32819575200000,-0.824541437000000,-1.03576774000000,-1.34573310900000,-1.17765433800000,-1.73709998200000,-1.19400223900000,-1.68232250800000,-0.642017793000000,-0.841612346000000,-0.772762399000000,-0.721180050000000,-0.919172873000000,-0.665810587000000,-0.960056931000000,-0.712356738000000,-0.939289089000000,-1.14160999700000,-0.924671869000000,-0.877374303000000,-1.00378874500000,-1.45121552100000,-1.82149902900000,-1.37099409300000,-1.51949380200000,-1.94839691800000,-1.44996322900000,-1.91016087600000,-1.41134514700000,-1.06815646300000,-1.08529558100000,-0.702622532000000,-0.684053757000000;-0.744713038000000,-1.12264077700000,-0.953140874000000,-2.47711174200000,-1.90561925200000,-1.91609234100000,-1.91761721200000,-2.55043120700000,-2.37042732800000,-1.92608314600000,-1.48950258500000,-1.64830375000000,-2.02447547600000,-1.98513993200000,-1.33160392700000,-1.15896767000000,-1.61658966500000,-0.754661692000000,-0.957173529000000,-0.867659250000000,-1.23755129900000,-0.928068101000000,-0.775798309000000,-0.733694119000000,-1.24573859000000,-0.723535354000000,-0.240954987000000,-0.881704051000000,-0.748714671000000,-1.54303678400000,0.209387170000000,-0.378032814000000,-0.394310999000000,-1.10155018600000,-1.08994429900000];

% % data from R20A02 kir2.1 experiments
%   expt_rfAcrossCells = [-0.00563518100000000,-0.285430375000000,-0.143028149000000,-0.137312955000000,-0.100916145000000,-0.153528041000000,0.0397886880000000,0.156582089000000,0.294671354000000,0.296369872000000,-0.395279749000000,0.273940132000000,-0.168912788000000,0.599053832000000,0.384009656000000,0.862358624000000,0.737792814000000,0.557775103000000,1.26826011400000,0.755635936000000,1.51275414800000,1.06299385100000,0.510011727000000,1.41130570600000,0.324045057000000,0.373935844000000,-0.494833817000000,-0.189930481000000,-0.664024921000000,-0.790334916000000,-0.391428405000000,-0.313862506000000,-0.0457380050000000,0.213865445000000,0.267321195000000;-0.437114847000000,-0.597400827000000,-0.659012436000000,-0.848803455000000,-0.550079452000000,-0.161034382000000,0.300722471000000,0.138651473000000,0.0968549940000000,-0.112023701000000,-0.297842154000000,-0.490175052000000,-0.604210522000000,-1.44928202000000,-1.34637089900000,-1.00075049100000,-0.549716124000000,-0.947817468000000,-0.292903224000000,-0.471245182000000,-0.434335330000000,-1.16526391400000,-0.801311618000000,-0.656480390000000,-0.0797303300000000,-0.463921108000000,-0.288289290000000,-1.11106083900000,-1.43473229300000,-2.40872177500000,-2.39849012100000,-2.52050262800000,-3.70960334300000,-2.93062160000000,-4.33555254900000;-1.00584012500000,-0.278320464000000,0.0408237820000000,0.189390704000000,0.315073372000000,-0.207966584000000,0.0426520250000000,-0.152203101000000,-0.267740879000000,-0.163228404000000,0.647784274000000,1.14133486500000,0.976433062000000,1.70434763600000,1.38243446900000,1.86758888100000,1.41274055800000,1.60822629500000,1.52043784000000,0.925789046000000,0.810552180000000,1.14403334200000,0.854014586000000,0.824597658000000,0.798120131000000,-0.563188273000000,-0.00294058900000000,-0.343039463000000,-0.221768524000000,-0.0708774560000000,-0.429046457000000,0.386425643000000,-0.244665543000000,-0.0516762890000000,-0.840800761000000;-0.241990475000000,-0.522295039000000,-0.185435300000000,-0.427683990000000,-0.807245420000000,-1.29209475200000,-1.00585352300000,-0.657006776000000,-0.859877497000000,-0.511048488000000,0.0827240390000000,0.257243187000000,-0.0905563160000000,0.602032381000000,0.545247922000000,0.534254917000000,0.566988648000000,0.463917342000000,0.239377554000000,0.734089850000000,0.349929300000000,0.642626145000000,0.500082935000000,0.414548087000000,-0.0360570780000000,0.146572243000000,0.135115849000000,-0.0685252500000000,-0.150943629000000,-0.269482681000000,-0.569571782000000,-0.421659602000000,-0.823358645000000,-0.572279352000000,-0.814231359000000;-2.04510686500000,-2.01884972700000,-2.06726333200000,-1.38816132100000,-0.833497273000000,-0.699893812000000,-0.942804825000000,-0.737454103000000,-0.625189581000000,-0.554620699000000,-1.02499992300000,-1.21885419300000,-2.12539940400000,-1.92518179800000,-2.28920286500000,-2.55210459200000,-2.11026075600000,-2.06250677400000,-2.55727002600000,-2.38123059900000,-1.47585779400000,-2.50772669900000,-2.13939756400000,-2.28217287300000,-1.65436100000000,-0.918151326000000,-0.289275730000000,-0.468811708000000,-0.891990535000000,-0.679641544000000,-0.428318197000000,-0.235543161000000,-0.878633281000000,-1.41070531900000,-0.449623768000000;-0.225775095000000,0.0350064220000000,-0.190371196000000,0.761081975000000,0.0410730210000000,0.237996949000000,0.425450840000000,0.280521097000000,-0.155413339000000,-0.273461151000000,-0.386870589000000,-0.476476011000000,0.612294518000000,0.830360483000000,0.506016985000000,1.00153505100000,0.856393360000000,0.771120426000000,1.42142032800000,0.798834674000000,2.01652846600000,0.666179156000000,-0.00863221400000000,-0.301311449000000,-0.621981442000000,-0.255118984000000,-0.732042297000000,-0.986518570000000,-0.641087467000000,-0.769134856000000,-0.329653775000000,-0.700760270000000,-0.873793211000000,-0.841673674000000,-0.993352718000000;0.0584682980000000,-0.445104989000000,0.629108742000000,-0.0286991440000000,0.273744509000000,-0.146418507000000,0.557140508000000,0.0788502150000000,0.134414602000000,1.19432424400000,1.67056663200000,1.54225427900000,1.07362746800000,1.57330394800000,1.66421726400000,1.47828388300000,1.33997104100000,1.13579067100000,1.32316857200000,1.87801126400000,1.73951840500000,1.14113417300000,0.893419134000000,1.13459757900000,1.12259879300000,0.695669255000000,1.02728854400000,0.691643992000000,-0.292247925000000,-0.144787346000000,-0.0520775320000000,-0.327676427000000,0.224960520000000,-0.606133366000000,-0.135107384000000;-1.92383593800000,-1.23606613900000,-1.38968199600000,-1.75774290500000,-1.58999880700000,-2.59283437900000,-1.81610315600000,-1.98270173000000,-2.13484823200000,-1.87768302000000,-1.13953116100000,-1.45603146700000,-0.419827809000000,-0.191420812000000,0.198879045000000,-0.187585731000000,-1.31764185800000,-0.133499123000000,-0.641485767000000,-0.738077653000000,-0.638773729000000,-0.590051637000000,-0.494710034000000,-0.408891573000000,-0.998604820000000,-1.36861882500000,-1.05245722500000,-1.30740193900000,-1.46934999100000,-1.21703148100000,-0.706542636000000,-0.830981164000000,-0.517783937000000,-0.785081863000000,-0.155171283000000;0.395650276000000,0.312602418000000,0.113871225000000,0.221596971000000,0.210806617000000,0.352863001000000,0.209782878000000,0.383784586000000,0.443848763000000,0.601745000000000,0.579357099000000,0.648214259000000,0.630673963000000,0.636969977000000,0.512254361000000,0.513154553000000,0.559493698000000,0.633616921000000,0.669976426000000,0.556488883000000,0.396019630000000,0.381907093000000,0.421147843000000,0.515515551000000,0.366699434000000,0.179080749000000,0.270924916000000,0.217252683000000,0.0478095590000000,0.186618213000000,0.115621432000000,0.136564605000000,0.106936992000000,0.0223902430000000,0.325841022000000;0.107135539000000,-0.00141266900000000,0.0710212440000000,0.144716416000000,0.127201142000000,0.357466862000000,0.232061749000000,0.118951388000000,0.0312691560000000,0.133489544000000,-0.167964696000000,0.396531517000000,0.0416511020000000,0.527441310000000,0.187805340000000,0.490457506000000,0.658398020000000,0.298982329000000,0.592330322000000,0.446639900000000,0.349259558000000,0.643639938000000,0.197122867000000,0.153143134000000,-0.108980402000000,-0.174773882000000,-0.307265216000000,-0.316162564000000,-0.355242901000000,-0.765248568000000,-0.727122409000000,-0.858091608000000,-0.971566810000000,-0.816861110000000,-1.01002069100000];
%   gal4_rfAcrossCells = [-0.869478364000000,-1.51528485200000,-1.29671345000000,-0.299816294000000,-0.835017168000000,-0.493859679000000,-0.576058274000000,-1.07272866200000,-0.432733252000000,-0.411513427000000,-0.860382813000000,-0.198106428000000,-0.249498910000000,-0.513250053000000,-0.982305471000000,-1.01019197300000,-1.75418078300000,-1.15501363000000,-2.21839811900000,-2.18386289800000,-2.57581183000000,-2.37783090100000,-3.09429434400000,-2.44603487300000,-2.29541290000000,-2.73811060400000,-2.18850067400000,-1.61399969500000,-1.61675479700000,-1.90436231900000,-1.60230812500000,-1.98372895000000,-1.71207165000000,-2.20115127700000,-2.35834797300000;-0.417945757000000,-2.18668178300000,-1.66539585800000,-1.77116037100000,-1.82429139700000,-2.22090412800000,-2.16658054400000,-2.73672812900000,-2.05305071800000,-1.45552108300000,-0.819434670000000,-0.952000133000000,-0.460124713000000,0.000433596000000000,-0.00433236100000000,0.404445482000000,0.0911745470000000,0.577947994000000,-0.0474703820000000,0.0142553710000000,-0.00115523500000000,-0.0300167610000000,-0.376104756000000,-1.01825213700000,-1.30356321400000,-1.87252054200000,-1.73724182400000,-1.75510165600000,-1.64001038400000,-2.13283127300000,-1.11225492900000,-1.04841930100000,-1.92137220200000,-1.46020756000000,-1.44648416900000;-3.32781485200000,-3.34058063000000,-2.80458980000000,-3.20232143800000,-2.01758737400000,-3.06879419500000,-2.85613981000000,-3.01952787800000,-2.79760712900000,-3.13975023200000,-2.84408987800000,-2.46062134800000,-2.59566249500000,-2.51294954500000,-1.73671931900000,-2.22311862300000,-2.67591225900000,-2.39493401100000,-2.33876201800000,-2.69705321500000,-2.34743688700000,-2.76996708100000,-3.49077138800000,-2.63916537200000,-2.14258155700000,-2.87448669500000,-1.66800124100000,-3.00198140200000,-2.86676024300000,-2.48890213200000,-1.30081557300000,-1.29837524800000,-0.680373772000000,-1.06577964300000,-0.677992472000000;-0.839167865000000,-0.948766512000000,-0.921535919000000,-1.52656277800000,-1.12792562900000,-0.567583342000000,-0.694625240000000,-0.515570543000000,-0.564731187000000,0.0165619980000000,0.979425660000000,0.264629986000000,0.351740459000000,1.22745442800000,0.309809527000000,0.778527773000000,0.470582368000000,0.370635792000000,-0.221045472000000,-0.496877104000000,-0.704212603000000,-0.780319316000000,-1.35437547300000,-1.52420120600000,-1.58774880800000,-1.94821936700000,-2.50229331900000,-1.86612024300000,-1.60731933000000,-1.66742947200000,-1.98146817600000,-2.22579733300000,-1.56291154400000,-0.619892825000000,-1.11630606500000;-0.673468109000000,-0.720374321000000,-0.825350285000000,-1.48347297300000,-2.48942704900000,-2.14671810700000,-1.00844920400000,-2.67141681400000,-1.69341356400000,-2.98498649900000,-2.10845455300000,-2.15831168300000,-2.79214783900000,-2.26353635900000,-2.58753412400000,-1.82200894000000,-1.35381309100000,-1.67762958700000,-1.91403138100000,-1.46084017200000,-1.87098487200000,-1.72121272100000,-1.28291559200000,-1.37076992300000,-1.82434422400000,-1.29309487700000,-1.34315988300000,-1.08184027400000,-1.44405336500000,-1.22010999300000,0.0379573420000000,-0.925175911000000,-0.860585543000000,-0.834101479000000,-1.27553027400000;-1.06012824000000,-1.90970965100000,-1.56130334700000,-3.10410521300000,-1.75200444300000,-0.916762993000000,-2.05966046600000,-2.35518036100000,-1.89295994200000,-1.62144206300000,-2.10863262200000,-1.88815234500000,-1.59287398600000,-1.34614823600000,-1.72029356000000,-1.37241515600000,-2.53005988300000,-2.51650756600000,-2.93862410800000,-2.67760946200000,-2.63965724000000,-2.15702016100000,-3.00864031800000,-2.28721437300000,-3.03998852100000,-2.94058294400000,-2.21218688600000,-1.22535316700000,-0.775751453000000,-1.47342162100000,-1.04697799300000,-1.38511316400000,-1.05734356800000,-1.24252717800000,-1.51878410100000;-0.695325877000000,-0.804177583000000,-0.00359246100000000,0.0740181390000000,-0.0846581480000000,-0.402011354000000,-0.440257522000000,-0.909774455000000,-0.218659136000000,-0.719986449000000,-0.455245991000000,-1.09057679400000,-0.470445859000000,-0.391846983000000,-0.888910893000000,-0.649949256000000,-0.751914894000000,-0.720345750000000,0.0453892520000000,-0.443732140000000,-1.30046179600000,-2.81538071500000,-2.12389090700000,-2.37670593900000,-2.02979450300000,-2.86903229300000,-2.00619302400000,-1.82272075600000,-0.990798206000000,-1.08972986900000,-1.03179330200000,-0.575414426000000,0.235814708000000,0.0379393440000000,-0.857173406000000;-2.42762993300000,-2.89453378300000,-3.35783302000000,-2.78955079000000,-4.59389074000000,-5.28190580800000,-5.03378317400000,-5.85358944500000,-4.69259913600000,-5.29339822700000,-4.10912354800000,-4.66617758100000,-3.97012362000000,-3.96780674100000,-3.07432954900000,-3.26430815300000,-3.04967910700000,-3.53177544700000,-3.64750179600000,-2.82217974300000,-3.29829903800000,-3.15874653200000,-2.85891898600000,-3.37336933500000,-2.77374975300000,-3.67374138300000,-1.64358936500000,-3.42694001500000,-2.54897612500000,-3.11275767000000,-1.77568899500000,-2.77653266500000,-3.12705947200000,-4.45396522900000,-4.35799971500000;-3.24345944000000,-4.62377388400000,-4.29087828100000,-4.21741434300000,-4.25935977100000,-4.19986635600000,-4.03310326700000,-4.22577847200000,-4.24123741300000,-4.05703297500000,-2.95112338200000,-2.84212348600000,-2.52527169700000,-1.53816167600000,-3.20317056700000,-0.584424299000000,-2.87403782000000,-1.82991231200000,-3.67435237200000,-3.21594633300000,-3.84919377100000,-3.54097152600000,-5.18624480400000,-3.57585284900000,-4.81710261900000,-5.36973415600000,-5.13068609400000,-4.10024686200000,-5.04617165700000,-5.14240260200000,-3.89178788400000,-4.36175688600000,-3.85824235600000,-4.00149402600000,-5.13382711900000;0.0802474120000000,0.531022984000000,-0.182534965000000,0.617279995000000,0.474450374000000,0.929391743000000,1.02203817800000,1.08132947000000,0.906240831000000,-0.210836028000000,0.576801919000000,0.922135529000000,-0.720566752000000,-0.634247221000000,-0.873395913000000,-1.01763952300000,-0.990422223000000,-2.38032724100000,-3.46082071900000,-2.35798768400000,-2.55900083400000,-3.78753278000000,-3.40229256000000,-3.39451482000000,-2.37652143000000,-3.34973376500000,-2.92601317400000,-2.29440676400000,-3.20870609200000,-2.60693461800000,-2.13905665400000,-1.64877459300000,-1.67478204200000,-1.05569790000000,-1.70476643100000];
%   uas_rfAcrossCells = [-1.53284352300000,-1.84979842100000,-2.12736795400000,-1.71146278400000,-2.29899170200000,-2.54004917200000,-1.75934953900000,-1.92091867600000,-0.869352048000000,-1.42393277800000,-1.39212658200000,-0.940750242000000,-1.32000228900000,-0.692828286000000,-1.08926528500000,-0.682991659000000,-0.251278878000000,-0.590782532000000,-0.933284457000000,-1.02494124400000,-1.78137186600000,-1.39480533600000,-1.27915952800000,-1.65741658600000,-1.56784235900000,-1.24156966200000,-1.65147459900000,-2.44574912600000,-1.30352135100000,-2.15023117100000,-2.42663807200000,-2.07209948700000,-2.08706105200000,-1.82048321500000,-1.54865677600000;-0.0375306660000000,-0.689116524000000,-0.436653216000000,0.448521539000000,-1.10947121200000,-1.23813116000000,-0.00755172300000000,-0.599591437000000,0.874799018000000,-0.234195220000000,-0.0355373690000000,0.622813232000000,0.355272547000000,-0.364590624000000,-0.931042042000000,-0.238262157000000,-0.361269366000000,-1.24722613600000,-1.11984734400000,-1.76236326300000,-2.00975705400000,-2.45744382200000,-1.75742798800000,-2.61762034200000,-2.44448083400000,-2.71924457800000,-3.54594769800000,-3.31880410900000,-3.12439508900000,-3.13003267900000,-2.94375824700000,-3.16010674100000,-2.58100816800000,-2.05817856500000,-2.12359100700000;-0.334090782000000,-0.0803226860000000,-0.973608051000000,-1.32351160900000,-1.06227752200000,-2.04552058900000,-0.976871346000000,-0.739641120000000,-0.478333574000000,-0.673561824000000,-0.461759574000000,-0.353651193000000,-0.289890257000000,-0.616908056000000,-1.05090227400000,-0.783689946000000,-0.622909011000000,-0.936314971000000,-0.783268467000000,-0.206876750000000,-1.03635422100000,-1.43405697800000,-1.65348642700000,-1.34275521500000,-1.39822045400000,-1.87496183200000,-1.96320681500000,-1.87301957000000,-1.63726545400000,-2.28562807400000,-1.61276887200000,-1.36088791500000,-1.16815693700000,-1.22485299500000,-0.712800338000000;-2.37479758500000,-2.29900326900000,-1.28553922300000,-1.31798194400000,-2.36422958500000,-2.82822966600000,-3.44934515200000,-4.45329535600000,-3.92903697500000,-4.43220983500000,-2.77614880900000,-3.67781856300000,-3.08695535100000,-3.10616394700000,-3.87141926700000,-3.16804212900000,-3.31193818000000,-3.15055455900000,-2.91113276900000,-1.83241554000000,-3.36663793600000,-3.42554714800000,-3.51678358900000,-2.39471687600000,-4.09717349700000,-3.24953764200000,-2.61376905400000,-2.25494417000000,-1.75407814900000,-3.26691969800000,-1.37985585500000,-1.50647046300000,-2.90473108400000,-3.01177694000000,-2.76133544200000;0.284816041000000,-0.914722664000000,-0.983575897000000,-0.135029670000000,-1.49204243600000,-0.783879655000000,-0.830942474000000,-1.58259913500000,0.0319578390000000,-0.773273426000000,0.0152056170000000,0.0360277740000000,-0.0361872600000000,-0.128460824000000,-1.22924584300000,-0.630139541000000,-0.408652982000000,-0.851187394000000,-0.561859242000000,-1.41527975500000,-2.36599954600000,-2.31480828600000,-2.74331363000000,-3.09880517400000,-3.43000073400000,-3.11886472000000,-2.47963654700000,-4.24614206900000,-3.11762925400000,-3.50955519000000,-2.36877768500000,-1.98415828800000,-2.24289862000000,-1.68437063300000,-0.683340273000000;-1.85919805300000,-1.56266991200000,-1.19023917100000,-0.628382514000000,-1.45831455000000,-1.57637196200000,-1.82702368600000,-2.30943487800000,-2.03861585500000,-2.60746050300000,-3.10547614600000,-3.13612349900000,-3.99372841000000,-3.07051691700000,-3.69748936300000,-3.64773183600000,-3.50647443800000,-3.29120124900000,-4.14038845300000,-2.90838790600000,-3.88161651600000,-3.94390124800000,-3.17818517500000,-3.52969650500000,-2.97995541900000,-3.47367918900000,-1.86625198900000,-1.73184646400000,-1.95689357100000,-1.73179365100000,-0.895648644000000,-1.82892495800000,-2.29627203400000,-1.36369082700000,-1.21316790800000;-0.522549523000000,-1.22493176800000,-1.32819575200000,-0.824541437000000,-1.03576774000000,-1.34573310900000,-1.17765433800000,-1.73709998200000,-1.19400223900000,-1.68232250800000,-0.642017793000000,-0.841612346000000,-0.772762399000000,-0.721180050000000,-0.919172873000000,-0.665810587000000,-0.960056931000000,-0.712356738000000,-0.939289089000000,-1.14160999700000,-0.924671869000000,-0.877374303000000,-1.00378874500000,-1.45121552100000,-1.82149902900000,-1.37099409300000,-1.51949380200000,-1.94839691800000,-1.44996322900000,-1.91016087600000,-1.41134514700000,-1.06815646300000,-1.08529558100000,-0.702622532000000,-0.684053757000000;-0.744713038000000,-1.12264077700000,-0.953140874000000,-2.47711174200000,-1.90561925200000,-1.91609234100000,-1.91761721200000,-2.55043120700000,-2.37042732800000,-1.92608314600000,-1.48950258500000,-1.64830375000000,-2.02447547600000,-1.98513993200000,-1.33160392700000,-1.15896767000000,-1.61658966500000,-0.754661692000000,-0.957173529000000,-0.867659250000000,-1.23755129900000,-0.928068101000000,-0.775798309000000,-0.733694119000000,-1.24573859000000,-0.723535354000000,-0.240954987000000,-0.881704051000000,-0.748714671000000,-1.54303678400000,0.209387170000000,-0.378032814000000,-0.394310999000000,-1.10155018600000,-1.08994429900000];

 rfAcrossAllGenotypes = [-0.00563518100000000,-0.285430375000000,-0.143028149000000,-0.137312955000000,-0.100916145000000,-0.153528041000000,0.0397886880000000,0.156582089000000,0.294671354000000,0.296369872000000,-0.395279749000000,0.273940132000000,-0.168912788000000,0.599053832000000,0.384009656000000,0.862358624000000,0.737792814000000,0.557775103000000,1.26826011400000,0.755635936000000,1.51275414800000,1.06299385100000,0.510011727000000,1.41130570600000,0.324045057000000,0.373935844000000,-0.494833817000000,-0.189930481000000,-0.664024921000000,-0.790334916000000,-0.391428405000000,-0.313862506000000,-0.0457380050000000,0.213865445000000,0.267321195000000;-0.437114847000000,-0.597400827000000,-0.659012436000000,-0.848803455000000,-0.550079452000000,-0.161034382000000,0.300722471000000,0.138651473000000,0.0968549940000000,-0.112023701000000,-0.297842154000000,-0.490175052000000,-0.604210522000000,-1.44928202000000,-1.34637089900000,-1.00075049100000,-0.549716124000000,-0.947817468000000,-0.292903224000000,-0.471245182000000,-0.434335330000000,-1.16526391400000,-0.801311618000000,-0.656480390000000,-0.0797303300000000,-0.463921108000000,-0.288289290000000,-1.11106083900000,-1.43473229300000,-2.40872177500000,-2.39849012100000,-2.52050262800000,-3.70960334300000,-2.93062160000000,-4.33555254900000;-1.00584012500000,-0.278320464000000,0.0408237820000000,0.189390704000000,0.315073372000000,-0.207966584000000,0.0426520250000000,-0.152203101000000,-0.267740879000000,-0.163228404000000,0.647784274000000,1.14133486500000,0.976433062000000,1.70434763600000,1.38243446900000,1.86758888100000,1.41274055800000,1.60822629500000,1.52043784000000,0.925789046000000,0.810552180000000,1.14403334200000,0.854014586000000,0.824597658000000,0.798120131000000,-0.563188273000000,-0.00294058900000000,-0.343039463000000,-0.221768524000000,-0.0708774560000000,-0.429046457000000,0.386425643000000,-0.244665543000000,-0.0516762890000000,-0.840800761000000;-0.241990475000000,-0.522295039000000,-0.185435300000000,-0.427683990000000,-0.807245420000000,-1.29209475200000,-1.00585352300000,-0.657006776000000,-0.859877497000000,-0.511048488000000,0.0827240390000000,0.257243187000000,-0.0905563160000000,0.602032381000000,0.545247922000000,0.534254917000000,0.566988648000000,0.463917342000000,0.239377554000000,0.734089850000000,0.349929300000000,0.642626145000000,0.500082935000000,0.414548087000000,-0.0360570780000000,0.146572243000000,0.135115849000000,-0.0685252500000000,-0.150943629000000,-0.269482681000000,-0.569571782000000,-0.421659602000000,-0.823358645000000,-0.572279352000000,-0.814231359000000;-2.04510686500000,-2.01884972700000,-2.06726333200000,-1.38816132100000,-0.833497273000000,-0.699893812000000,-0.942804825000000,-0.737454103000000,-0.625189581000000,-0.554620699000000,-1.02499992300000,-1.21885419300000,-2.12539940400000,-1.92518179800000,-2.28920286500000,-2.55210459200000,-2.11026075600000,-2.06250677400000,-2.55727002600000,-2.38123059900000,-1.47585779400000,-2.50772669900000,-2.13939756400000,-2.28217287300000,-1.65436100000000,-0.918151326000000,-0.289275730000000,-0.468811708000000,-0.891990535000000,-0.679641544000000,-0.428318197000000,-0.235543161000000,-0.878633281000000,-1.41070531900000,-0.449623768000000;-0.225775095000000,0.0350064220000000,-0.190371196000000,0.761081975000000,0.0410730210000000,0.237996949000000,0.425450840000000,0.280521097000000,-0.155413339000000,-0.273461151000000,-0.386870589000000,-0.476476011000000,0.612294518000000,0.830360483000000,0.506016985000000,1.00153505100000,0.856393360000000,0.771120426000000,1.42142032800000,0.798834674000000,2.01652846600000,0.666179156000000,-0.00863221400000000,-0.301311449000000,-0.621981442000000,-0.255118984000000,-0.732042297000000,-0.986518570000000,-0.641087467000000,-0.769134856000000,-0.329653775000000,-0.700760270000000,-0.873793211000000,-0.841673674000000,-0.993352718000000;0.0584682980000000,-0.445104989000000,0.629108742000000,-0.0286991440000000,0.273744509000000,-0.146418507000000,0.557140508000000,0.0788502150000000,0.134414602000000,1.19432424400000,1.67056663200000,1.54225427900000,1.07362746800000,1.57330394800000,1.66421726400000,1.47828388300000,1.33997104100000,1.13579067100000,1.32316857200000,1.87801126400000,1.73951840500000,1.14113417300000,0.893419134000000,1.13459757900000,1.12259879300000,0.695669255000000,1.02728854400000,0.691643992000000,-0.292247925000000,-0.144787346000000,-0.0520775320000000,-0.327676427000000,0.224960520000000,-0.606133366000000,-0.135107384000000;-1.92383593800000,-1.23606613900000,-1.38968199600000,-1.75774290500000,-1.58999880700000,-2.59283437900000,-1.81610315600000,-1.98270173000000,-2.13484823200000,-1.87768302000000,-1.13953116100000,-1.45603146700000,-0.419827809000000,-0.191420812000000,0.198879045000000,-0.187585731000000,-1.31764185800000,-0.133499123000000,-0.641485767000000,-0.738077653000000,-0.638773729000000,-0.590051637000000,-0.494710034000000,-0.408891573000000,-0.998604820000000,-1.36861882500000,-1.05245722500000,-1.30740193900000,-1.46934999100000,-1.21703148100000,-0.706542636000000,-0.830981164000000,-0.517783937000000,-0.785081863000000,-0.155171283000000;0.395650276000000,0.312602418000000,0.113871225000000,0.221596971000000,0.210806617000000,0.352863001000000,0.209782878000000,0.383784586000000,0.443848763000000,0.601745000000000,0.579357099000000,0.648214259000000,0.630673963000000,0.636969977000000,0.512254361000000,0.513154553000000,0.559493698000000,0.633616921000000,0.669976426000000,0.556488883000000,0.396019630000000,0.381907093000000,0.421147843000000,0.515515551000000,0.366699434000000,0.179080749000000,0.270924916000000,0.217252683000000,0.0478095590000000,0.186618213000000,0.115621432000000,0.136564605000000,0.106936992000000,0.0223902430000000,0.325841022000000;0.107135539000000,-0.00141266900000000,0.0710212440000000,0.144716416000000,0.127201142000000,0.357466862000000,0.232061749000000,0.118951388000000,0.0312691560000000,0.133489544000000,-0.167964696000000,0.396531517000000,0.0416511020000000,0.527441310000000,0.187805340000000,0.490457506000000,0.658398020000000,0.298982329000000,0.592330322000000,0.446639900000000,0.349259558000000,0.643639938000000,0.197122867000000,0.153143134000000,-0.108980402000000,-0.174773882000000,-0.307265216000000,-0.316162564000000,-0.355242901000000,-0.765248568000000,-0.727122409000000,-0.858091608000000,-0.971566810000000,-0.816861110000000,-1.01002069100000;-0.869478364000000,-1.51528485200000,-1.29671345000000,-0.299816294000000,-0.835017168000000,-0.493859679000000,-0.576058274000000,-1.07272866200000,-0.432733252000000,-0.411513427000000,-0.860382813000000,-0.198106428000000,-0.249498910000000,-0.513250053000000,-0.982305471000000,-1.01019197300000,-1.75418078300000,-1.15501363000000,-2.21839811900000,-2.18386289800000,-2.57581183000000,-2.37783090100000,-3.09429434400000,-2.44603487300000,-2.29541290000000,-2.73811060400000,-2.18850067400000,-1.61399969500000,-1.61675479700000,-1.90436231900000,-1.60230812500000,-1.98372895000000,-1.71207165000000,-2.20115127700000,-2.35834797300000;-0.417945757000000,-2.18668178300000,-1.66539585800000,-1.77116037100000,-1.82429139700000,-2.22090412800000,-2.16658054400000,-2.73672812900000,-2.05305071800000,-1.45552108300000,-0.819434670000000,-0.952000133000000,-0.460124713000000,0.000433596000000000,-0.00433236100000000,0.404445482000000,0.0911745470000000,0.577947994000000,-0.0474703820000000,0.0142553710000000,-0.00115523500000000,-0.0300167610000000,-0.376104756000000,-1.01825213700000,-1.30356321400000,-1.87252054200000,-1.73724182400000,-1.75510165600000,-1.64001038400000,-2.13283127300000,-1.11225492900000,-1.04841930100000,-1.92137220200000,-1.46020756000000,-1.44648416900000;-3.32781485200000,-3.34058063000000,-2.80458980000000,-3.20232143800000,-2.01758737400000,-3.06879419500000,-2.85613981000000,-3.01952787800000,-2.79760712900000,-3.13975023200000,-2.84408987800000,-2.46062134800000,-2.59566249500000,-2.51294954500000,-1.73671931900000,-2.22311862300000,-2.67591225900000,-2.39493401100000,-2.33876201800000,-2.69705321500000,-2.34743688700000,-2.76996708100000,-3.49077138800000,-2.63916537200000,-2.14258155700000,-2.87448669500000,-1.66800124100000,-3.00198140200000,-2.86676024300000,-2.48890213200000,-1.30081557300000,-1.29837524800000,-0.680373772000000,-1.06577964300000,-0.677992472000000;-0.839167865000000,-0.948766512000000,-0.921535919000000,-1.52656277800000,-1.12792562900000,-0.567583342000000,-0.694625240000000,-0.515570543000000,-0.564731187000000,0.0165619980000000,0.979425660000000,0.264629986000000,0.351740459000000,1.22745442800000,0.309809527000000,0.778527773000000,0.470582368000000,0.370635792000000,-0.221045472000000,-0.496877104000000,-0.704212603000000,-0.780319316000000,-1.35437547300000,-1.52420120600000,-1.58774880800000,-1.94821936700000,-2.50229331900000,-1.86612024300000,-1.60731933000000,-1.66742947200000,-1.98146817600000,-2.22579733300000,-1.56291154400000,-0.619892825000000,-1.11630606500000;-0.673468109000000,-0.720374321000000,-0.825350285000000,-1.48347297300000,-2.48942704900000,-2.14671810700000,-1.00844920400000,-2.67141681400000,-1.69341356400000,-2.98498649900000,-2.10845455300000,-2.15831168300000,-2.79214783900000,-2.26353635900000,-2.58753412400000,-1.82200894000000,-1.35381309100000,-1.67762958700000,-1.91403138100000,-1.46084017200000,-1.87098487200000,-1.72121272100000,-1.28291559200000,-1.37076992300000,-1.82434422400000,-1.29309487700000,-1.34315988300000,-1.08184027400000,-1.44405336500000,-1.22010999300000,0.0379573420000000,-0.925175911000000,-0.860585543000000,-0.834101479000000,-1.27553027400000;-1.06012824000000,-1.90970965100000,-1.56130334700000,-3.10410521300000,-1.75200444300000,-0.916762993000000,-2.05966046600000,-2.35518036100000,-1.89295994200000,-1.62144206300000,-2.10863262200000,-1.88815234500000,-1.59287398600000,-1.34614823600000,-1.72029356000000,-1.37241515600000,-2.53005988300000,-2.51650756600000,-2.93862410800000,-2.67760946200000,-2.63965724000000,-2.15702016100000,-3.00864031800000,-2.28721437300000,-3.03998852100000,-2.94058294400000,-2.21218688600000,-1.22535316700000,-0.775751453000000,-1.47342162100000,-1.04697799300000,-1.38511316400000,-1.05734356800000,-1.24252717800000,-1.51878410100000;-0.695325877000000,-0.804177583000000,-0.00359246100000000,0.0740181390000000,-0.0846581480000000,-0.402011354000000,-0.440257522000000,-0.909774455000000,-0.218659136000000,-0.719986449000000,-0.455245991000000,-1.09057679400000,-0.470445859000000,-0.391846983000000,-0.888910893000000,-0.649949256000000,-0.751914894000000,-0.720345750000000,0.0453892520000000,-0.443732140000000,-1.30046179600000,-2.81538071500000,-2.12389090700000,-2.37670593900000,-2.02979450300000,-2.86903229300000,-2.00619302400000,-1.82272075600000,-0.990798206000000,-1.08972986900000,-1.03179330200000,-0.575414426000000,0.235814708000000,0.0379393440000000,-0.857173406000000;-2.42762993300000,-2.89453378300000,-3.35783302000000,-2.78955079000000,-4.59389074000000,-5.28190580800000,-5.03378317400000,-5.85358944500000,-4.69259913600000,-5.29339822700000,-4.10912354800000,-4.66617758100000,-3.97012362000000,-3.96780674100000,-3.07432954900000,-3.26430815300000,-3.04967910700000,-3.53177544700000,-3.64750179600000,-2.82217974300000,-3.29829903800000,-3.15874653200000,-2.85891898600000,-3.37336933500000,-2.77374975300000,-3.67374138300000,-1.64358936500000,-3.42694001500000,-2.54897612500000,-3.11275767000000,-1.77568899500000,-2.77653266500000,-3.12705947200000,-4.45396522900000,-4.35799971500000;-3.24345944000000,-4.62377388400000,-4.29087828100000,-4.21741434300000,-4.25935977100000,-4.19986635600000,-4.03310326700000,-4.22577847200000,-4.24123741300000,-4.05703297500000,-2.95112338200000,-2.84212348600000,-2.52527169700000,-1.53816167600000,-3.20317056700000,-0.584424299000000,-2.87403782000000,-1.82991231200000,-3.67435237200000,-3.21594633300000,-3.84919377100000,-3.54097152600000,-5.18624480400000,-3.57585284900000,-4.81710261900000,-5.36973415600000,-5.13068609400000,-4.10024686200000,-5.04617165700000,-5.14240260200000,-3.89178788400000,-4.36175688600000,-3.85824235600000,-4.00149402600000,-5.13382711900000;0.0802474120000000,0.531022984000000,-0.182534965000000,0.617279995000000,0.474450374000000,0.929391743000000,1.02203817800000,1.08132947000000,0.906240831000000,-0.210836028000000,0.576801919000000,0.922135529000000,-0.720566752000000,-0.634247221000000,-0.873395913000000,-1.01763952300000,-0.990422223000000,-2.38032724100000,-3.46082071900000,-2.35798768400000,-2.55900083400000,-3.78753278000000,-3.40229256000000,-3.39451482000000,-2.37652143000000,-3.34973376500000,-2.92601317400000,-2.29440676400000,-3.20870609200000,-2.60693461800000,-2.13905665400000,-1.64877459300000,-1.67478204200000,-1.05569790000000,-1.70476643100000;-1.53284352300000,-1.84979842100000,-2.12736795400000,-1.71146278400000,-2.29899170200000,-2.54004917200000,-1.75934953900000,-1.92091867600000,-0.869352048000000,-1.42393277800000,-1.39212658200000,-0.940750242000000,-1.32000228900000,-0.692828286000000,-1.08926528500000,-0.682991659000000,-0.251278878000000,-0.590782532000000,-0.933284457000000,-1.02494124400000,-1.78137186600000,-1.39480533600000,-1.27915952800000,-1.65741658600000,-1.56784235900000,-1.24156966200000,-1.65147459900000,-2.44574912600000,-1.30352135100000,-2.15023117100000,-2.42663807200000,-2.07209948700000,-2.08706105200000,-1.82048321500000,-1.54865677600000;-0.0375306660000000,-0.689116524000000,-0.436653216000000,0.448521539000000,-1.10947121200000,-1.23813116000000,-0.00755172300000000,-0.599591437000000,0.874799018000000,-0.234195220000000,-0.0355373690000000,0.622813232000000,0.355272547000000,-0.364590624000000,-0.931042042000000,-0.238262157000000,-0.361269366000000,-1.24722613600000,-1.11984734400000,-1.76236326300000,-2.00975705400000,-2.45744382200000,-1.75742798800000,-2.61762034200000,-2.44448083400000,-2.71924457800000,-3.54594769800000,-3.31880410900000,-3.12439508900000,-3.13003267900000,-2.94375824700000,-3.16010674100000,-2.58100816800000,-2.05817856500000,-2.12359100700000;-0.334090782000000,-0.0803226860000000,-0.973608051000000,-1.32351160900000,-1.06227752200000,-2.04552058900000,-0.976871346000000,-0.739641120000000,-0.478333574000000,-0.673561824000000,-0.461759574000000,-0.353651193000000,-0.289890257000000,-0.616908056000000,-1.05090227400000,-0.783689946000000,-0.622909011000000,-0.936314971000000,-0.783268467000000,-0.206876750000000,-1.03635422100000,-1.43405697800000,-1.65348642700000,-1.34275521500000,-1.39822045400000,-1.87496183200000,-1.96320681500000,-1.87301957000000,-1.63726545400000,-2.28562807400000,-1.61276887200000,-1.36088791500000,-1.16815693700000,-1.22485299500000,-0.712800338000000;-2.37479758500000,-2.29900326900000,-1.28553922300000,-1.31798194400000,-2.36422958500000,-2.82822966600000,-3.44934515200000,-4.45329535600000,-3.92903697500000,-4.43220983500000,-2.77614880900000,-3.67781856300000,-3.08695535100000,-3.10616394700000,-3.87141926700000,-3.16804212900000,-3.31193818000000,-3.15055455900000,-2.91113276900000,-1.83241554000000,-3.36663793600000,-3.42554714800000,-3.51678358900000,-2.39471687600000,-4.09717349700000,-3.24953764200000,-2.61376905400000,-2.25494417000000,-1.75407814900000,-3.26691969800000,-1.37985585500000,-1.50647046300000,-2.90473108400000,-3.01177694000000,-2.76133544200000;0.284816041000000,-0.914722664000000,-0.983575897000000,-0.135029670000000,-1.49204243600000,-0.783879655000000,-0.830942474000000,-1.58259913500000,0.0319578390000000,-0.773273426000000,0.0152056170000000,0.0360277740000000,-0.0361872600000000,-0.128460824000000,-1.22924584300000,-0.630139541000000,-0.408652982000000,-0.851187394000000,-0.561859242000000,-1.41527975500000,-2.36599954600000,-2.31480828600000,-2.74331363000000,-3.09880517400000,-3.43000073400000,-3.11886472000000,-2.47963654700000,-4.24614206900000,-3.11762925400000,-3.50955519000000,-2.36877768500000,-1.98415828800000,-2.24289862000000,-1.68437063300000,-0.683340273000000;-1.85919805300000,-1.56266991200000,-1.19023917100000,-0.628382514000000,-1.45831455000000,-1.57637196200000,-1.82702368600000,-2.30943487800000,-2.03861585500000,-2.60746050300000,-3.10547614600000,-3.13612349900000,-3.99372841000000,-3.07051691700000,-3.69748936300000,-3.64773183600000,-3.50647443800000,-3.29120124900000,-4.14038845300000,-2.90838790600000,-3.88161651600000,-3.94390124800000,-3.17818517500000,-3.52969650500000,-2.97995541900000,-3.47367918900000,-1.86625198900000,-1.73184646400000,-1.95689357100000,-1.73179365100000,-0.895648644000000,-1.82892495800000,-2.29627203400000,-1.36369082700000,-1.21316790800000;-0.522549523000000,-1.22493176800000,-1.32819575200000,-0.824541437000000,-1.03576774000000,-1.34573310900000,-1.17765433800000,-1.73709998200000,-1.19400223900000,-1.68232250800000,-0.642017793000000,-0.841612346000000,-0.772762399000000,-0.721180050000000,-0.919172873000000,-0.665810587000000,-0.960056931000000,-0.712356738000000,-0.939289089000000,-1.14160999700000,-0.924671869000000,-0.877374303000000,-1.00378874500000,-1.45121552100000,-1.82149902900000,-1.37099409300000,-1.51949380200000,-1.94839691800000,-1.44996322900000,-1.91016087600000,-1.41134514700000,-1.06815646300000,-1.08529558100000,-0.702622532000000,-0.684053757000000;-0.744713038000000,-1.12264077700000,-0.953140874000000,-2.47711174200000,-1.90561925200000,-1.91609234100000,-1.91761721200000,-2.55043120700000,-2.37042732800000,-1.92608314600000,-1.48950258500000,-1.64830375000000,-2.02447547600000,-1.98513993200000,-1.33160392700000,-1.15896767000000,-1.61658966500000,-0.754661692000000,-0.957173529000000,-0.867659250000000,-1.23755129900000,-0.928068101000000,-0.775798309000000,-0.733694119000000,-1.24573859000000,-0.723535354000000,-0.240954987000000,-0.881704051000000,-0.748714671000000,-1.54303678400000,0.209387170000000,-0.378032814000000,-0.394310999000000,-1.10155018600000,-1.08994429900000];

%% Plot heatmap of the genotype
ORDER_MEDFILTER = 3; % order for median filter smooth
rfAcrossAllGenotypes = medfilt1( rfAcrossAllGenotypes(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace

minColorRange =  min(min(rfAcrossAllGenotypes),[],2) ;
maxColorRange= abs( min(min(rfAcrossAllGenotypes),[],2));

figure('Position',[50, 50, 1000, 300]);
set(gcf, 'Color', 'w');
plotOrderedOLHeatMap( expt_rfAcrossCells, barPositionDegreesFromMidline, minColorRange ,maxColorRange  )
title( 'experimental');

figure('Position',[50, 50, 1000, 300]);
set(gcf, 'Color', 'w');
plotOrderedOLHeatMap( gal4_rfAcrossCells, barPositionDegreesFromMidline, minColorRange ,maxColorRange  );
title( 'GAL4 control');

figure('Position',[50, 50, 1000, 300]);
set(gcf, 'Color', 'w');
plotOrderedOLHeatMap( uas_rfAcrossCells, barPositionDegreesFromMidline, minColorRange ,maxColorRange  )
title( 'UAS control');

%% Plot bar plots of max inhibition and excitation 

ORDER_MEDFILTER = 3; %

% smooth RF data
expt_rfAcrossCellsSmoothed = medfilt1( expt_rfAcrossCells(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace
gal4_rfAcrossCellsSmoothed = medfilt1( gal4_rfAcrossCells(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace
uas_rfAcrossCellsSmoothed = medfilt1( uas_rfAcrossCells(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace


expt_exc = max(expt_rfAcrossCellsSmoothed,[],2);
control_Gal4_exc = max(gal4_rfAcrossCellsSmoothed,[],2);
control_UAS_exc = max(uas_rfAcrossCellsSmoothed,[],2);

ranksum( expt_exc, control_Gal4_exc)
ranksum( expt_exc, control_UAS_exc)

expt_inh = min(expt_rfAcrossCellsSmoothed,[],2);
control_Gal4_inh = min(gal4_rfAcrossCellsSmoothed,[],2);
control_UAS_inh = min(uas_rfAcrossCellsSmoothed,[],2);

ranksum( expt_inh, control_Gal4_inh)
ranksum( expt_inh, control_UAS_inh)

figure('Position',[50, 50, 400, 800]);
set(gcf, 'Color', 'w');

% plot min responses
subplot(1, 2, 1)
bar( [mean(expt_inh) , mean(control_Gal4_inh), mean(control_UAS_inh) ] ,'b'); hold on
scatter( [ones(length(expt_inh),1); 2*ones(length(control_Gal4_inh),1);3*ones(length(control_UAS_inh),1)], [expt_inh; control_Gal4_inh; control_UAS_inh], 'filled','k') 

set(gca, 'xticklabel', {'expt',  'ctr-GAL4','ctr-UAS'})
ylim([-6 2.25]);
ylabel('\Delta V_m(mV)');
box off
title('min response');
niceaxes

% plot max response
subplot(1, 2, 2)
bar( [mean(expt_exc) , mean(control_Gal4_exc), mean(control_UAS_exc) ] ,'r'); hold on
scatter( [ones(length(expt_exc),1); 2*ones(length(control_Gal4_exc),1);3*ones(length(control_UAS_exc),1)], [expt_exc; control_Gal4_exc; control_UAS_exc], 'filled','k') 

set(gca, 'xticklabel', {'expt',  'ctr-GAL4','ctr-UAS'})
ylim([-6 2.25]);
ylabel('\Delta V_m(mV)');
box off
title('max response');
niceaxes

%% TODO:::   Plot bar plots of integrated inhibition - added 2/2019
expt_rfAcrossCellsSmoothed = medfilt1( expt_rfAcrossCells(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace
gal4_rfAcrossCellsSmoothed = medfilt1( gal4_rfAcrossCells(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace
uas_rfAcrossCellsSmoothed = medfilt1( uas_rfAcrossCells(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace

expt_rfAcrossCellsSmoothed(expt_rfAcrossCellsSmoothed > 0) = 0;
gal4_rfAcrossCellsSmoothed(gal4_rfAcrossCellsSmoothed > 0) = 0;
uas_rfAcrossCellsSmoothed( uas_rfAcrossCellsSmoothed > 0) = 0;

exptIntegratedInh = sum( expt_rfAcrossCellsSmoothed, 2 );
control_Gal4_IntegratedInh = sum( gal4_rfAcrossCellsSmoothed, 2);
control_UAS_IntegratedInh = sum( uas_rfAcrossCellsSmoothed, 2 );


ranksum( exptIntegratedInh, control_Gal4_IntegratedInh)
ranksum( exptIntegratedInh, control_UAS_IntegratedInh)

figure('Position',[50, 50, 400, 800]);
set(gcf, 'Color', 'w');

% plot integrated inhibition responses
bar( [mean(exptIntegratedInh) , mean(control_Gal4_IntegratedInh), mean(control_UAS_IntegratedInh) ] ,'b'); hold on
scatter( [ones(length(exptIntegratedInh),1); 2*ones(length(control_Gal4_IntegratedInh),1);3*ones(length(control_UAS_IntegratedInh),1)], [exptIntegratedInh; control_Gal4_IntegratedInh; control_UAS_IntegratedInh], 'filled','k') 

ylim([ -140 0])
set(gca, 'xticklabel', {'expt',  'ctr-GAL4','ctr-UAS'})
ylabel('\Delta V_m(mV)');
box off
title('integrated inhibition');
niceaxes

%% save current plot
dir = '/Users/evettita/Dropbox (HMS)/FisherLuWilson ms/revision/Figures/Figure 3/';
fileName = [ dir 'R20A02_Gal4_heatmap.eps' ];
print( fileName, '-dpdf');


%% Plot OL Heatmap
function plotOrderedOLHeatMap( rfAcrossCells, barPositionDegreesFromMidline, cm_min , cm_max)

%  % reorder plots with strongest inhibition on top to least inihibition on
%  % bottom
% [~, sortIndex] = sort ( min(rfAcrossCells, [], 2) );
% rfAcrossCells = rfAcrossCells( sortIndex , :);

%  COLOR_STEP_NUM = 40;
%  colorBrewerMap = cbrewer('div', 'Spectral', COLOR_STEP_NUM);

% order for median filter smooth
ORDER_MEDFILTER = 3; %
rfAcrossCellsFiltered = medfilt1( rfAcrossCells(:,:), ORDER_MEDFILTER, 'truncate',2); % Median filtering of the trace


% % reorder OL tuning based on location of max resposne per row
 [~,  minIndex] = min( rfAcrossCellsFiltered ,[],2);
 [~, sortIndex ] = sort( minIndex );
% % 
% % % reorder OL tuning based on location of max resposne per row
% % [~,  maxIndex] = max( rfAcrossCellsFiltered ,[],2);
% % [~, sortIndex ] = sort( maxIndex );
% 
 rfAcrossCellsFilteredAndSorted = rfAcrossCellsFiltered(sortIndex, :);

% rfAcrossCellsFilteredAndSorted = rfAcrossCellsFiltered;

imagesc( rfAcrossCellsFilteredAndSorted ,'AlphaData', ~isnan(rfAcrossCellsFilteredAndSorted)); hold on;
set(gca,'color',0*[1 1 1]); 

c = colorbar;
c.Label.String = '\DeltaVm  (mV)';
caxis( [ cm_min , cm_max]);

colormap('bluewhitered'); % zero set to white in this plotting
%colormap( flip( colorBrewerMap ) ); % zero set to white in this plotting

set(gca, 'xtick', 1: length(barPositionDegreesFromMidline) );
labels = round(barPositionDegreesFromMidline) ;
set(gca, 'xticklabel', labels );

ylabel( ' cell number ' );
xlabel(' bar position (deg)')
niceaxes; box off;

% % add plot of tuning curves on top of eachother:
% figure;set(gcf, 'Color', 'w');
% plot( barPositionDegreesFromMidline , rfAcrossCellsFilteredAndSorted , 'k'); hold on
% % add grey dotted line at 0
% plot( barPositionDegreesFromMidline, zeros( 1, length(barPositionDegreesFromMidline) ),'--', 'Color', [ 0.7 , 0.7, 0.7] ); hold on;
% 
% ylim([ cm_min, cm_max/2]);
% ylabel('\Delta V_m (mV)');
% xlabel(' bar position (deg)')
% niceaxes; box off;

end
%%