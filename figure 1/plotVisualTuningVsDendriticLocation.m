%% plotVisualTuningVsDendriticLocation
% Analysis and plotting code for comparing the visual Rf of an EPG neuron
% with it's dendritic location in the ellipsoid body as measured by a
% biocytin fill that was analized posthoc.
%
% Specifically this till plots the visual location (deg) of max
% visually-evoked inhition vs. dendritic region in the EB (ie R1/L1,
% R2/L8... see Wolff et al. 2017)
% 
% Written to plot data for Figure 1 of the manuscript
% Yvette Fisher 11/11/18
%% Load data/constants needed for this analysis 
clear all;

% 21 cells with biocytin fills -11/11/18
receptiveFields =[-0.485242233000000,-1.57893186900000,-1.39879535400000,-1.97064075200000,-1.15536466700000,-2.18893109400000,-1.36880681200000,-1.93323511300000,-1.57138482100000,-1.64167275600000,-1.00301650200000,-0.390565595000000,-0.481902749000000,-0.747194821000000,0.226628666000000,0.601207213000000,-0.161771223000000,1.05997453500000,0.778445768000000,0.695617268000000,-0.397155884000000,0.627812132000000,-0.191400710000000,0.291351529000000,0.653392117000000,-0.253944812000000,-0.0367627430000000,1.57772164500000,0.449364278000000,0.573146449000000,0.495005831000000,0.527153844000000,-0.348696466000000,0.977049735000000,-0.514277611000000;-1.44953159700000,-2.95769745100000,-2.59211844900000,-3.25714999100000,-3.94728467800000,-2.68405171000000,-4.54835451800000,-4.45722792400000,-3.79320137700000,-2.95694537500000,-2.78897192900000,-2.86698688100000,-2.38160020800000,0.580119088000000,-0.781630467000000,-1.35673698200000,0.0355196460000000,-0.469607126000000,0.451803089000000,-0.848374968000000,1.03782170700000,0.983804881000000,-0.334649781000000,-1.55444312600000,0.112909901000000,-1.42775779500000,-1.41523324700000,-0.777649994000000,-0.155042692000000,-0.843892522000000,-2.00584670300000,-2.16634525000000,-0.888389112000000,-2.98661715200000,-3.28909159600000;-1.07854061300000,-0.962069913000000,-1.00084841300000,-1.37132845400000,-1.32074164500000,-0.969302712000000,-1.18672617200000,-0.707535139000000,-0.621877752000000,-0.378267634000000,-0.723921749000000,-1.07972439100000,-0.255501661000000,-0.799603638000000,-1.18486701200000,-1.99718967900000,-1.33831272600000,-2.33998560500000,-2.31523048900000,-2.48508593600000,-2.71272840600000,-2.72747888200000,-2.72404207900000,-2.38441952600000,-3.27611363400000,-3.35883833200000,-3.65153261600000,-3.88171994600000,-3.11572182800000,-3.41787616800000,-2.14525622800000,-2.58708372500000,-2.49840086200000,-1.64949764100000,-1.93769435600000;-1.29918176100000,-2.83900239800000,-4.13553991800000,-5.15573280200000,-4.32857986400000,-4.51531766600000,-4.28590614900000,-5.05156775000000,-3.12893343300000,-5.22511420400000,-4.18440499400000,-4.75163264800000,-4.82891342800000,-2.45913232900000,-2.89478810700000,-3.06957736500000,0.402240395000000,0.892154044000000,1.23093964100000,1.91269516700000,1.47382513600000,2.32487835400000,2.55384988300000,2.65291966200000,1.68062045100000,1.28220181900000,1.42979339800000,1.48955012200000,0.660211540000000,3.17127518500000,0.463864502000000,0.220197374000000,0.354652645000000,0.701539032000000,-0.164106030000000;0.357271756000000,0.724007614000000,1.49876809200000,-0.154093897000000,-0.295950848000000,0.687014873000000,0.255799755000000,1.06137140900000,0.128016124000000,-0.638962034000000,-0.236088873000000,-1.75683920600000,-0.901268394000000,-0.959695658000000,-1.84151472300000,-2.25842461100000,-2.36739485200000,-2.94989860400000,-2.07549078600000,-1.81566902400000,-1.56132761300000,-1.40484962700000,-2.83808794700000,-1.14742802100000,-1.64290897600000,-1.38696999900000,-1.65956863500000,-1.47861512300000,-1.55016793400000,-1.40279829800000,-0.104866580000000,-0.0963857590000000,0.199396355000000,-1.21904923700000,-0.755019791000000;0.555988545000000,-0.174585921000000,-0.552887037000000,-1.37757451400000,-0.720201836000000,-0.597744420000000,-0.188159694000000,-0.771007234000000,-0.638695765000000,-0.876217574000000,-0.189842312000000,-1.63067449400000,-0.590717745000000,-0.836815185000000,-1.60987661800000,-1.40582401900000,-0.434966356000000,-0.719018478000000,-0.0216265900000000,-0.276405299000000,-0.715690799000000,-0.596662852000000,-1.08086622400000,-1.57961502300000,-1.80823589400000,-2.32977384300000,-2.10899520900000,-1.91902052100000,-2.23948227400000,-1.51052311900000,-2.24061812500000,-1.75526689600000,-1.29997568900000,-1.83052797700000,-1.39355361600000;0.108679818000000,1.77029393600000,0.153029495000000,0.228154650000000,-0.453288865000000,2.88704491400000,4.08179053600000,5.50590023400000,4.39597009100000,7.90837542600000,3.36451203100000,2.58691990600000,4.20684884900000,3.59972571100000,2.80677923800000,0.641088442000000,-0.967360309000000,-3.01896209900000,-3.61452120400000,-4.89894154600000,-5.11191723800000,-4.47941728400000,-4.60797401200000,-4.71939810200000,-5.94160015900000,-4.14822182900000,-3.70133765000000,-5.77862000400000,-6.51634178900000,-6.85831256100000,-4.29650281300000,-2.05851291100000,-3.10891414100000,-4.07496908400000,0.825515679000000;-2.34873804700000,-2.47543774500000,-3.00256199800000,-2.25899382200000,-1.88029125500000,-2.37045880000000,-1.35510411400000,-1.27053903900000,-0.547735222000000,-0.761112811000000,-0.690766910000000,-0.834869144000000,-0.465142437000000,-0.759989744000000,-1.32719473700000,-1.76973958400000,-1.23062891300000,-0.328614124000000,-0.820406072000000,-0.953983619000000,-1.07600392500000,-2.24020209500000,-1.78149131100000,-2.29504953800000,-2.22251175300000,-1.48688392900000,-2.44526113200000,-1.53072172300000,-1.15951574100000,-1.28625798400000,0.242560949000000,-0.518793947000000,0.269963876000000,0.0566283080000000,-0.175049351000000;-0.277452366000000,0.797989713000000,0.0771250130000000,0.0193280860000000,-1.40557110300000,-0.296266473000000,0.233163209000000,-0.120802863000000,-0.197492790000000,2.58525394600000,1.00106951200000,1.10297486700000,2.43294947700000,1.85725688200000,1.87516682400000,0.561369594000000,-0.0644855700000000,-0.432405967000000,-1.12908575500000,-1.32538972300000,-1.35459429400000,-2.19361502300000,-2.41390636700000,-2.60518332700000,-3.38853252000000,-2.45233114900000,-2.48830583500000,-3.51639646700000,-2.36178068400000,-2.71227390000000,-1.08758027700000,-0.885536225000000,-1.41134069700000,-1.39610637900000,0.0674084920000000;0.657492870000000,0.273890686000000,0.176239269000000,-0.177896977000000,-0.588582322000000,0.743712939000000,-0.227298106000000,0.0530488110000000,-0.115573318000000,0.173868138000000,0.912960781000000,0.230675363000000,-0.976404372000000,0.358939293000000,0.880206684000000,0.833004950000000,-0.691419846000000,-0.555245148000000,-1.02629025500000,-0.549772220000000,-0.351841456000000,-0.0587340290000000,-1.93306543100000,-1.24515416400000,-1.62616408700000,-1.99293822600000,-1.77248889400000,-2.01218673600000,-2.39165679600000,-2.06886621800000,-2.24525778300000,-2.47861494700000,-2.23107060600000,-2.00186699500000,-2.13175043100000;0.215364505000000,-1.14727942500000,-0.190263803000000,1.66727027200000,0.674683833000000,0.965322966000000,1.28094382000000,0.409703432000000,1.07472039600000,0.432566320000000,0.201632127000000,1.25318950800000,-0.0316970590000000,0.342664464000000,-0.885907994000000,-0.687280227000000,-0.560027783000000,-0.626739725000000,-1.91383294200000,-1.50844575800000,-1.13965109200000,-1.07708428800000,-1.79527519400000,-0.506423312000000,-0.581999592000000,-1.64185116500000,-1.74539676700000,-1.55612892100000,-1.52231303000000,-1.42250879500000,-1.51339614300000,-0.726089230000000,-1.49283376800000,-1.58497476400000,-1.67572547100000;-3.00725265200000,-3.15660224300000,-3.89477211500000,-3.57622055000000,-4.90180660200000,-4.08749182300000,-3.54598575200000,-2.49013581500000,-3.43515722900000,-3.10479776000000,-2.69480364400000,-2.63923042700000,-2.47720747000000,-1.14485097500000,-3.02740677600000,-1.69859821100000,-2.61964952000000,-1.18647706000000,-1.61912594100000,-1.62568771400000,-3.23593591800000,-2.28592995100000,-2.46261072100000,-1.16170087300000,-2.17253043900000,-1.38885183700000,-2.32592025500000,-2.56548367700000,-2.87417810700000,-2.44826291000000,-3.44566784900000,-2.32000527100000,-2.84068569100000,-2.64164567400000,-2.88171533200000;-0.100035670000000,-1.55492172100000,-1.13735571200000,-0.138596777000000,-1.28066593900000,-0.980449823000000,-0.185569161000000,-1.79663615800000,0.715290512000000,0.183348992000000,-0.0470184110000000,0.0906237190000000,-0.503897899000000,-0.917039434000000,-1.33566905900000,-1.11810884700000,-0.793956963000000,-1.69036929300000,-2.18928891700000,-2.47833320200000,-2.21615035700000,-1.91290713300000,-2.06267425800000,-2.26392229100000,-3.37114062800000,-3.89461310800000,-2.95519515300000,-3.47940880800000,-3.23250622400000,-2.41924212300000,-1.31819627100000,-1.55363760900000,-0.922003377000000,-0.832147546000000,0.206407479000000;-1.16764555400000,-2.84136608400000,-2.57060459800000,-2.71489039100000,-2.56565193800000,-1.81965645900000,-1.70842038200000,-2.06230721200000,-1.85454753900000,-1.91384448200000,-2.32836365000000,-2.04999344400000,-2.59738852100000,-3.30132801500000,-3.28534042000000,-2.78381281600000,-3.16395550100000,-2.65657774500000,-1.90083484000000,-1.41756050200000,-2.33782069500000,-1.76070080500000,-1.57004738200000,-1.40041249500000,-1.52134711500000,-0.540612713000000,-1.28822275000000,-2.08659042000000,-2.10983011100000,-1.80467238500000,-1.57697578400000,-1.51577628800000,-1.57212643000000,-2.07889609900000,-1.60892084000000;-0.932254346000000,-1.08646055900000,-1.14933905400000,-1.55988564300000,-1.37570665800000,-1.43875827900000,-1.33508797700000,-1.29506039800000,-1.73375298900000,-1.26871279600000,-1.14571456600000,-0.741310077000000,-0.761602514000000,-0.0697159100000000,0.206432046000000,-0.0924865620000000,-0.0704389350000000,0.115411165000000,0.520604327000000,0.476288135000000,0.444687253000000,0.441968394000000,0.316815462000000,0.394903946000000,0.578179778000000,0.186159323000000,0.170058731000000,0.0547309790000000,0.282953215000000,0.258709303000000,0.424056510000000,-0.0364071500000000,-0.394073560000000,-0.693081427000000,-0.857669826000000;-1.45304271100000,-1.81159376200000,-2.20561285000000,-2.73872936800000,-2.26883050300000,-2.88177864400000,-2.37142692400000,-1.24669883600000,-1.60341420800000,-1.40737974600000,-1.39285958300000,-1.55899800600000,-1.53561646900000,-0.655367790000000,0.251087688000000,-0.170624245000000,-1.30259405100000,0.284418539000000,-0.124328650000000,-0.0243960980000000,0.158337544000000,0.116534937000000,0.178514679000000,0.121470367000000,0.518394513000000,0.208186368000000,0.377766765000000,0.0664375580000000,0.248814899000000,0.240948941000000,0.315123503000000,0.546436497000000,0.00752389100000000,0.115452462000000,0.424998317000000;-3.13130103400000,-2.18510153600000,-2.85741548700000,-3.60889617000000,-3.61223012100000,-3.48800030300000,-3.12685008800000,-2.47680353000000,-2.45710787800000,-2.64699181200000,-1.56381556800000,-1.76633702800000,-0.130599611000000,-0.162136629000000,0.511325134000000,1.34709851600000,1.23750909200000,0.854277000000000,0.491444084000000,-0.102506335000000,-0.402884227000000,-0.107224221000000,0.141709023000000,0.141826413000000,-0.558330104000000,0.138939323000000,-0.499164406000000,-1.44707236000000,-0.751224960000000,-1.71726704500000,-0.355359457000000,-0.288298723000000,-0.846303778000000,-1.21116564300000,-0.972772859000000;-0.163840030000000,0.0196313010000000,-0.395005783000000,0.376541529000000,0.422974559000000,0.983138766000000,0.882825013000000,-0.143338949000000,0.399363475000000,-0.266695099000000,-0.476072944000000,-0.646487104000000,-0.311818264000000,0.0170384570000000,-2.90750216200000,-2.01359707600000,-2.44334574900000,-2.96432499400000,-3.60993616400000,-2.44613492000000,-2.18657139200000,-2.58021640400000,-2.30783058200000,-2.06629205200000,-1.53214410300000,-1.24926634700000,-2.03474504200000,-2.60519526900000,-2.07321120400000,-2.09302170200000,-1.42692718300000,-2.09554995900000,-0.487566669000000,-0.815534008000000,-0.301761493000000;1.22867079700000,-0.351084534000000,-0.459876144000000,-0.428535267000000,-0.435998987000000,0.417929829000000,1.00981093400000,0.520072275000000,1.44562073100000,1.02469824300000,1.46154905800000,0.560384449000000,-0.345756369000000,-1.28076908400000,-1.82996440400000,-1.60202191900000,-0.989782812000000,-1.09495234100000,-1.22426801700000,-1.54387316200000,-1.38385103700000,-0.870112947000000,-1.45329433400000,-1.77438084900000,-1.86532435800000,-2.08714872800000,-2.13168794300000,-2.62655637200000,-2.40012795600000,-1.59605222200000,-1.75243867300000,-1.53645868800000,-1.41360290000000,-1.90627926300000,-1.62980323500000;-3.32269307800000,-4.42979918500000,-3.33367176200000,-4.79246519300000,-4.86461438000000,-3.89822273500000,-4.20784791300000,-4.26854391400000,-1.85160033300000,-4.11991862200000,-3.59441216600000,-2.17252725800000,-3.96881311600000,-3.91286898700000,-3.04204846600000,-1.90747052600000,-1.70202839400000,0.285794757000000,0.572176333000000,-1.43682817500000,-1.60068176900000,-2.44971734700000,-2.22542636600000,-0.951973971000000,-1.35660104300000,0.523048098000000,-0.245626742000000,-1.35119597900000,-1.03820367800000,-0.898659414000000,1.64256572900000,1.70784827800000,1.17315350500000,-0.353414824000000,-1.65204901300000;-0.609615834000000,-1.33817245900000,0.156821663000000,-0.805386318000000,-2.61964895600000,-1.77123156700000,-0.150196827000000,-2.45834464300000,0.116369131000000,0.0543690030000000,-0.219386478000000,1.52029236600000,-0.581858490000000,-0.690885601000000,-0.271566159000000,-1.17188117300000,-1.08403019600000,-1.48635668100000,-1.45820414800000,-0.412509266000000,-0.569081050000000,-0.677282604000000,-1.32732447100000,-1.59695910100000,-3.05021629100000,-3.75870616900000,-4.57301783600000,-4.08998436900000,-1.27791425300000,-2.43039602500000,-2.18383494200000,-1.97275487900000,-1.43315610400000,-3.41432105900000,-1.68693247400000];

EB_dendriteLocation = [5;4;2;3;7;7;5;6;4;8;6;4;6;7;6;7;2;1;5;7;6];

cellTypeLabelsInOrder = {'L5','L6','R2','L7','L3','L3','L5','R6','R4','L2','L4','L6','L4','L3','R6','L3','R2','R1', 'L5', 'L3','L4'};

EB_cellOrder = {'L1/R1', 'L8/R2', 'L7/R3', 'L6/R4', 'L5/R5', 'L4/R6', 'L3/R7', 'L2/R8'}; 

TOTAL_DEGREES_IN_PATTERN = 360;
DEGREE_PER_LED_SLOT = 360 / 96; 
MIDLINE_POSITION = 34;% position
EDGE_OF_SCREEN_POSITION = 72; % last LED slot in postion units
EDGE_OF_SCREEN_DEG = (EDGE_OF_SCREEN_POSITION -  MIDLINE_POSITION ) * DEGREE_PER_LED_SLOT;
POSSIBLE_BAR_LOCATIONS = 2:2:71;

barPositionDegreesFromMidline = ( POSSIBLE_BAR_LOCATIONS - MIDLINE_POSITION ) * DEGREE_PER_LED_SLOT;

%% TODO: decide if we want to do any smoothing to the RF before measuring?

%% plot heat map to check that data set looks correct:
figure;
set(gcf, 'Color', 'w');

imagesc( receptiveFields );
c = colorbar;
c.Label.String = ' Delta Vm  (mV) ( response - baseline)';
colormap('bluewhitered'); % zero set to white in this plotting
set(gca, 'xtick', POSSIBLE_BAR_LOCATIONS / 2 )
set(gca, 'xticklabel', round(barPositionDegreesFromMidline))
set(gca, 'ytick', 1:length( receptiveFields(:,1) ) )
set(gca, 'yticklabel',cellTypeLabelsInOrder);
%other constants
CM_MIN = -8;
CM_MAX = 8;

c = colorbar;
c.Label.String = '\DeltaVm  (mV)';
caxis( [ CM_MIN , CM_MAX]);
%% maximum Inhibition scatter Plot
[maxExcitationAcrossCells, indexOfMaxExc ] = max(receptiveFields,[],2);% for scale

[maxInhibitionAcrossCells, indexOfMaxInh ] = min(receptiveFields,[],2);
maxInhDegree = barPositionDegreesFromMidline ( indexOfMaxInh )';

figure;
set(gcf, 'Color', 'w');
s = scatter( maxInhDegree, EB_dendriteLocation , 100, maxInhibitionAcrossCells , 'filled');
s.MarkerEdgeColor = 'k';

caxis([ min(maxInhibitionAcrossCells),  0])
colormap('bluewhitered');
c = colorbar;
c.Label.String = ' \Delta Vm  (mV)';

set(gca, 'ytick', 1:length( EB_cellOrder ) )
set(gca, 'yticklabel', EB_cellOrder  )



ylabel(' EB arbor location' )
xlabel(' bar position (deg)')
niceaxes

xlim([ min( barPositionDegreesFromMidline), max(barPositionDegreesFromMidline) ]);
ylim([ 1 8]);

%% maximum Excitation scatter Plot

[maxExcitationAcrossCells, indexOfMaxExc ] = max(receptiveFields,[],2);
maxExcDegree = barPositionDegreesFromMidline ( indexOfMaxExc )';

figure;
set(gcf, 'Color', 'w');
s = scatter( maxExcDegree , EB_dendriteLocation, 100, maxExcitationAcrossCells , 'filled');
s.MarkerEdgeColor = 'k';

caxis([ min(maxInhibitionAcrossCells),  max(maxExcitationAcrossCells)])
colormap('bluewhitered');
c = colorbar;
c.Label.String = ' \Delta Vm  (mV)';

set(gca, 'ytick', 1:length( EB_cellOrder ) )
set(gca, 'yticklabel', EB_cellOrder  )



ylabel(' EB arbor location' )
xlabel(' bar position (deg)')
niceaxes

xlim([ min( barPositionDegreesFromMidline), max(barPositionDegreesFromMidline) ]);
ylim([ 1 8]);

%% circular circular regression on these interactions

%switch into radians:
maxInhRadians = maxInhDegree * pi/180;
maxExcRadians = maxExcDegree * pi/180;

%switch EB dendrite positions into radians
RadiansPerEBSector = (360 / 8) * pi/180; % 45Degrees per sector = 0.7853 radians
% transform number of EB dendrite into radians
EB_positionRadians = EB_dendriteLocation * RadiansPerEBSector;

[rho pval ] = circ_corrcc(maxInhRadians, EB_positionRadians)
[rho pval ] = circ_corrcc(maxExcRadians, EB_positionRadians)

%% Linear regression on both scatter plots:
fitlm(  EB_dendriteLocation, maxInhDegree ,'linear')
fitlm(  EB_dendriteLocation, maxExcDegree ,'linear')

%% double checking conclutions, plotting the full when sorted by dendrite order:
receptiveFieldsOrdered =[-1.07854061300000,-0.962069913000000,-1.00084841300000,-1.37132845400000,-1.32074164500000,-0.969302712000000,-1.18672617200000,-0.707535139000000,-0.621877752000000,-0.378267634000000,-0.723921749000000,-1.07972439100000,-0.255501661000000,-0.799603638000000,-1.18486701200000,-1.99718967900000,-1.33831272600000,-2.33998560500000,-2.31523048900000,-2.48508593600000,-2.71272840600000,-2.72747888200000,-2.72404207900000,-2.38441952600000,-3.27611363400000,-3.35883833200000,-3.65153261600000,-3.88171994600000,-3.11572182800000,-3.41787616800000,-2.14525622800000,-2.58708372500000,-2.49840086200000,-1.64949764100000,-1.93769435600000;-3.13130103400000,-2.18510153600000,-2.85741548700000,-3.60889617000000,-3.61223012100000,-3.48800030300000,-3.12685008800000,-2.47680353000000,-2.45710787800000,-2.64699181200000,-1.56381556800000,-1.76633702800000,-0.130599611000000,-0.162136629000000,0.511325134000000,1.34709851600000,1.23750909200000,0.854277000000000,0.491444084000000,-0.102506335000000,-0.402884227000000,-0.107224221000000,0.141709023000000,0.141826413000000,-0.558330104000000,0.138939323000000,-0.499164406000000,-1.44707236000000,-0.751224960000000,-1.71726704500000,-0.355359457000000,-0.288298723000000,-0.846303778000000,-1.21116564300000,-0.972772859000000;-1.29918176100000,-2.83900239800000,-4.13553991800000,-5.15573280200000,-4.32857986400000,-4.51531766600000,-4.28590614900000,-5.05156775000000,-3.12893343300000,-5.22511420400000,-4.18440499400000,-4.75163264800000,-4.82891342800000,-2.45913232900000,-2.89478810700000,-3.06957736500000,0.402240395000000,0.892154044000000,1.23093964100000,1.91269516700000,1.47382513600000,2.32487835400000,2.55384988300000,2.65291966200000,1.68062045100000,1.28220181900000,1.42979339800000,1.48955012200000,0.660211540000000,3.17127518500000,0.463864502000000,0.220197374000000,0.354652645000000,0.701539032000000,-0.164106030000000;-1.44953159700000,-2.95769745100000,-2.59211844900000,-3.25714999100000,-3.94728467800000,-2.68405171000000,-4.54835451800000,-4.45722792400000,-3.79320137700000,-2.95694537500000,-2.78897192900000,-2.86698688100000,-2.38160020800000,0.580119088000000,-0.781630467000000,-1.35673698200000,0.0355196460000000,-0.469607126000000,0.451803089000000,-0.848374968000000,1.03782170700000,0.983804881000000,-0.334649781000000,-1.55444312600000,0.112909901000000,-1.42775779500000,-1.41523324700000,-0.777649994000000,-0.155042692000000,-0.843892522000000,-2.00584670300000,-2.16634525000000,-0.888389112000000,-2.98661715200000,-3.28909159600000;-0.277452366000000,0.797989713000000,0.0771250130000000,0.0193280860000000,-1.40557110300000,-0.296266473000000,0.233163209000000,-0.120802863000000,-0.197492790000000,2.58525394600000,1.00106951200000,1.10297486700000,2.43294947700000,1.85725688200000,1.87516682400000,0.561369594000000,-0.0644855700000000,-0.432405967000000,-1.12908575500000,-1.32538972300000,-1.35459429400000,-2.19361502300000,-2.41390636700000,-2.60518332700000,-3.38853252000000,-2.45233114900000,-2.48830583500000,-3.51639646700000,-2.36178068400000,-2.71227390000000,-1.08758027700000,-0.885536225000000,-1.41134069700000,-1.39610637900000,0.0674084920000000;-3.00725265200000,-3.15660224300000,-3.89477211500000,-3.57622055000000,-4.90180660200000,-4.08749182300000,-3.54598575200000,-2.49013581500000,-3.43515722900000,-3.10479776000000,-2.69480364400000,-2.63923042700000,-2.47720747000000,-1.14485097500000,-3.02740677600000,-1.69859821100000,-2.61964952000000,-1.18647706000000,-1.61912594100000,-1.62568771400000,-3.23593591800000,-2.28592995100000,-2.46261072100000,-1.16170087300000,-2.17253043900000,-1.38885183700000,-2.32592025500000,-2.56548367700000,-2.87417810700000,-2.44826291000000,-3.44566784900000,-2.32000527100000,-2.84068569100000,-2.64164567400000,-2.88171533200000;-0.485242233000000,-1.57893186900000,-1.39879535400000,-1.97064075200000,-1.15536466700000,-2.18893109400000,-1.36880681200000,-1.93323511300000,-1.57138482100000,-1.64167275600000,-1.00301650200000,-0.390565595000000,-0.481902749000000,-0.747194821000000,0.226628666000000,0.601207213000000,-0.161771223000000,1.05997453500000,0.778445768000000,0.695617268000000,-0.397155884000000,0.627812132000000,-0.191400710000000,0.291351529000000,0.653392117000000,-0.253944812000000,-0.0367627430000000,1.57772164500000,0.449364278000000,0.573146449000000,0.495005831000000,0.527153844000000,-0.348696466000000,0.977049735000000,-0.514277611000000;0.108679818000000,1.77029393600000,0.153029495000000,0.228154650000000,-0.453288865000000,2.88704491400000,4.08179053600000,5.50590023400000,4.39597009100000,7.90837542600000,3.36451203100000,2.58691990600000,4.20684884900000,3.59972571100000,2.80677923800000,0.641088442000000,-0.967360309000000,-3.01896209900000,-3.61452120400000,-4.89894154600000,-5.11191723800000,-4.47941728400000,-4.60797401200000,-4.71939810200000,-5.94160015900000,-4.14822182900000,-3.70133765000000,-5.77862000400000,-6.51634178900000,-6.85831256100000,-4.29650281300000,-2.05851291100000,-3.10891414100000,-4.07496908400000,0.825515679000000;-2.34873804700000,-2.47543774500000,-3.00256199800000,-2.25899382200000,-1.88029125500000,-2.37045880000000,-1.35510411400000,-1.27053903900000,-0.547735222000000,-0.761112811000000,-0.690766910000000,-0.834869144000000,-0.465142437000000,-0.759989744000000,-1.32719473700000,-1.76973958400000,-1.23062891300000,-0.328614124000000,-0.820406072000000,-0.953983619000000,-1.07600392500000,-2.24020209500000,-1.78149131100000,-2.29504953800000,-2.22251175300000,-1.48688392900000,-2.44526113200000,-1.53072172300000,-1.15951574100000,-1.28625798400000,0.242560949000000,-0.518793947000000,0.269963876000000,0.0566283080000000,-0.175049351000000;0.215364505000000,-1.14727942500000,-0.190263803000000,1.66727027200000,0.674683833000000,0.965322966000000,1.28094382000000,0.409703432000000,1.07472039600000,0.432566320000000,0.201632127000000,1.25318950800000,-0.0316970590000000,0.342664464000000,-0.885907994000000,-0.687280227000000,-0.560027783000000,-0.626739725000000,-1.91383294200000,-1.50844575800000,-1.13965109200000,-1.07708428800000,-1.79527519400000,-0.506423312000000,-0.581999592000000,-1.64185116500000,-1.74539676700000,-1.55612892100000,-1.52231303000000,-1.42250879500000,-1.51339614300000,-0.726089230000000,-1.49283376800000,-1.58497476400000,-1.67572547100000;-0.100035670000000,-1.55492172100000,-1.13735571200000,-0.138596777000000,-1.28066593900000,-0.980449823000000,-0.185569161000000,-1.79663615800000,0.715290512000000,0.183348992000000,-0.0470184110000000,0.0906237190000000,-0.503897899000000,-0.917039434000000,-1.33566905900000,-1.11810884700000,-0.793956963000000,-1.69036929300000,-2.18928891700000,-2.47833320200000,-2.21615035700000,-1.91290713300000,-2.06267425800000,-2.26392229100000,-3.37114062800000,-3.89461310800000,-2.95519515300000,-3.47940880800000,-3.23250622400000,-2.41924212300000,-1.31819627100000,-1.55363760900000,-0.922003377000000,-0.832147546000000,0.206407479000000;-0.932254346000000,-1.08646055900000,-1.14933905400000,-1.55988564300000,-1.37570665800000,-1.43875827900000,-1.33508797700000,-1.29506039800000,-1.73375298900000,-1.26871279600000,-1.14571456600000,-0.741310077000000,-0.761602514000000,-0.0697159100000000,0.206432046000000,-0.0924865620000000,-0.0704389350000000,0.115411165000000,0.520604327000000,0.476288135000000,0.444687253000000,0.441968394000000,0.316815462000000,0.394903946000000,0.578179778000000,0.186159323000000,0.170058731000000,0.0547309790000000,0.282953215000000,0.258709303000000,0.424056510000000,-0.0364071500000000,-0.394073560000000,-0.693081427000000,-0.857669826000000;0.357271756000000,0.724007614000000,1.49876809200000,-0.154093897000000,-0.295950848000000,0.687014873000000,0.255799755000000,1.06137140900000,0.128016124000000,-0.638962034000000,-0.236088873000000,-1.75683920600000,-0.901268394000000,-0.959695658000000,-1.84151472300000,-2.25842461100000,-2.36739485200000,-2.94989860400000,-2.07549078600000,-1.81566902400000,-1.56132761300000,-1.40484962700000,-2.83808794700000,-1.14742802100000,-1.64290897600000,-1.38696999900000,-1.65956863500000,-1.47861512300000,-1.55016793400000,-1.40279829800000,-0.104866580000000,-0.0963857590000000,0.199396355000000,-1.21904923700000,-0.755019791000000;0.555988545000000,-0.174585921000000,-0.552887037000000,-1.37757451400000,-0.720201836000000,-0.597744420000000,-0.188159694000000,-0.771007234000000,-0.638695765000000,-0.876217574000000,-0.189842312000000,-1.63067449400000,-0.590717745000000,-0.836815185000000,-1.60987661800000,-1.40582401900000,-0.434966356000000,-0.719018478000000,-0.0216265900000000,-0.276405299000000,-0.715690799000000,-0.596662852000000,-1.08086622400000,-1.57961502300000,-1.80823589400000,-2.32977384300000,-2.10899520900000,-1.91902052100000,-2.23948227400000,-1.51052311900000,-2.24061812500000,-1.75526689600000,-1.29997568900000,-1.83052797700000,-1.39355361600000;-1.16764555400000,-2.84136608400000,-2.57060459800000,-2.71489039100000,-2.56565193800000,-1.81965645900000,-1.70842038200000,-2.06230721200000,-1.85454753900000,-1.91384448200000,-2.32836365000000,-2.04999344400000,-2.59738852100000,-3.30132801500000,-3.28534042000000,-2.78381281600000,-3.16395550100000,-2.65657774500000,-1.90083484000000,-1.41756050200000,-2.33782069500000,-1.76070080500000,-1.57004738200000,-1.40041249500000,-1.52134711500000,-0.540612713000000,-1.28822275000000,-2.08659042000000,-2.10983011100000,-1.80467238500000,-1.57697578400000,-1.51577628800000,-1.57212643000000,-2.07889609900000,-1.60892084000000;-1.45304271100000,-1.81159376200000,-2.20561285000000,-2.73872936800000,-2.26883050300000,-2.88177864400000,-2.37142692400000,-1.24669883600000,-1.60341420800000,-1.40737974600000,-1.39285958300000,-1.55899800600000,-1.53561646900000,-0.655367790000000,0.251087688000000,-0.170624245000000,-1.30259405100000,0.284418539000000,-0.124328650000000,-0.0243960980000000,0.158337544000000,0.116534937000000,0.178514679000000,0.121470367000000,0.518394513000000,0.208186368000000,0.377766765000000,0.0664375580000000,0.248814899000000,0.240948941000000,0.315123503000000,0.546436497000000,0.00752389100000000,0.115452462000000,0.424998317000000;0.657492870000000,0.273890686000000,0.176239269000000,-0.177896977000000,-0.588582322000000,0.743712939000000,-0.227298106000000,0.0530488110000000,-0.115573318000000,0.173868138000000,0.912960781000000,0.230675363000000,-0.976404372000000,0.358939293000000,0.880206684000000,0.833004950000000,-0.691419846000000,-0.555245148000000,-1.02629025500000,-0.549772220000000,-0.351841456000000,-0.0587340290000000,-1.93306543100000,-1.24515416400000,-1.62616408700000,-1.99293822600000,-1.77248889400000,-2.01218673600000,-2.39165679600000,-2.06886621800000,-2.24525778300000,-2.47861494700000,-2.23107060600000,-2.00186699500000,-2.13175043100000];
cellTypeLabelsReOrdered = {'R2','R2','L7','L6','R4','L6','L5','L5','R6','L4','L4','R6','L3','L3','L3','L3','L2'};

figure;
set(gcf, 'Color', 'w');
imagesc( receptiveFieldsOrdered ) 
c = colorbar;
c.Label.String = ' Delta Vm  (mV) ( response - baseline)';
colormap('bluewhitered'); % zero set to white in this plotting
set(gca, 'xtick', POSSIBLE_BAR_LOCATIONS / 2 )
set(gca, 'xticklabel', round(barPositionDegreesFromMidline))

set(gca, 'ytick', 1:length( receptiveFields(:,1) ) )
title(' Receptive fields plotted in order of dendrite location') 
niceaxes
set(gca, 'yticklabel',cellTypeLabelsReOrdered)